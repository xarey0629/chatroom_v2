{"{\"assumptions\":{},\"sourceRoot\":\"/Users/edlin/Desktop/wp1111/hw7/backend/src/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/edlin/Desktop/wp1111/hw7/backend\",\"filename\":\"/Users/edlin/Desktop/wp1111/hw7/backend/src/server.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/edlin/Desktop/wp1111/hw7/backend\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"proposal-class-static-block\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ClassBody\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-private-property-in-object\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"BinaryExpression\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"proposal-class-properties\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"proposal-private-methods\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"proposal-numeric-separator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"NumericLiteral\":{\"enter\":[null]},\"BigIntLiteral\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-logical-assignment-operators\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"AssignmentExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":true,\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-json-strings\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"DirectiveLiteral\":{\"enter\":[null]},\"StringLiteral\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-optional-catch-binding\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"CatchClause\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-parameters\",\"visitor\":{\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-async-generator-functions\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-object-rest-spread\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"VariableDeclarator\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dotall-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-unicode-property-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-named-capturing-groups-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-async-to-generator\",\"visitor\":{\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-exponentiation-operator\",\"visitor\":{\"AssignmentExpression\":{\"enter\":[null]},\"BinaryExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-template-literals\",\"visitor\":{\"TaggedTemplateExpression\":{\"enter\":[null]},\"TemplateLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-literals\",\"visitor\":{\"NumericLiteral\":{\"enter\":[null]},\"StringLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-function-name\",\"visitor\":{\"FunctionExpression\":{\"exit\":[null]},\"ObjectProperty\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-arrow-functions\",\"visitor\":{\"ArrowFunctionExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-block-scoped-functions\",\"visitor\":{\"BlockStatement\":{\"enter\":[null]},\"SwitchCase\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-classes\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]},\"ClassExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-object-super\",\"visitor\":{\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-shorthand-properties\",\"visitor\":{\"ObjectMethod\":{\"enter\":[null]},\"ObjectProperty\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-duplicate-keys\",\"visitor\":{\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-computed-properties\",\"visitor\":{\"ObjectExpression\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-for-of\",\"visitor\":{\"ForOfStatement\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-sticky-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-unicode-escapes\",\"visitor\":{\"Identifier\":{\"enter\":[null]},\"TemplateElement\":{\"enter\":[null]},\"_exploded\":true,\"StringLiteral\":{\"enter\":[null]},\"DirectiveLiteral\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-unicode-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-spread\",\"visitor\":{\"ArrayExpression\":{\"enter\":[null]},\"CallExpression\":{\"enter\":[null]},\"NewExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-destructuring\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"VariableDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-block-scoping\",\"visitor\":{\"VariableDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"_exploded\":true,\"BlockStatement\":{\"enter\":[null]},\"SwitchStatement\":{\"enter\":[null]},\"Program\":{\"enter\":[null]},\"_verified\":true,\"DoWhileStatement\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForStatement\":{\"enter\":[null]},\"WhileStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-typeof-symbol\",\"visitor\":{\"UnaryExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"BlockStatement\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"DoWhileStatement\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForStatement\":{\"enter\":[null]},\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"Program\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"SwitchStatement\":{\"enter\":[null]},\"WhileStatement\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"StaticBlock\":{\"enter\":[null]},\"TSModuleBlock\":{\"enter\":[null]},\"AssignmentPattern\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectPattern\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-new-target\",\"visitor\":{\"MetaProperty\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-regenerator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ObjectMethod\":{\"enter\":[null],\"exit\":[null]},\"ClassMethod\":{\"enter\":[null],\"exit\":[null]},\"ClassPrivateMethod\":{\"enter\":[null],\"exit\":[null]},\"FunctionDeclaration\":{\"exit\":[null]},\"FunctionExpression\":{\"exit\":[null]},\"ArrowFunctionExpression\":{\"exit\":[null]},\"MemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-member-expression-literals\",\"visitor\":{\"MemberExpression\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-property-literals\",\"visitor\":{\"ObjectProperty\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-reserved-words\",\"visitor\":{\"_exploded\":true,\"_verified\":true,\"Identifier\":{\"enter\":[null,null]},\"JSXIdentifier\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.20.2:development":{"value":{"code":"\"use strict\";\n\nvar _express = _interopRequireDefault(require(\"express\"));\nvar _http = _interopRequireDefault(require(\"http\"));\nvar _wsConnect = _interopRequireDefault(require(\"./wsConnect\"));\nvar _mongo = _interopRequireDefault(require(\"./mongo\"));\nvar _ws = _interopRequireDefault(require(\"ws\"));\nvar _mongoose = _interopRequireDefault(require(\"mongoose\"));\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n_mongo[\"default\"].connect();\nvar app = (0, _express[\"default\"])();\nvar server = _http[\"default\"].createServer(app);\nvar wss = new _ws[\"default\"].Server({\n  server: server\n}); // WebSocket Server\nvar db = _mongoose[\"default\"].connection; // database 的變數名稱\n\ndb.once('open', function () {\n  //\n  console.log(\"MongoDB connected!\");\n  // Define ws format for client side \n  wss.on('connection', function (ws) {\n    ws.box = '';\n    ws.onmessage = _wsConnect[\"default\"].onMessage(wss, ws);\n    // ws.onmessage = (data) => {console.log(data)};\n    // ws.onopen = () => {console.log(\"WebSocket is connected.\")};\n    // ws.onclose = () => {console.log(\"WebSocket close connection.\")};\n  });\n});\n\nvar PORT = process.env.PORT || 4000;\nserver.listen(PORT, function () {\n  console.log(\"Listening on http://localhost:\".concat(PORT));\n});\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJtb25nbyIsImNvbm5lY3QiLCJhcHAiLCJleHByZXNzIiwic2VydmVyIiwiaHR0cCIsImNyZWF0ZVNlcnZlciIsIndzcyIsIldlYlNvY2tldCIsIlNlcnZlciIsImRiIiwibW9uZ29vc2UiLCJjb25uZWN0aW9uIiwib25jZSIsImNvbnNvbGUiLCJsb2ciLCJvbiIsIndzIiwiYm94Iiwib25tZXNzYWdlIiwid3NDb25uZWN0Iiwib25NZXNzYWdlIiwiUE9SVCIsInByb2Nlc3MiLCJlbnYiLCJsaXN0ZW4iXSwic291cmNlUm9vdCI6Ii9Vc2Vycy9lZGxpbi9EZXNrdG9wL3dwMTExMS9odzcvYmFja2VuZC9zcmMvIiwic291cmNlcyI6WyJzZXJ2ZXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGV4cHJlc3MgZnJvbSAnZXhwcmVzcyc7XG5pbXBvcnQgaHR0cCBmcm9tICdodHRwJztcbmltcG9ydCB3c0Nvbm5lY3QgZnJvbSAnLi93c0Nvbm5lY3QnO1xuaW1wb3J0IG1vbmdvIGZyb20gJy4vbW9uZ28nO1xuaW1wb3J0IFdlYlNvY2tldCBmcm9tICd3cyc7XG5pbXBvcnQgbW9uZ29vc2UgZnJvbSAnbW9uZ29vc2UnO1xuXG5cbm1vbmdvLmNvbm5lY3QoKTtcblxuY29uc3QgYXBwID0gZXhwcmVzcygpO1xuY29uc3Qgc2VydmVyID0gaHR0cC5jcmVhdGVTZXJ2ZXIoYXBwKTtcbmNvbnN0IHdzcyA9IG5ldyBXZWJTb2NrZXQuU2VydmVyKHtzZXJ2ZXJ9KTsgLy8gV2ViU29ja2V0IFNlcnZlclxuY29uc3QgZGIgPSBtb25nb29zZS5jb25uZWN0aW9uOyAvLyBkYXRhYmFzZSDnmoTorormlbjlkI3nqLFcblxuZGIub25jZSgnb3BlbicsICgpID0+IHtcbiAgLy9cbiAgY29uc29sZS5sb2coXCJNb25nb0RCIGNvbm5lY3RlZCFcIik7XG4gIC8vIERlZmluZSB3cyBmb3JtYXQgZm9yIGNsaWVudCBzaWRlIFxuICB3c3Mub24oJ2Nvbm5lY3Rpb24nLCAod3MpID0+IHtcbiAgICB3cy5ib3ggPSAnJztcbiAgICB3cy5vbm1lc3NhZ2UgPSB3c0Nvbm5lY3Qub25NZXNzYWdlKHdzcywgd3MpO1xuICAgIC8vIHdzLm9ubWVzc2FnZSA9IChkYXRhKSA9PiB7Y29uc29sZS5sb2coZGF0YSl9O1xuICAgIC8vIHdzLm9ub3BlbiA9ICgpID0+IHtjb25zb2xlLmxvZyhcIldlYlNvY2tldCBpcyBjb25uZWN0ZWQuXCIpfTtcbiAgICAvLyB3cy5vbmNsb3NlID0gKCkgPT4ge2NvbnNvbGUubG9nKFwiV2ViU29ja2V0IGNsb3NlIGNvbm5lY3Rpb24uXCIpfTtcbiAgfSk7XG59KTtcblxuY29uc3QgUE9SVCA9IHByb2Nlc3MuZW52LlBPUlQgfHwgNDAwMDtcbnNlcnZlci5saXN0ZW4oUE9SVCwgKCkgPT4ge1xuICAgIGNvbnNvbGUubG9nKGBMaXN0ZW5pbmcgb24gaHR0cDovL2xvY2FsaG9zdDoke1BPUlR9YCk7XG59KTsiXSwibWFwcGluZ3MiOiI7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQWdDO0FBR2hDQSxpQkFBSyxDQUFDQyxPQUFPLEVBQUU7QUFFZixJQUFNQyxHQUFHLEdBQUcsSUFBQUMsbUJBQU8sR0FBRTtBQUNyQixJQUFNQyxNQUFNLEdBQUdDLGdCQUFJLENBQUNDLFlBQVksQ0FBQ0osR0FBRyxDQUFDO0FBQ3JDLElBQU1LLEdBQUcsR0FBRyxJQUFJQyxjQUFTLENBQUNDLE1BQU0sQ0FBQztFQUFDTCxNQUFNLEVBQU5BO0FBQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUM1QyxJQUFNTSxFQUFFLEdBQUdDLG9CQUFRLENBQUNDLFVBQVUsQ0FBQyxDQUFDOztBQUVoQ0YsRUFBRSxDQUFDRyxJQUFJLENBQUMsTUFBTSxFQUFFLFlBQU07RUFDcEI7RUFDQUMsT0FBTyxDQUFDQyxHQUFHLENBQUMsb0JBQW9CLENBQUM7RUFDakM7RUFDQVIsR0FBRyxDQUFDUyxFQUFFLENBQUMsWUFBWSxFQUFFLFVBQUNDLEVBQUUsRUFBSztJQUMzQkEsRUFBRSxDQUFDQyxHQUFHLEdBQUcsRUFBRTtJQUNYRCxFQUFFLENBQUNFLFNBQVMsR0FBR0MscUJBQVMsQ0FBQ0MsU0FBUyxDQUFDZCxHQUFHLEVBQUVVLEVBQUUsQ0FBQztJQUMzQztJQUNBO0lBQ0E7RUFDRixDQUFDLENBQUM7QUFDSixDQUFDLENBQUM7O0FBRUYsSUFBTUssSUFBSSxHQUFHQyxPQUFPLENBQUNDLEdBQUcsQ0FBQ0YsSUFBSSxJQUFJLElBQUk7QUFDckNsQixNQUFNLENBQUNxQixNQUFNLENBQUNILElBQUksRUFBRSxZQUFNO0VBQ3RCUixPQUFPLENBQUNDLEdBQUcseUNBQWtDTyxJQUFJLEVBQUc7QUFDeEQsQ0FBQyxDQUFDIn0=","map":{"version":3,"names":["mongo","connect","app","express","server","http","createServer","wss","WebSocket","Server","db","mongoose","connection","once","console","log","on","ws","box","onmessage","wsConnect","onMessage","PORT","process","env","listen"],"sourceRoot":"/Users/edlin/Desktop/wp1111/hw7/backend/src/","sources":["server.js"],"sourcesContent":["import express from 'express';\nimport http from 'http';\nimport wsConnect from './wsConnect';\nimport mongo from './mongo';\nimport WebSocket from 'ws';\nimport mongoose from 'mongoose';\n\n\nmongo.connect();\n\nconst app = express();\nconst server = http.createServer(app);\nconst wss = new WebSocket.Server({server}); // WebSocket Server\nconst db = mongoose.connection; // database 的變數名稱\n\ndb.once('open', () => {\n  //\n  console.log(\"MongoDB connected!\");\n  // Define ws format for client side \n  wss.on('connection', (ws) => {\n    ws.box = '';\n    ws.onmessage = wsConnect.onMessage(wss, ws);\n    // ws.onmessage = (data) => {console.log(data)};\n    // ws.onopen = () => {console.log(\"WebSocket is connected.\")};\n    // ws.onclose = () => {console.log(\"WebSocket close connection.\")};\n  });\n});\n\nconst PORT = process.env.PORT || 4000;\nserver.listen(PORT, () => {\n    console.log(`Listening on http://localhost:${PORT}`);\n});"],"mappings":";;AAAA;AACA;AACA;AACA;AACA;AACA;AAAgC;AAGhCA,iBAAK,CAACC,OAAO,EAAE;AAEf,IAAMC,GAAG,GAAG,IAAAC,mBAAO,GAAE;AACrB,IAAMC,MAAM,GAAGC,gBAAI,CAACC,YAAY,CAACJ,GAAG,CAAC;AACrC,IAAMK,GAAG,GAAG,IAAIC,cAAS,CAACC,MAAM,CAAC;EAACL,MAAM,EAANA;AAAM,CAAC,CAAC,CAAC,CAAC;AAC5C,IAAMM,EAAE,GAAGC,oBAAQ,CAACC,UAAU,CAAC,CAAC;;AAEhCF,EAAE,CAACG,IAAI,CAAC,MAAM,EAAE,YAAM;EACpB;EACAC,OAAO,CAACC,GAAG,CAAC,oBAAoB,CAAC;EACjC;EACAR,GAAG,CAACS,EAAE,CAAC,YAAY,EAAE,UAACC,EAAE,EAAK;IAC3BA,EAAE,CAACC,GAAG,GAAG,EAAE;IACXD,EAAE,CAACE,SAAS,GAAGC,qBAAS,CAACC,SAAS,CAACd,GAAG,EAAEU,EAAE,CAAC;IAC3C;IACA;IACA;EACF,CAAC,CAAC;AACJ,CAAC,CAAC;;AAEF,IAAMK,IAAI,GAAGC,OAAO,CAACC,GAAG,CAACF,IAAI,IAAI,IAAI;AACrClB,MAAM,CAACqB,MAAM,CAACH,IAAI,EAAE,YAAM;EACtBR,OAAO,CAACC,GAAG,yCAAkCO,IAAI,EAAG;AACxD,CAAC,CAAC"}},"mtime":1669165647559},"{\"assumptions\":{},\"sourceRoot\":\"/Users/edlin/Desktop/wp1111/hw7/backend/src/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/edlin/Desktop/wp1111/hw7/backend\",\"filename\":\"/Users/edlin/Desktop/wp1111/hw7/backend/src/wsConnect.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/edlin/Desktop/wp1111/hw7/backend\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"proposal-class-static-block\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ClassBody\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-private-property-in-object\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"BinaryExpression\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"proposal-class-properties\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"proposal-private-methods\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"proposal-numeric-separator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"NumericLiteral\":{\"enter\":[null]},\"BigIntLiteral\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-logical-assignment-operators\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"AssignmentExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":true,\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-json-strings\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"DirectiveLiteral\":{\"enter\":[null]},\"StringLiteral\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-optional-catch-binding\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"CatchClause\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-parameters\",\"visitor\":{\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-async-generator-functions\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-object-rest-spread\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"VariableDeclarator\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dotall-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-unicode-property-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-named-capturing-groups-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-async-to-generator\",\"visitor\":{\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-exponentiation-operator\",\"visitor\":{\"AssignmentExpression\":{\"enter\":[null]},\"BinaryExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-template-literals\",\"visitor\":{\"TaggedTemplateExpression\":{\"enter\":[null]},\"TemplateLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-literals\",\"visitor\":{\"NumericLiteral\":{\"enter\":[null]},\"StringLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-function-name\",\"visitor\":{\"FunctionExpression\":{\"exit\":[null]},\"ObjectProperty\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-arrow-functions\",\"visitor\":{\"ArrowFunctionExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-block-scoped-functions\",\"visitor\":{\"BlockStatement\":{\"enter\":[null]},\"SwitchCase\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-classes\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]},\"ClassExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-object-super\",\"visitor\":{\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-shorthand-properties\",\"visitor\":{\"ObjectMethod\":{\"enter\":[null]},\"ObjectProperty\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-duplicate-keys\",\"visitor\":{\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-computed-properties\",\"visitor\":{\"ObjectExpression\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-for-of\",\"visitor\":{\"ForOfStatement\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-sticky-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-unicode-escapes\",\"visitor\":{\"Identifier\":{\"enter\":[null]},\"TemplateElement\":{\"enter\":[null]},\"_exploded\":true,\"StringLiteral\":{\"enter\":[null]},\"DirectiveLiteral\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-unicode-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-spread\",\"visitor\":{\"ArrayExpression\":{\"enter\":[null]},\"CallExpression\":{\"enter\":[null]},\"NewExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-destructuring\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"VariableDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-block-scoping\",\"visitor\":{\"VariableDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"_exploded\":true,\"BlockStatement\":{\"enter\":[null]},\"SwitchStatement\":{\"enter\":[null]},\"Program\":{\"enter\":[null]},\"_verified\":true,\"DoWhileStatement\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForStatement\":{\"enter\":[null]},\"WhileStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-typeof-symbol\",\"visitor\":{\"UnaryExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"BlockStatement\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"DoWhileStatement\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForStatement\":{\"enter\":[null]},\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"Program\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"SwitchStatement\":{\"enter\":[null]},\"WhileStatement\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"StaticBlock\":{\"enter\":[null]},\"TSModuleBlock\":{\"enter\":[null]},\"AssignmentPattern\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectPattern\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-new-target\",\"visitor\":{\"MetaProperty\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-regenerator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ObjectMethod\":{\"enter\":[null],\"exit\":[null]},\"ClassMethod\":{\"enter\":[null],\"exit\":[null]},\"ClassPrivateMethod\":{\"enter\":[null],\"exit\":[null]},\"FunctionDeclaration\":{\"exit\":[null]},\"FunctionExpression\":{\"exit\":[null]},\"ArrowFunctionExpression\":{\"exit\":[null]},\"MemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-member-expression-literals\",\"visitor\":{\"MemberExpression\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-property-literals\",\"visitor\":{\"ObjectProperty\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-reserved-words\",\"visitor\":{\"_exploded\":true,\"_verified\":true,\"Identifier\":{\"enter\":[null,null]},\"JSXIdentifier\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.20.2:development":{"value":{"code":"\"use strict\";\n\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, _typeof(obj); }\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\nvar _mongoose = _interopRequireDefault(require(\"mongoose\"));\nvar _ws = _interopRequireDefault(require(\"ws\"));\nvar _chatbox = require(\"./models/chatbox\");\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\nfunction _iterableToArrayLimit(arr, i) { var _i = arr == null ? null : typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"]; if (_i == null) return; var _arr = []; var _n = true; var _d = false; var _s, _e; try { for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\nfunction _regeneratorRuntime() { \"use strict\"; /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */ _regeneratorRuntime = function _regeneratorRuntime() { return exports; }; var exports = {}, Op = Object.prototype, hasOwn = Op.hasOwnProperty, defineProperty = Object.defineProperty || function (obj, key, desc) { obj[key] = desc.value; }, $Symbol = \"function\" == typeof Symbol ? Symbol : {}, iteratorSymbol = $Symbol.iterator || \"@@iterator\", asyncIteratorSymbol = $Symbol.asyncIterator || \"@@asyncIterator\", toStringTagSymbol = $Symbol.toStringTag || \"@@toStringTag\"; function define(obj, key, value) { return Object.defineProperty(obj, key, { value: value, enumerable: !0, configurable: !0, writable: !0 }), obj[key]; } try { define({}, \"\"); } catch (err) { define = function define(obj, key, value) { return obj[key] = value; }; } function wrap(innerFn, outerFn, self, tryLocsList) { var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator, generator = Object.create(protoGenerator.prototype), context = new Context(tryLocsList || []); return defineProperty(generator, \"_invoke\", { value: makeInvokeMethod(innerFn, self, context) }), generator; } function tryCatch(fn, obj, arg) { try { return { type: \"normal\", arg: fn.call(obj, arg) }; } catch (err) { return { type: \"throw\", arg: err }; } } exports.wrap = wrap; var ContinueSentinel = {}; function Generator() {} function GeneratorFunction() {} function GeneratorFunctionPrototype() {} var IteratorPrototype = {}; define(IteratorPrototype, iteratorSymbol, function () { return this; }); var getProto = Object.getPrototypeOf, NativeIteratorPrototype = getProto && getProto(getProto(values([]))); NativeIteratorPrototype && NativeIteratorPrototype !== Op && hasOwn.call(NativeIteratorPrototype, iteratorSymbol) && (IteratorPrototype = NativeIteratorPrototype); var Gp = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(IteratorPrototype); function defineIteratorMethods(prototype) { [\"next\", \"throw\", \"return\"].forEach(function (method) { define(prototype, method, function (arg) { return this._invoke(method, arg); }); }); } function AsyncIterator(generator, PromiseImpl) { function invoke(method, arg, resolve, reject) { var record = tryCatch(generator[method], generator, arg); if (\"throw\" !== record.type) { var result = record.arg, value = result.value; return value && \"object\" == _typeof(value) && hasOwn.call(value, \"__await\") ? PromiseImpl.resolve(value.__await).then(function (value) { invoke(\"next\", value, resolve, reject); }, function (err) { invoke(\"throw\", err, resolve, reject); }) : PromiseImpl.resolve(value).then(function (unwrapped) { result.value = unwrapped, resolve(result); }, function (error) { return invoke(\"throw\", error, resolve, reject); }); } reject(record.arg); } var previousPromise; defineProperty(this, \"_invoke\", { value: function value(method, arg) { function callInvokeWithMethodAndArg() { return new PromiseImpl(function (resolve, reject) { invoke(method, arg, resolve, reject); }); } return previousPromise = previousPromise ? previousPromise.then(callInvokeWithMethodAndArg, callInvokeWithMethodAndArg) : callInvokeWithMethodAndArg(); } }); } function makeInvokeMethod(innerFn, self, context) { var state = \"suspendedStart\"; return function (method, arg) { if (\"executing\" === state) throw new Error(\"Generator is already running\"); if (\"completed\" === state) { if (\"throw\" === method) throw arg; return doneResult(); } for (context.method = method, context.arg = arg;;) { var delegate = context.delegate; if (delegate) { var delegateResult = maybeInvokeDelegate(delegate, context); if (delegateResult) { if (delegateResult === ContinueSentinel) continue; return delegateResult; } } if (\"next\" === context.method) context.sent = context._sent = context.arg;else if (\"throw\" === context.method) { if (\"suspendedStart\" === state) throw state = \"completed\", context.arg; context.dispatchException(context.arg); } else \"return\" === context.method && context.abrupt(\"return\", context.arg); state = \"executing\"; var record = tryCatch(innerFn, self, context); if (\"normal\" === record.type) { if (state = context.done ? \"completed\" : \"suspendedYield\", record.arg === ContinueSentinel) continue; return { value: record.arg, done: context.done }; } \"throw\" === record.type && (state = \"completed\", context.method = \"throw\", context.arg = record.arg); } }; } function maybeInvokeDelegate(delegate, context) { var method = delegate.iterator[context.method]; if (undefined === method) { if (context.delegate = null, \"throw\" === context.method) { if (delegate.iterator[\"return\"] && (context.method = \"return\", context.arg = undefined, maybeInvokeDelegate(delegate, context), \"throw\" === context.method)) return ContinueSentinel; context.method = \"throw\", context.arg = new TypeError(\"The iterator does not provide a 'throw' method\"); } return ContinueSentinel; } var record = tryCatch(method, delegate.iterator, context.arg); if (\"throw\" === record.type) return context.method = \"throw\", context.arg = record.arg, context.delegate = null, ContinueSentinel; var info = record.arg; return info ? info.done ? (context[delegate.resultName] = info.value, context.next = delegate.nextLoc, \"return\" !== context.method && (context.method = \"next\", context.arg = undefined), context.delegate = null, ContinueSentinel) : info : (context.method = \"throw\", context.arg = new TypeError(\"iterator result is not an object\"), context.delegate = null, ContinueSentinel); } function pushTryEntry(locs) { var entry = { tryLoc: locs[0] }; 1 in locs && (entry.catchLoc = locs[1]), 2 in locs && (entry.finallyLoc = locs[2], entry.afterLoc = locs[3]), this.tryEntries.push(entry); } function resetTryEntry(entry) { var record = entry.completion || {}; record.type = \"normal\", delete record.arg, entry.completion = record; } function Context(tryLocsList) { this.tryEntries = [{ tryLoc: \"root\" }], tryLocsList.forEach(pushTryEntry, this), this.reset(!0); } function values(iterable) { if (iterable) { var iteratorMethod = iterable[iteratorSymbol]; if (iteratorMethod) return iteratorMethod.call(iterable); if (\"function\" == typeof iterable.next) return iterable; if (!isNaN(iterable.length)) { var i = -1, next = function next() { for (; ++i < iterable.length;) { if (hasOwn.call(iterable, i)) return next.value = iterable[i], next.done = !1, next; } return next.value = undefined, next.done = !0, next; }; return next.next = next; } } return { next: doneResult }; } function doneResult() { return { value: undefined, done: !0 }; } return GeneratorFunction.prototype = GeneratorFunctionPrototype, defineProperty(Gp, \"constructor\", { value: GeneratorFunctionPrototype, configurable: !0 }), defineProperty(GeneratorFunctionPrototype, \"constructor\", { value: GeneratorFunction, configurable: !0 }), GeneratorFunction.displayName = define(GeneratorFunctionPrototype, toStringTagSymbol, \"GeneratorFunction\"), exports.isGeneratorFunction = function (genFun) { var ctor = \"function\" == typeof genFun && genFun.constructor; return !!ctor && (ctor === GeneratorFunction || \"GeneratorFunction\" === (ctor.displayName || ctor.name)); }, exports.mark = function (genFun) { return Object.setPrototypeOf ? Object.setPrototypeOf(genFun, GeneratorFunctionPrototype) : (genFun.__proto__ = GeneratorFunctionPrototype, define(genFun, toStringTagSymbol, \"GeneratorFunction\")), genFun.prototype = Object.create(Gp), genFun; }, exports.awrap = function (arg) { return { __await: arg }; }, defineIteratorMethods(AsyncIterator.prototype), define(AsyncIterator.prototype, asyncIteratorSymbol, function () { return this; }), exports.AsyncIterator = AsyncIterator, exports.async = function (innerFn, outerFn, self, tryLocsList, PromiseImpl) { void 0 === PromiseImpl && (PromiseImpl = Promise); var iter = new AsyncIterator(wrap(innerFn, outerFn, self, tryLocsList), PromiseImpl); return exports.isGeneratorFunction(outerFn) ? iter : iter.next().then(function (result) { return result.done ? result.value : iter.next(); }); }, defineIteratorMethods(Gp), define(Gp, toStringTagSymbol, \"Generator\"), define(Gp, iteratorSymbol, function () { return this; }), define(Gp, \"toString\", function () { return \"[object Generator]\"; }), exports.keys = function (val) { var object = Object(val), keys = []; for (var key in object) { keys.push(key); } return keys.reverse(), function next() { for (; keys.length;) { var key = keys.pop(); if (key in object) return next.value = key, next.done = !1, next; } return next.done = !0, next; }; }, exports.values = values, Context.prototype = { constructor: Context, reset: function reset(skipTempReset) { if (this.prev = 0, this.next = 0, this.sent = this._sent = undefined, this.done = !1, this.delegate = null, this.method = \"next\", this.arg = undefined, this.tryEntries.forEach(resetTryEntry), !skipTempReset) for (var name in this) { \"t\" === name.charAt(0) && hasOwn.call(this, name) && !isNaN(+name.slice(1)) && (this[name] = undefined); } }, stop: function stop() { this.done = !0; var rootRecord = this.tryEntries[0].completion; if (\"throw\" === rootRecord.type) throw rootRecord.arg; return this.rval; }, dispatchException: function dispatchException(exception) { if (this.done) throw exception; var context = this; function handle(loc, caught) { return record.type = \"throw\", record.arg = exception, context.next = loc, caught && (context.method = \"next\", context.arg = undefined), !!caught; } for (var i = this.tryEntries.length - 1; i >= 0; --i) { var entry = this.tryEntries[i], record = entry.completion; if (\"root\" === entry.tryLoc) return handle(\"end\"); if (entry.tryLoc <= this.prev) { var hasCatch = hasOwn.call(entry, \"catchLoc\"), hasFinally = hasOwn.call(entry, \"finallyLoc\"); if (hasCatch && hasFinally) { if (this.prev < entry.catchLoc) return handle(entry.catchLoc, !0); if (this.prev < entry.finallyLoc) return handle(entry.finallyLoc); } else if (hasCatch) { if (this.prev < entry.catchLoc) return handle(entry.catchLoc, !0); } else { if (!hasFinally) throw new Error(\"try statement without catch or finally\"); if (this.prev < entry.finallyLoc) return handle(entry.finallyLoc); } } } }, abrupt: function abrupt(type, arg) { for (var i = this.tryEntries.length - 1; i >= 0; --i) { var entry = this.tryEntries[i]; if (entry.tryLoc <= this.prev && hasOwn.call(entry, \"finallyLoc\") && this.prev < entry.finallyLoc) { var finallyEntry = entry; break; } } finallyEntry && (\"break\" === type || \"continue\" === type) && finallyEntry.tryLoc <= arg && arg <= finallyEntry.finallyLoc && (finallyEntry = null); var record = finallyEntry ? finallyEntry.completion : {}; return record.type = type, record.arg = arg, finallyEntry ? (this.method = \"next\", this.next = finallyEntry.finallyLoc, ContinueSentinel) : this.complete(record); }, complete: function complete(record, afterLoc) { if (\"throw\" === record.type) throw record.arg; return \"break\" === record.type || \"continue\" === record.type ? this.next = record.arg : \"return\" === record.type ? (this.rval = this.arg = record.arg, this.method = \"return\", this.next = \"end\") : \"normal\" === record.type && afterLoc && (this.next = afterLoc), ContinueSentinel; }, finish: function finish(finallyLoc) { for (var i = this.tryEntries.length - 1; i >= 0; --i) { var entry = this.tryEntries[i]; if (entry.finallyLoc === finallyLoc) return this.complete(entry.completion, entry.afterLoc), resetTryEntry(entry), ContinueSentinel; } }, \"catch\": function _catch(tryLoc) { for (var i = this.tryEntries.length - 1; i >= 0; --i) { var entry = this.tryEntries[i]; if (entry.tryLoc === tryLoc) { var record = entry.completion; if (\"throw\" === record.type) { var thrown = record.arg; resetTryEntry(entry); } return thrown; } } throw new Error(\"illegal catch attempt\"); }, delegateYield: function delegateYield(iterable, resultName, nextLoc) { return this.delegate = { iterator: values(iterable), resultName: resultName, nextLoc: nextLoc }, \"next\" === this.method && (this.arg = undefined), ContinueSentinel; } }, exports; }\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\nfunction _createForOfIteratorHelper(o, allowArrayLike) { var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"]; if (!it) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e2) { throw _e2; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = it.call(o); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e3) { didErr = true; err = _e3; }, f: function f() { try { if (!normalCompletion && it[\"return\"] != null) it[\"return\"](); } finally { if (didErr) throw err; } } }; }\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\nvar sendData = function sendData(data, wsSet) {\n  // console.log('type of wsSet:', typeof(wsSet));\n  // console.log('wsSet:', wsSet);\n\n  if (Object.getPrototypeOf(wsSet) === Set.prototype) {\n    //對 set 中的每個 ws 進行迭代\n    var _iterator = _createForOfIteratorHelper(wsSet),\n      _step;\n    try {\n      for (_iterator.s(); !(_step = _iterator.n()).done;) {\n        var item = _step.value;\n        item.send(JSON.stringify(data));\n      }\n      // console.log('case 1');\n    } catch (err) {\n      _iterator.e(err);\n    } finally {\n      _iterator.f();\n    }\n  } else {\n    wsSet.send(JSON.stringify(data));\n    // console.log('case 2');\n  }\n\n  console.log('Data send success.');\n};\nvar sendStatus = function sendStatus(payload, ws) {\n  sendData([\"status\", payload], ws);\n};\n\n// Create Chatroom ID\nvar makeName = function makeName(name, friend) {\n  return [name, friend].sort().join('_');\n};\n\n// Check ChatRoom exists or not\nvar validateChatBox = /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(chatRoomName, name, friend) {\n    var box, myId, friendId;\n    return _regeneratorRuntime().wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.next = 2;\n            return _chatbox.ChatBoxModel.findOne({\n              name: chatRoomName\n            });\n          case 2:\n            box = _context.sent;\n            console.log(\"box:\", box);\n            console.log(\"chatBoxName:\", chatRoomName);\n            _context.next = 7;\n            return _chatbox.UserModel.findOne({\n              name: name\n            });\n          case 7:\n            myId = _context.sent;\n            _context.next = 10;\n            return _chatbox.UserModel.findOne({\n              name: friend\n            });\n          case 10:\n            friendId = _context.sent;\n            // if not exist -> create a chatbox model.\n            if (!box)\n              // 要先有users ObjectId.\n              console.log('ChatBoxModel不存在 -> 建立ChatBoxModel');\n            _context.next = 14;\n            return new _chatbox.ChatBoxModel({\n              name: chatRoomName,\n              users: [myId._id, friendId._id]\n            }).save();\n          case 14:\n            box = _context.sent;\n            _context.next = 17;\n            return myId.updateOne({\n              \"$push\": {\n                chatBoxes: box._id\n              }\n            });\n          case 17:\n            _context.next = 19;\n            return friendId.updateOne({\n              \"$push\": {\n                chatBoxes: box._id\n              }\n            });\n          case 19:\n            return _context.abrupt(\"return\", box.populate([\"users\", {\n              path: 'messages',\n              populate: 'sender'\n            }]));\n          case 20:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n  return function validateChatBox(_x, _x2, _x3) {\n    return _ref.apply(this, arguments);\n  };\n}();\n\n// Create Users\nvar makeUsers = /*#__PURE__*/function () {\n  var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2(myName, friend) {\n    var user1, user2;\n    return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            console.log('User names', myName, friend);\n            _context2.next = 3;\n            return _chatbox.UserModel.findOne({\n              name: myName\n            });\n          case 3:\n            user1 = _context2.sent;\n            _context2.next = 6;\n            return _chatbox.UserModel.findOne({\n              name: friend\n            });\n          case 6:\n            user2 = _context2.sent;\n            if (user1) {\n              _context2.next = 11;\n              break;\n            }\n            _context2.next = 10;\n            return new _chatbox.UserModel({\n              name: myName\n            }).save();\n          case 10:\n            user1 = _context2.sent;\n          case 11:\n            if (user2) {\n              _context2.next = 15;\n              break;\n            }\n            _context2.next = 14;\n            return new _chatbox.UserModel({\n              name: friend\n            }).save();\n          case 14:\n            user2 = _context2.sent;\n          case 15:\n            console.log(\"Users_id \", [user1._id, user2._id]);\n          case 16:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2);\n  }));\n  return function makeUsers(_x4, _x5) {\n    return _ref2.apply(this, arguments);\n  };\n}();\n\n// 建立一個 dictionary of { chatBoxName, Set<ws> }, -> key: value -> \"chatBoxName\": set(ws...)\n// 可以從 chatbox name 找到當前有哪些 websockets / ChatRooms \n// 有這個名字的 chatbox 且為 active\nvar chatBoxes = {};\nvar _default = {\n  // 解析client傳來的資料\n  onMessage: function onMessage(wss, ws) {\n    return /*#__PURE__*/function () {\n      var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3(byteString) {\n        var data, _JSON$parse, _JSON$parse2, task, payload, name, friend, chatBoxName, chatBoxObject, messages, body, _chatBoxObject, senderObject, message;\n        return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                data = byteString.data;\n                _JSON$parse = JSON.parse(data), _JSON$parse2 = _slicedToArray(_JSON$parse, 2), task = _JSON$parse2[0], payload = _JSON$parse2[1];\n                name = payload.name, friend = payload.friend; // user(ws) was in another chatbox\n                if (ws.box !== \"\" && chatBoxes[ws.box]) {\n                  chatBoxes[ws.box][\"delete\"](ws);\n                }\n                // ws 因故關閉\n                ws.once('close', function () {\n                  chatBoxes[ws.box][\"delete\"](ws);\n                });\n\n                // create Chatroom ID\n                chatBoxName = makeName(name, friend);\n                ws.box = chatBoxName;\n\n                // Create Users\n                if (!(name !== undefined)) {\n                  _context3.next = 10;\n                  break;\n                }\n                _context3.next = 10;\n                return makeUsers(name, friend);\n              case 10:\n                _context3.t0 = console;\n                _context3.next = 13;\n                return validateChatBox(chatBoxName, name, friend);\n              case 13:\n                _context3.t1 = _context3.sent;\n                _context3.t0.log.call(_context3.t0, 'Validation of chat box:', _context3.t1);\n                // console.log( validateChatBox(chatBoxName, participants) );\n\n                // ws dict\n                // 如果不曾有過 chatBoxName 的對話，將 chatBoxes[chatBoxName] 設定為 empty Set\n                if (!chatBoxes[chatBoxName]) {\n                  console.log(\"Chat Box 不存在，創建chatRoom\");\n                  chatBoxes[chatBoxName] = new Set(); // make new record for chatbox\n                }\n                // 將 ws client 加入 chatBoxes[chatBoxName] \n                chatBoxes[chatBoxName].add(ws); // add this open connection into chatbox\n                _context3.t2 = task;\n                _context3.next = _context3.t2 === 'Init' ? 20 : _context3.t2 === 'input' ? 35 : 61;\n                break;\n              case 20:\n                _context3.next = 22;\n                return _chatbox.ChatBoxModel.findOne({\n                  name: chatBoxName\n                });\n              case 22:\n                chatBoxObject = _context3.sent;\n                _context3.next = 25;\n                return _chatbox.MessageModel.find({\n                  chatBox: chatBoxObject._id\n                }).populate('chatBox').populate('sender');\n              case 25:\n                messages = _context3.sent;\n                _context3.prev = 26;\n                sendData(['Init', messages, chatBoxName], ws);\n                sendStatus({\n                  // {['status',{type, msg}]}\n                  type: \"success\",\n                  msg: \"Successfully Open one Chatroom\"\n                }, ws);\n                _context3.next = 34;\n                break;\n              case 31:\n                _context3.prev = 31;\n                _context3.t3 = _context3[\"catch\"](26);\n                throw new Error(\"Message sending is failed: \" + _context3.t3);\n              case 34:\n                return _context3.abrupt(\"break\", 62);\n              case 35:\n                body = payload.body; // Save message to DB\n                _context3.next = 38;\n                return _chatbox.ChatBoxModel.findOne({\n                  name: chatBoxName\n                });\n              case 38:\n                _chatBoxObject = _context3.sent;\n                _context3.next = 41;\n                return _chatbox.UserModel.findOne({\n                  name: name\n                });\n              case 41:\n                senderObject = _context3.sent;\n                console.log('Ids:', _chatBoxObject._id, senderObject._id);\n                _context3.next = 45;\n                return new _chatbox.MessageModel({\n                  chatBox: _chatBoxObject._id,\n                  sender: senderObject._id,\n                  body: body\n                }).save();\n              case 45:\n                message = _context3.sent;\n                _context3.prev = 46;\n                _context3.next = 49;\n                return _chatbox.ChatBoxModel.findOneAndUpdate({\n                  name: chatBoxName\n                }, {\n                  \"$push\": {\n                    \"messages\": message._id\n                  }\n                }, {\n                  \"new\": true\n                });\n              case 49:\n                _context3.next = 51;\n                return message.populate(\"chatBox\");\n              case 51:\n                _context3.next = 53;\n                return _context3.sent.populate(\"sender\");\n              case 53:\n                // sendData(['backToSender', message, chatBoxName], ws) // ['backToSender', message]\n                // sendStatus({    // {['status',{type, msg}]}\n                //     type: \"success\",\n                //     msg: \"Successfully sent one message\",\n                // }, ws)\n\n                // Respond to Receiver\n                sendData(['backToReceiver', message, chatBoxName], chatBoxes[chatBoxName]);\n                sendStatus({\n                  type: 'success',\n                  msg: \"Successfully receive one message\"\n                }, chatBoxes[chatBoxName]);\n                _context3.next = 60;\n                break;\n              case 57:\n                _context3.prev = 57;\n                _context3.t4 = _context3[\"catch\"](46);\n                throw new Error(\"Message sending is failed: \" + _context3.t4);\n              case 60:\n                return _context3.abrupt(\"break\", 62);\n              case 61:\n                return _context3.abrupt(\"break\", 62);\n              case 62:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, null, [[26, 31], [46, 57]]);\n      }));\n      return function (_x6) {\n        return _ref3.apply(this, arguments);\n      };\n    }();\n  }\n};\nexports[\"default\"] = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJzZW5kRGF0YSIsImRhdGEiLCJ3c1NldCIsIk9iamVjdCIsImdldFByb3RvdHlwZU9mIiwiU2V0IiwicHJvdG90eXBlIiwiaXRlbSIsInNlbmQiLCJKU09OIiwic3RyaW5naWZ5IiwiY29uc29sZSIsImxvZyIsInNlbmRTdGF0dXMiLCJwYXlsb2FkIiwid3MiLCJtYWtlTmFtZSIsIm5hbWUiLCJmcmllbmQiLCJzb3J0Iiwiam9pbiIsInZhbGlkYXRlQ2hhdEJveCIsImNoYXRSb29tTmFtZSIsIkNoYXRCb3hNb2RlbCIsImZpbmRPbmUiLCJib3giLCJVc2VyTW9kZWwiLCJteUlkIiwiZnJpZW5kSWQiLCJ1c2VycyIsIl9pZCIsInNhdmUiLCJ1cGRhdGVPbmUiLCJjaGF0Qm94ZXMiLCJwb3B1bGF0ZSIsInBhdGgiLCJtYWtlVXNlcnMiLCJteU5hbWUiLCJ1c2VyMSIsInVzZXIyIiwib25NZXNzYWdlIiwid3NzIiwiYnl0ZVN0cmluZyIsInBhcnNlIiwidGFzayIsIm9uY2UiLCJjaGF0Qm94TmFtZSIsInVuZGVmaW5lZCIsImFkZCIsImNoYXRCb3hPYmplY3QiLCJNZXNzYWdlTW9kZWwiLCJmaW5kIiwiY2hhdEJveCIsIm1lc3NhZ2VzIiwidHlwZSIsIm1zZyIsIkVycm9yIiwiYm9keSIsInNlbmRlck9iamVjdCIsInNlbmRlciIsIm1lc3NhZ2UiLCJmaW5kT25lQW5kVXBkYXRlIl0sInNvdXJjZVJvb3QiOiIvVXNlcnMvZWRsaW4vRGVza3RvcC93cDExMTEvaHc3L2JhY2tlbmQvc3JjLyIsInNvdXJjZXMiOlsid3NDb25uZWN0LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBtb25nb29zZSBmcm9tIFwibW9uZ29vc2VcIjtcbmltcG9ydCBXZWJTb2NrZXQgZnJvbSAnd3MnO1xuXG5pbXBvcnQge1VzZXJNb2RlbCwgTWVzc2FnZU1vZGVsLCBDaGF0Qm94TW9kZWx9IGZyb20gXCIuL21vZGVscy9jaGF0Ym94XCI7XG5cbmNvbnN0IHNlbmREYXRhID0gKGRhdGEsIHdzU2V0KSA9PiB7XG5cbiAgICAvLyBjb25zb2xlLmxvZygndHlwZSBvZiB3c1NldDonLCB0eXBlb2Yod3NTZXQpKTtcbiAgICAvLyBjb25zb2xlLmxvZygnd3NTZXQ6Jywgd3NTZXQpO1xuXG4gICAgaWYoIE9iamVjdC5nZXRQcm90b3R5cGVPZih3c1NldCkgPT09IFNldC5wcm90b3R5cGUgKXtcbiAgICAgICAgLy/lsI0gc2V0IOS4reeahOavj+WAiyB3cyDpgLLooYzov63ku6NcbiAgICAgICAgZm9yIChsZXQgaXRlbSBvZiB3c1NldCl7XG4gICAgICAgICAgICBpdGVtLnNlbmQoSlNPTi5zdHJpbmdpZnkoZGF0YSkpOyBcbiAgICAgICAgfVxuICAgICAgICAvLyBjb25zb2xlLmxvZygnY2FzZSAxJyk7XG4gICAgfVxuICAgIGVsc2V7XG4gICAgICAgIHdzU2V0LnNlbmQoSlNPTi5zdHJpbmdpZnkoZGF0YSkpOyBcbiAgICAgICAgLy8gY29uc29sZS5sb2coJ2Nhc2UgMicpO1xuXG4gICAgfVxuXG4gICAgY29uc29sZS5sb2coJ0RhdGEgc2VuZCBzdWNjZXNzLicpXG59XG5jb25zdCBzZW5kU3RhdHVzID0gKHBheWxvYWQsIHdzKSA9PiB7XG4gICAgc2VuZERhdGEoW1wic3RhdHVzXCIsIHBheWxvYWRdLCB3cyk7IFxufVxuXG4vLyBDcmVhdGUgQ2hhdHJvb20gSURcbmNvbnN0IG1ha2VOYW1lID0gKG5hbWUsIGZyaWVuZCkgPT4ge1xuICAgIHJldHVybiBbbmFtZSwgZnJpZW5kXS5zb3J0KCkuam9pbignXycpO1xufVxuXG4vLyBDaGVjayBDaGF0Um9vbSBleGlzdHMgb3Igbm90XG5jb25zdCB2YWxpZGF0ZUNoYXRCb3ggPSBhc3luYyAoY2hhdFJvb21OYW1lLCBuYW1lLCBmcmllbmQpID0+IHtcbiAgICBsZXQgYm94ID0gYXdhaXQgQ2hhdEJveE1vZGVsLmZpbmRPbmUoeyBuYW1lOiBjaGF0Um9vbU5hbWUgfSk7XG4gICAgY29uc29sZS5sb2coXCJib3g6XCIsIGJveCk7XG4gICAgY29uc29sZS5sb2coXCJjaGF0Qm94TmFtZTpcIiwgY2hhdFJvb21OYW1lKTtcblxuICAgIGNvbnN0IG15SWQgPSBhd2FpdCBVc2VyTW9kZWwuZmluZE9uZSh7bmFtZTogbmFtZX0pO1xuICAgIGNvbnN0IGZyaWVuZElkID0gYXdhaXQgVXNlck1vZGVsLmZpbmRPbmUoe25hbWU6IGZyaWVuZH0pO1xuICAgIC8vIGlmIG5vdCBleGlzdCAtPiBjcmVhdGUgYSBjaGF0Ym94IG1vZGVsLlxuICAgIGlmICghYm94KVxuICAgICAgICAvLyDopoHlhYjmnIl1c2VycyBPYmplY3RJZC5cbiAgICAgICAgY29uc29sZS5sb2coJ0NoYXRCb3hNb2RlbOS4jeWtmOWcqCAtPiDlu7rnq4tDaGF0Qm94TW9kZWwnKTtcbiAgICAgICAgYm94ID0gYXdhaXQgbmV3IENoYXRCb3hNb2RlbCh7IG5hbWU6IGNoYXRSb29tTmFtZSwgdXNlcnM6IFtteUlkLl9pZCwgZnJpZW5kSWQuX2lkXSB9KS5zYXZlKCk7XG4gICAgICAgIGF3YWl0IG15SWQudXBkYXRlT25lKHtcIiRwdXNoXCI6IHtjaGF0Qm94ZXM6IGJveC5faWR9fSk7XG4gICAgICAgIGF3YWl0IGZyaWVuZElkLnVwZGF0ZU9uZSh7XCIkcHVzaFwiOiB7Y2hhdEJveGVzOiBib3guX2lkfX0pO1xuXG4gICAgcmV0dXJuIGJveC5wb3B1bGF0ZShbXCJ1c2Vyc1wiLCB7cGF0aDogJ21lc3NhZ2VzJywgcG9wdWxhdGU6ICdzZW5kZXInIH1dKTtcbiAgICAvLyByZXR1cm4gW3t1c2VyLCBzZW5kZXJ9XTtcbn1cblxuLy8gQ3JlYXRlIFVzZXJzXG5jb25zdCBtYWtlVXNlcnMgPSBhc3luYyAobXlOYW1lLCBmcmllbmQpID0+IHtcbiAgICBjb25zb2xlLmxvZygnVXNlciBuYW1lcycsIG15TmFtZSwgZnJpZW5kKTtcbiAgICBsZXQgdXNlcjEgPSBhd2FpdCBVc2VyTW9kZWwuZmluZE9uZSh7bmFtZTogbXlOYW1lfSlcbiAgICBsZXQgdXNlcjIgPSBhd2FpdCBVc2VyTW9kZWwuZmluZE9uZSh7bmFtZTogZnJpZW5kfSlcblxuICAgIGlmKCF1c2VyMSl7XG4gICAgICAgIHVzZXIxID0gYXdhaXQgbmV3IFVzZXJNb2RlbCh7bmFtZTogbXlOYW1lfSkuc2F2ZSgpXG4gICAgfVxuICAgIFxuICAgIGlmKCF1c2VyMil7XG4gICAgICAgIHVzZXIyID0gYXdhaXQgbmV3IFVzZXJNb2RlbCh7bmFtZTogZnJpZW5kfSkuc2F2ZSgpXG4gICAgfVxuICAgIGNvbnNvbGUubG9nKFwiVXNlcnNfaWQgXCIsW3VzZXIxLl9pZCwgdXNlcjIuX2lkXSlcbn1cblxuXG4vLyDlu7rnq4vkuIDlgIsgZGljdGlvbmFyeSBvZiB7IGNoYXRCb3hOYW1lLCBTZXQ8d3M+IH0sIC0+IGtleTogdmFsdWUgLT4gXCJjaGF0Qm94TmFtZVwiOiBzZXQod3MuLi4pXG4vLyDlj6/ku6Xlvp4gY2hhdGJveCBuYW1lIOaJvuWIsOeVtuWJjeacieWTquS6myB3ZWJzb2NrZXRzIC8gQ2hhdFJvb21zIFxuLy8g5pyJ6YCZ5YCL5ZCN5a2X55qEIGNoYXRib3gg5LiU54K6IGFjdGl2ZVxuY29uc3QgY2hhdEJveGVzID0ge307XG5cbmV4cG9ydCBkZWZhdWx0IHtcbiAgICAvLyDop6PmnpBjbGllbnTlgrPkvobnmoTos4fmlplcbiAgICBvbk1lc3NhZ2U6ICh3c3MsIHdzKSA9PiAoXG4gICAgICAgIGFzeW5jIChieXRlU3RyaW5nKSA9PiB7XG4gICAgICAgICAgICBjb25zdCB7IGRhdGEgfSA9IGJ5dGVTdHJpbmdcbiAgICAgICAgICAgIGNvbnN0IFsgdGFzaywgcGF5bG9hZCBdID0gSlNPTi5wYXJzZShkYXRhKVxuICAgICAgICAgICAgY29uc3QgeyBuYW1lLCBmcmllbmQgfSA9IHBheWxvYWQ7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIHVzZXIod3MpIHdhcyBpbiBhbm90aGVyIGNoYXRib3hcbiAgICAgICAgICAgIGlmICh3cy5ib3ggIT09IFwiXCIgJiYgY2hhdEJveGVzW3dzLmJveF0pe1xuICAgICAgICAgICAgICAgIGNoYXRCb3hlc1t3cy5ib3hdLmRlbGV0ZSh3cyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyB3cyDlm6DmlYXpl5zplolcbiAgICAgICAgICAgIHdzLm9uY2UoJ2Nsb3NlJywgKCkgPT4ge1xuICAgICAgICAgICAgICAgIGNoYXRCb3hlc1t3cy5ib3hdLmRlbGV0ZSh3cyk7XG4gICAgICAgICAgICB9KVxuXG4gICAgICAgICAgICAvLyBjcmVhdGUgQ2hhdHJvb20gSURcbiAgICAgICAgICAgIGxldCBjaGF0Qm94TmFtZSA9IG1ha2VOYW1lKCBuYW1lLCBmcmllbmQgKTtcbiAgICAgICAgICAgIHdzLmJveCA9IGNoYXRCb3hOYW1lO1xuXG4gICAgICAgICAgICAvLyBDcmVhdGUgVXNlcnNcbiAgICAgICAgICAgIGlmKG5hbWUgIT09IHVuZGVmaW5lZCl7XG4gICAgICAgICAgICAgICAgYXdhaXQgbWFrZVVzZXJzKG5hbWUsIGZyaWVuZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBjb25zb2xlLmxvZyh0eXBlb2YocGFydGljaXBhbnRzSUQpKTtcblxuICAgICAgICAgICAgLy8gY2hlY2sgQ2hhdFJvb20gZXhpc3RzIG9yIG5vdFxuICAgICAgICAgICAgY29uc29sZS5sb2coJ1ZhbGlkYXRpb24gb2YgY2hhdCBib3g6JywgKGF3YWl0IHZhbGlkYXRlQ2hhdEJveChjaGF0Qm94TmFtZSwgbmFtZSwgZnJpZW5kKSkpO1xuICAgICAgICAgICAgLy8gY29uc29sZS5sb2coIHZhbGlkYXRlQ2hhdEJveChjaGF0Qm94TmFtZSwgcGFydGljaXBhbnRzKSApO1xuXG4gICAgICAgICAgICAvLyB3cyBkaWN0XG4gICAgICAgICAgICAvLyDlpoLmnpzkuI3mm77mnInpgY4gY2hhdEJveE5hbWUg55qE5bCN6Kmx77yM5bCHIGNoYXRCb3hlc1tjaGF0Qm94TmFtZV0g6Kit5a6a54K6IGVtcHR5IFNldFxuICAgICAgICAgICAgaWYgKCFjaGF0Qm94ZXNbY2hhdEJveE5hbWVdKXtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIkNoYXQgQm94IOS4jeWtmOWcqO+8jOWJteW7umNoYXRSb29tXCIpXG4gICAgICAgICAgICAgICAgY2hhdEJveGVzW2NoYXRCb3hOYW1lXSA9IG5ldyBTZXQoKTsgLy8gbWFrZSBuZXcgcmVjb3JkIGZvciBjaGF0Ym94XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyDlsIcgd3MgY2xpZW50IOWKoOWFpSBjaGF0Qm94ZXNbY2hhdEJveE5hbWVdIFxuICAgICAgICAgICAgY2hhdEJveGVzW2NoYXRCb3hOYW1lXS5hZGQod3MpOyAvLyBhZGQgdGhpcyBvcGVuIGNvbm5lY3Rpb24gaW50byBjaGF0Ym94XG5cblxuICAgICAgICAgICAgc3dpdGNoICh0YXNrKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAnSW5pdCc6e1xuICAgICAgICAgICAgICAgICAgICAvLyDmiorpgJnlgIsgY2hhdGJveCDnmoQgbWVzc2FnZXMg5oqT5LiL5L6GXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGNoYXRCb3hPYmplY3QgPSBhd2FpdCBDaGF0Qm94TW9kZWwuZmluZE9uZSh7bmFtZTogY2hhdEJveE5hbWV9KTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbWVzc2FnZXMgPSBhd2FpdCBNZXNzYWdlTW9kZWwuZmluZCh7Y2hhdEJveDogY2hhdEJveE9iamVjdC5faWR9KS5wb3B1bGF0ZSgnY2hhdEJveCcpLnBvcHVsYXRlKCdzZW5kZXInKTtcbiAgICAgICAgICAgICAgICAgICAgdHJ5e1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VuZERhdGEoWydJbml0JywgbWVzc2FnZXMsIGNoYXRCb3hOYW1lXSwgd3MpO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VuZFN0YXR1cyh7ICAgIC8vIHtbJ3N0YXR1cycse3R5cGUsIG1zZ31dfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3VjY2Vzc1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1zZzogXCJTdWNjZXNzZnVsbHkgT3BlbiBvbmUgQ2hhdHJvb21cIixcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIHdzKVxuICAgICAgICAgICAgICAgICAgICB9Y2F0Y2goZSl7dGhyb3cgbmV3IEVycm9yKFwiTWVzc2FnZSBzZW5kaW5nIGlzIGZhaWxlZDogXCIgKyBlKX1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgY2FzZSAnaW5wdXQnOiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHsgYm9keSB9ID0gcGF5bG9hZFxuICAgICAgICAgICAgICAgICAgICAvLyBTYXZlIG1lc3NhZ2UgdG8gREJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY2hhdEJveE9iamVjdCA9IGF3YWl0IENoYXRCb3hNb2RlbC5maW5kT25lKHtuYW1lOiBjaGF0Qm94TmFtZX0pO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBzZW5kZXJPYmplY3QgPSBhd2FpdCBVc2VyTW9kZWwuZmluZE9uZSh7bmFtZTogbmFtZX0pO1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnSWRzOicsIGNoYXRCb3hPYmplY3QuX2lkLCBzZW5kZXJPYmplY3QuX2lkKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbWVzc2FnZSA9IGF3YWl0IG5ldyBNZXNzYWdlTW9kZWwoeyBjaGF0Qm94OiBjaGF0Qm94T2JqZWN0Ll9pZCwgc2VuZGVyOiBzZW5kZXJPYmplY3QuX2lkLCBib2R5OiBib2R5IH0pLnNhdmUoKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gY29uc3QgbWVzc2FnZSA9IGF3YWl0IG5ldyBNZXNzYWdlTW9kZWwoeyBib2R5OiBib2R5IH0pLnNhdmUoKTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIHRyeSB7IFxuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgQ2hhdEJveE1vZGVsLmZpbmRPbmVBbmRVcGRhdGUoeyBuYW1lOiBjaGF0Qm94TmFtZSB9LCB7IFwiJHB1c2hcIjogeyBcIm1lc3NhZ2VzXCI6IG1lc3NhZ2UuX2lkIH0gfSwgeyBuZXc6IHRydWUgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFJlc3BvbmQgdG8gU2VuZGVyXG4gICAgICAgICAgICAgICAgICAgICAgICAoIGF3YWl0IChhd2FpdCBtZXNzYWdlLnBvcHVsYXRlKFwiY2hhdEJveFwiKSkucG9wdWxhdGUoXCJzZW5kZXJcIikpO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2VuZERhdGEoWydiYWNrVG9TZW5kZXInLCBtZXNzYWdlLCBjaGF0Qm94TmFtZV0sIHdzKSAvLyBbJ2JhY2tUb1NlbmRlcicsIG1lc3NhZ2VdXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBzZW5kU3RhdHVzKHsgICAgLy8ge1snc3RhdHVzJyx7dHlwZSwgbXNnfV19XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAgICAgdHlwZTogXCJzdWNjZXNzXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAgICAgbXNnOiBcIlN1Y2Nlc3NmdWxseSBzZW50IG9uZSBtZXNzYWdlXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB9LCB3cylcbiAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFJlc3BvbmQgdG8gUmVjZWl2ZXJcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbmREYXRhKFsnYmFja1RvUmVjZWl2ZXInLCBtZXNzYWdlLCBjaGF0Qm94TmFtZV0sIGNoYXRCb3hlc1tjaGF0Qm94TmFtZV0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VuZFN0YXR1cyh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ3N1Y2Nlc3MnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1zZzogXCJTdWNjZXNzZnVsbHkgcmVjZWl2ZSBvbmUgbWVzc2FnZVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgfSwgY2hhdEJveGVzW2NoYXRCb3hOYW1lXSk7XG4gICAgICAgICAgICAgICAgICAgIH0gXG4gICAgICAgICAgICAgICAgICAgIGNhdGNoIChlKSB7IHRocm93IG5ldyBFcnJvcihcIk1lc3NhZ2Ugc2VuZGluZyBpcyBmYWlsZWQ6IFwiICsgZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGRlZmF1bHQ6IGJyZWFrO1xuICAgICAgICAgICAgICAgIC8vIGNhc2VzIDogLi4uXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICApXG59Il0sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQUE7QUFDQTtBQUVBO0FBQXVFO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSwrQ0FGdkU7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBSUEsSUFBTUEsUUFBUSxHQUFHLFNBQVhBLFFBQVEsQ0FBSUMsSUFBSSxFQUFFQyxLQUFLLEVBQUs7RUFFOUI7RUFDQTs7RUFFQSxJQUFJQyxNQUFNLENBQUNDLGNBQWMsQ0FBQ0YsS0FBSyxDQUFDLEtBQUtHLEdBQUcsQ0FBQ0MsU0FBUyxFQUFFO0lBQ2hEO0lBQUEsMkNBQ2lCSixLQUFLO01BQUE7SUFBQTtNQUF0QixvREFBdUI7UUFBQSxJQUFkSyxJQUFJO1FBQ1RBLElBQUksQ0FBQ0MsSUFBSSxDQUFDQyxJQUFJLENBQUNDLFNBQVMsQ0FBQ1QsSUFBSSxDQUFDLENBQUM7TUFDbkM7TUFDQTtJQUFBO01BQUE7SUFBQTtNQUFBO0lBQUE7RUFDSixDQUFDLE1BQ0c7SUFDQUMsS0FBSyxDQUFDTSxJQUFJLENBQUNDLElBQUksQ0FBQ0MsU0FBUyxDQUFDVCxJQUFJLENBQUMsQ0FBQztJQUNoQztFQUVKOztFQUVBVSxPQUFPLENBQUNDLEdBQUcsQ0FBQyxvQkFBb0IsQ0FBQztBQUNyQyxD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","map":{"version":3,"names":["sendData","data","wsSet","Object","getPrototypeOf","Set","prototype","item","send","JSON","stringify","console","log","sendStatus","payload","ws","makeName","name","friend","sort","join","validateChatBox","chatRoomName","ChatBoxModel","findOne","box","UserModel","myId","friendId","users","_id","save","updateOne","chatBoxes","populate","path","makeUsers","myName","user1","user2","onMessage","wss","byteString","parse","task","once","chatBoxName","undefined","add","chatBoxObject","MessageModel","find","chatBox","messages","type","msg","Error","body","senderObject","sender","message","findOneAndUpdate"],"sourceRoot":"/Users/edlin/Desktop/wp1111/hw7/backend/src/","sources":["wsConnect.js"],"sourcesContent":["import mongoose from \"mongoose\";\nimport WebSocket from 'ws';\n\nimport {UserModel, MessageModel, ChatBoxModel} from \"./models/chatbox\";\n\nconst sendData = (data, wsSet) => {\n\n    // console.log('type of wsSet:', typeof(wsSet));\n    // console.log('wsSet:', wsSet);\n\n    if( Object.getPrototypeOf(wsSet) === Set.prototype ){\n        //對 set 中的每個 ws 進行迭代\n        for (let item of wsSet){\n            item.send(JSON.stringify(data)); \n        }\n        // console.log('case 1');\n    }\n    else{\n        wsSet.send(JSON.stringify(data)); \n        // console.log('case 2');\n\n    }\n\n    console.log('Data send success.')\n}\nconst sendStatus = (payload, ws) => {\n    sendData([\"status\", payload], ws); \n}\n\n// Create Chatroom ID\nconst makeName = (name, friend) => {\n    return [name, friend].sort().join('_');\n}\n\n// Check ChatRoom exists or not\nconst validateChatBox = async (chatRoomName, name, friend) => {\n    let box = await ChatBoxModel.findOne({ name: chatRoomName });\n    console.log(\"box:\", box);\n    console.log(\"chatBoxName:\", chatRoomName);\n\n    const myId = await UserModel.findOne({name: name});\n    const friendId = await UserModel.findOne({name: friend});\n    // if not exist -> create a chatbox model.\n    if (!box)\n        // 要先有users ObjectId.\n        console.log('ChatBoxModel不存在 -> 建立ChatBoxModel');\n        box = await new ChatBoxModel({ name: chatRoomName, users: [myId._id, friendId._id] }).save();\n        await myId.updateOne({\"$push\": {chatBoxes: box._id}});\n        await friendId.updateOne({\"$push\": {chatBoxes: box._id}});\n\n    return box.populate([\"users\", {path: 'messages', populate: 'sender' }]);\n    // return [{user, sender}];\n}\n\n// Create Users\nconst makeUsers = async (myName, friend) => {\n    console.log('User names', myName, friend);\n    let user1 = await UserModel.findOne({name: myName})\n    let user2 = await UserModel.findOne({name: friend})\n\n    if(!user1){\n        user1 = await new UserModel({name: myName}).save()\n    }\n    \n    if(!user2){\n        user2 = await new UserModel({name: friend}).save()\n    }\n    console.log(\"Users_id \",[user1._id, user2._id])\n}\n\n\n// 建立一個 dictionary of { chatBoxName, Set<ws> }, -> key: value -> \"chatBoxName\": set(ws...)\n// 可以從 chatbox name 找到當前有哪些 websockets / ChatRooms \n// 有這個名字的 chatbox 且為 active\nconst chatBoxes = {};\n\nexport default {\n    // 解析client傳來的資料\n    onMessage: (wss, ws) => (\n        async (byteString) => {\n            const { data } = byteString\n            const [ task, payload ] = JSON.parse(data)\n            const { name, friend } = payload;\n            \n            // user(ws) was in another chatbox\n            if (ws.box !== \"\" && chatBoxes[ws.box]){\n                chatBoxes[ws.box].delete(ws);\n            }\n            // ws 因故關閉\n            ws.once('close', () => {\n                chatBoxes[ws.box].delete(ws);\n            })\n\n            // create Chatroom ID\n            let chatBoxName = makeName( name, friend );\n            ws.box = chatBoxName;\n\n            // Create Users\n            if(name !== undefined){\n                await makeUsers(name, friend);\n            }\n            // console.log(typeof(participantsID));\n\n            // check ChatRoom exists or not\n            console.log('Validation of chat box:', (await validateChatBox(chatBoxName, name, friend)));\n            // console.log( validateChatBox(chatBoxName, participants) );\n\n            // ws dict\n            // 如果不曾有過 chatBoxName 的對話，將 chatBoxes[chatBoxName] 設定為 empty Set\n            if (!chatBoxes[chatBoxName]){\n                console.log(\"Chat Box 不存在，創建chatRoom\")\n                chatBoxes[chatBoxName] = new Set(); // make new record for chatbox\n            }\n            // 將 ws client 加入 chatBoxes[chatBoxName] \n            chatBoxes[chatBoxName].add(ws); // add this open connection into chatbox\n\n\n            switch (task) {\n                case 'Init':{\n                    // 把這個 chatbox 的 messages 抓下來\n                    const chatBoxObject = await ChatBoxModel.findOne({name: chatBoxName});\n                    const messages = await MessageModel.find({chatBox: chatBoxObject._id}).populate('chatBox').populate('sender');\n                    try{\n                        sendData(['Init', messages, chatBoxName], ws);\n                        sendStatus({    // {['status',{type, msg}]}\n                            type: \"success\",\n                            msg: \"Successfully Open one Chatroom\",\n                        }, ws)\n                    }catch(e){throw new Error(\"Message sending is failed: \" + e)}\n                    break;\n                }\n\n                case 'input': {\n                    const { body } = payload\n                    // Save message to DB\n                    const chatBoxObject = await ChatBoxModel.findOne({name: chatBoxName});\n                    const senderObject = await UserModel.findOne({name: name});\n                    console.log('Ids:', chatBoxObject._id, senderObject._id);\n                    const message = await new MessageModel({ chatBox: chatBoxObject._id, sender: senderObject._id, body: body }).save();\n                    // const message = await new MessageModel({ body: body }).save();\n                    \n                    try { \n                        await ChatBoxModel.findOneAndUpdate({ name: chatBoxName }, { \"$push\": { \"messages\": message._id } }, { new: true });\n                        \n                        // Respond to Sender\n                        ( await (await message.populate(\"chatBox\")).populate(\"sender\"));\n                        // sendData(['backToSender', message, chatBoxName], ws) // ['backToSender', message]\n                        // sendStatus({    // {['status',{type, msg}]}\n                        //     type: \"success\",\n                        //     msg: \"Successfully sent one message\",\n                        // }, ws)\n    \n                        // Respond to Receiver\n                        sendData(['backToReceiver', message, chatBoxName], chatBoxes[chatBoxName]);\n                        sendStatus({\n                            type: 'success',\n                            msg: \"Successfully receive one message\",\n                        }, chatBoxes[chatBoxName]);\n                    } \n                    catch (e) { throw new Error(\"Message sending is failed: \" + e);\n                    }\n                    break;\n                }\n                default: break;\n                // cases : ...\n            }\n        }\n    )\n}"],"mappings":";;;;;;;AAAA;AACA;AAEA;AAAuE;AAAA;AAAA;AAAA;AAAA;AAAA,+CAFvE;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA,IAAMA,QAAQ,GAAG,SAAXA,QAAQ,CAAIC,IAAI,EAAEC,KAAK,EAAK;EAE9B;EACA;;EAEA,IAAIC,MAAM,CAACC,cAAc,CAACF,KAAK,CAAC,KAAKG,GAAG,CAACC,SAAS,EAAE;IAChD;IAAA,2CACiBJ,KAAK;MAAA;IAAA;MAAtB,oDAAuB;QAAA,IAAdK,IAAI;QACTA,IAAI,CAACC,IAAI,CAACC,IAAI,CAACC,SAAS,CAACT,IAAI,CAAC,CAAC;MACnC;MACA;IAAA;MAAA;IAAA;MAAA;IAAA;EACJ,CAAC,MACG;IACAC,KAAK,CAACM,IAAI,CAACC,IAAI,CAACC,SAAS,CAACT,IAAI,CAAC,CAAC;IAChC;EAEJ;;EAEAU,OAAO,CAACC,GAAG,CAAC,oBAAoB,CAAC;AACrC,CAAC;AACD,IAAMC,UAAU,GAAG,SAAbA,UAAU,CAAIC,OAAO,EAAEC,EAAE,EAAK;EAChCf,QAAQ,CAAC,CAAC,QAAQ,EAAEc,OAAO,CAAC,EAAEC,EAAE,CAAC;AACrC,CAAC;;AAED;AACA,IAAMC,QAAQ,GAAG,SAAXA,QAAQ,CAAIC,IAAI,EAAEC,MAAM,EAAK;EAC/B,OAAO,CAACD,IAAI,EAAEC,MAAM,CAAC,CAACC,IAAI,EAAE,CAACC,IAAI,CAAC,GAAG,CAAC;AAC1C,CAAC;;AAED;AACA,IAAMC,eAAe;EAAA,sEAAG,iBAAOC,YAAY,EAAEL,IAAI,EAAEC,MAAM;IAAA;IAAA;MAAA;QAAA;UAAA;YAAA;YAAA,OACrCK,qBAAY,CAACC,OAAO,CAAC;cAAEP,IAAI,EAAEK;YAAa,CAAC,CAAC;UAAA;YAAxDG,GAAG;YACPd,OAAO,CAACC,GAAG,CAAC,MAAM,EAAEa,GAAG,CAAC;YACxBd,OAAO,CAACC,GAAG,CAAC,cAAc,EAAEU,YAAY,CAAC;YAAC;YAAA,OAEvBI,kBAAS,CAACF,OAAO,CAAC;cAACP,IAAI,EAAEA;YAAI,CAAC,CAAC;UAAA;YAA5CU,IAAI;YAAA;YAAA,OACaD,kBAAS,CAACF,OAAO,CAAC;cAACP,IAAI,EAAEC;YAAM,CAAC,CAAC;UAAA;YAAlDU,QAAQ;YACd;YACA,IAAI,CAACH,GAAG;cACJ;cACAd,OAAO,CAACC,GAAG,CAAC,mCAAmC,CAAC;YAAC;YAAA,OACrC,IAAIW,qBAAY,CAAC;cAAEN,IAAI,EAAEK,YAAY;cAAEO,KAAK,EAAE,CAACF,IAAI,CAACG,GAAG,EAAEF,QAAQ,CAACE,GAAG;YAAE,CAAC,CAAC,CAACC,IAAI,EAAE;UAAA;YAA5FN,GAAG;YAAA;YAAA,OACGE,IAAI,CAACK,SAAS,CAAC;cAAC,OAAO,EAAE;gBAACC,SAAS,EAAER,GAAG,CAACK;cAAG;YAAC,CAAC,CAAC;UAAA;YAAA;YAAA,OAC/CF,QAAQ,CAACI,SAAS,CAAC;cAAC,OAAO,EAAE;gBAACC,SAAS,EAAER,GAAG,CAACK;cAAG;YAAC,CAAC,CAAC;UAAA;YAAA,iCAEtDL,GAAG,CAACS,QAAQ,CAAC,CAAC,OAAO,EAAE;cAACC,IAAI,EAAE,UAAU;cAAED,QAAQ,EAAE;YAAS,CAAC,CAAC,CAAC;UAAA;UAAA;YAAA;QAAA;MAAA;IAAA;EAAA,CAE1E;EAAA,gBAjBKb,eAAe;IAAA;EAAA;AAAA,GAiBpB;;AAED;AACA,IAAMe,SAAS;EAAA,uEAAG,kBAAOC,MAAM,EAAEnB,MAAM;IAAA;IAAA;MAAA;QAAA;UAAA;YACnCP,OAAO,CAACC,GAAG,CAAC,YAAY,EAAEyB,MAAM,EAAEnB,MAAM,CAAC;YAAC;YAAA,OACxBQ,kBAAS,CAACF,OAAO,CAAC;cAACP,IAAI,EAAEoB;YAAM,CAAC,CAAC;UAAA;YAA/CC,KAAK;YAAA;YAAA,OACSZ,kBAAS,CAACF,OAAO,CAAC;cAACP,IAAI,EAAEC;YAAM,CAAC,CAAC;UAAA;YAA/CqB,KAAK;YAAA,IAELD,KAAK;cAAA;cAAA;YAAA;YAAA;YAAA,OACS,IAAIZ,kBAAS,CAAC;cAACT,IAAI,EAAEoB;YAAM,CAAC,CAAC,CAACN,IAAI,EAAE;UAAA;YAAlDO,KAAK;UAAA;YAAA,IAGLC,KAAK;cAAA;cAAA;YAAA;YAAA;YAAA,OACS,IAAIb,kBAAS,CAAC;cAACT,IAAI,EAAEC;YAAM,CAAC,CAAC,CAACa,IAAI,EAAE;UAAA;YAAlDQ,KAAK;UAAA;YAET5B,OAAO,CAACC,GAAG,CAAC,WAAW,EAAC,CAAC0B,KAAK,CAACR,GAAG,EAAES,KAAK,CAACT,GAAG,CAAC,CAAC;UAAA;UAAA;YAAA;QAAA;MAAA;IAAA;EAAA,CAClD;EAAA,gBAbKM,SAAS;IAAA;EAAA;AAAA,GAad;;AAGD;AACA;AACA;AACA,IAAMH,SAAS,GAAG,CAAC,CAAC;AAAC,eAEN;EACX;EACAO,SAAS,EAAE,mBAACC,GAAG,EAAE1B,EAAE;IAAA;MAAA,uEACf,kBAAO2B,UAAU;QAAA;QAAA;UAAA;YAAA;cAAA;gBACLzC,IAAI,GAAKyC,UAAU,CAAnBzC,IAAI;gBAAA,cACcQ,IAAI,CAACkC,KAAK,CAAC1C,IAAI,CAAC,iDAAlC2C,IAAI,oBAAE9B,OAAO;gBACbG,IAAI,GAAaH,OAAO,CAAxBG,IAAI,EAAEC,MAAM,GAAKJ,OAAO,CAAlBI,MAAM,EAEpB;gBACA,IAAIH,EAAE,CAACU,GAAG,KAAK,EAAE,IAAIQ,SAAS,CAAClB,EAAE,CAACU,GAAG,CAAC,EAAC;kBACnCQ,SAAS,CAAClB,EAAE,CAACU,GAAG,CAAC,UAAO,CAACV,EAAE,CAAC;gBAChC;gBACA;gBACAA,EAAE,CAAC8B,IAAI,CAAC,OAAO,EAAE,YAAM;kBACnBZ,SAAS,CAAClB,EAAE,CAACU,GAAG,CAAC,UAAO,CAACV,EAAE,CAAC;gBAChC,CAAC,CAAC;;gBAEF;gBACI+B,WAAW,GAAG9B,QAAQ,CAAEC,IAAI,EAAEC,MAAM,CAAE;gBAC1CH,EAAE,CAACU,GAAG,GAAGqB,WAAW;;gBAEpB;gBAAA,MACG7B,IAAI,KAAK8B,SAAS;kBAAA;kBAAA;gBAAA;gBAAA;gBAAA,OACXX,SAAS,CAACnB,IAAI,EAAEC,MAAM,CAAC;cAAA;gBAAA,eAKjCP,OAAO;gBAAA;gBAAA,OAAuCU,eAAe,CAACyB,WAAW,EAAE7B,IAAI,EAAEC,MAAM,CAAC;cAAA;gBAAA;gBAAA,aAAhFN,GAAG,oBAAC,yBAAyB;gBACrC;;gBAEA;gBACA;gBACA,IAAI,CAACqB,SAAS,CAACa,WAAW,CAAC,EAAC;kBACxBnC,OAAO,CAACC,GAAG,CAAC,yBAAyB,CAAC;kBACtCqB,SAAS,CAACa,WAAW,CAAC,GAAG,IAAIzC,GAAG,EAAE,CAAC,CAAC;gBACxC;gBACA;gBACA4B,SAAS,CAACa,WAAW,CAAC,CAACE,GAAG,CAACjC,EAAE,CAAC,CAAC,CAAC;gBAAA,eAGxB6B,IAAI;gBAAA,kCACH,MAAM,yBAcN,OAAO;gBAAA;cAAA;gBAAA;gBAAA,OAZoBrB,qBAAY,CAACC,OAAO,CAAC;kBAACP,IAAI,EAAE6B;gBAAW,CAAC,CAAC;cAAA;gBAA/DG,aAAa;gBAAA;gBAAA,OACIC,qBAAY,CAACC,IAAI,CAAC;kBAACC,OAAO,EAAEH,aAAa,CAACnB;gBAAG,CAAC,CAAC,CAACI,QAAQ,CAAC,SAAS,CAAC,CAACA,QAAQ,CAAC,QAAQ,CAAC;cAAA;gBAAvGmB,QAAQ;gBAAA;gBAEVrD,QAAQ,CAAC,CAAC,MAAM,EAAEqD,QAAQ,EAAEP,WAAW,CAAC,EAAE/B,EAAE,CAAC;gBAC7CF,UAAU,CAAC;kBAAK;kBACZyC,IAAI,EAAE,SAAS;kBACfC,GAAG,EAAE;gBACT,CAAC,EAAExC,EAAE,CAAC;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAAA,MACM,IAAIyC,KAAK,CAAC,6BAA6B,eAAI,CAAC;cAAA;gBAAA;cAAA;gBAKpDC,IAAI,GAAK3C,OAAO,CAAhB2C,IAAI,EACZ;gBAAA;gBAAA,OAC4BlC,qBAAY,CAACC,OAAO,CAAC;kBAACP,IAAI,EAAE6B;gBAAW,CAAC,CAAC;cAAA;gBAA/DG,cAAa;gBAAA;gBAAA,OACQvB,kBAAS,CAACF,OAAO,CAAC;kBAACP,IAAI,EAAEA;gBAAI,CAAC,CAAC;cAAA;gBAApDyC,YAAY;gBAClB/C,OAAO,CAACC,GAAG,CAAC,MAAM,EAAEqC,cAAa,CAACnB,GAAG,EAAE4B,YAAY,CAAC5B,GAAG,CAAC;gBAAC;gBAAA,OACnC,IAAIoB,qBAAY,CAAC;kBAAEE,OAAO,EAAEH,cAAa,CAACnB,GAAG;kBAAE6B,MAAM,EAAED,YAAY,CAAC5B,GAAG;kBAAE2B,IAAI,EAAEA;gBAAK,CAAC,CAAC,CAAC1B,IAAI,EAAE;cAAA;gBAA7G6B,OAAO;gBAAA;gBAAA;gBAAA,OAIHrC,qBAAY,CAACsC,gBAAgB,CAAC;kBAAE5C,IAAI,EAAE6B;gBAAY,CAAC,EAAE;kBAAE,OAAO,EAAE;oBAAE,UAAU,EAAEc,OAAO,CAAC9B;kBAAI;gBAAE,CAAC,EAAE;kBAAE,OAAK;gBAAK,CAAC,CAAC;cAAA;gBAAA;gBAAA,OAGpG8B,OAAO,CAAC1B,QAAQ,CAAC,SAAS,CAAC;cAAA;gBAAA;gBAAA,sBAAEA,QAAQ,CAAC,QAAQ;cAAA;gBAC7D;gBACA;gBACA;gBACA;gBACA;;gBAEA;gBACAlC,QAAQ,CAAC,CAAC,gBAAgB,EAAE4D,OAAO,EAAEd,WAAW,CAAC,EAAEb,SAAS,CAACa,WAAW,CAAC,CAAC;gBAC1EjC,UAAU,CAAC;kBACPyC,IAAI,EAAE,SAAS;kBACfC,GAAG,EAAE;gBACT,CAAC,EAAEtB,SAAS,CAACa,WAAW,CAAC,CAAC;gBAAC;gBAAA;cAAA;gBAAA;gBAAA;gBAAA,MAEb,IAAIU,KAAK,CAAC,6BAA6B,eAAI,CAAC;cAAA;gBAAA;cAAA;gBAAA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA,CAOzE;MAAA;QAAA;MAAA;IAAA;EAAA;AAET,CAAC;AAAA"}},"mtime":1669360834054},"{\"assumptions\":{},\"sourceRoot\":\"/Users/edlin/Desktop/wp1111/hw7/backend/src/models/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/edlin/Desktop/wp1111/hw7/backend\",\"filename\":\"/Users/edlin/Desktop/wp1111/hw7/backend/src/models/chatbox.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/edlin/Desktop/wp1111/hw7/backend\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"proposal-class-static-block\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ClassBody\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-private-property-in-object\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"BinaryExpression\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"proposal-class-properties\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"proposal-private-methods\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"proposal-numeric-separator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"NumericLiteral\":{\"enter\":[null]},\"BigIntLiteral\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-logical-assignment-operators\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"AssignmentExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":true,\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-json-strings\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"DirectiveLiteral\":{\"enter\":[null]},\"StringLiteral\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-optional-catch-binding\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"CatchClause\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-parameters\",\"visitor\":{\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-async-generator-functions\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-object-rest-spread\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"VariableDeclarator\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dotall-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-unicode-property-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-named-capturing-groups-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-async-to-generator\",\"visitor\":{\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-exponentiation-operator\",\"visitor\":{\"AssignmentExpression\":{\"enter\":[null]},\"BinaryExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-template-literals\",\"visitor\":{\"TaggedTemplateExpression\":{\"enter\":[null]},\"TemplateLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-literals\",\"visitor\":{\"NumericLiteral\":{\"enter\":[null]},\"StringLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-function-name\",\"visitor\":{\"FunctionExpression\":{\"exit\":[null]},\"ObjectProperty\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-arrow-functions\",\"visitor\":{\"ArrowFunctionExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-block-scoped-functions\",\"visitor\":{\"BlockStatement\":{\"enter\":[null]},\"SwitchCase\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-classes\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]},\"ClassExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-object-super\",\"visitor\":{\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-shorthand-properties\",\"visitor\":{\"ObjectMethod\":{\"enter\":[null]},\"ObjectProperty\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-duplicate-keys\",\"visitor\":{\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-computed-properties\",\"visitor\":{\"ObjectExpression\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-for-of\",\"visitor\":{\"ForOfStatement\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-sticky-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-unicode-escapes\",\"visitor\":{\"Identifier\":{\"enter\":[null]},\"TemplateElement\":{\"enter\":[null]},\"_exploded\":true,\"StringLiteral\":{\"enter\":[null]},\"DirectiveLiteral\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-unicode-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-spread\",\"visitor\":{\"ArrayExpression\":{\"enter\":[null]},\"CallExpression\":{\"enter\":[null]},\"NewExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-destructuring\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"VariableDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-block-scoping\",\"visitor\":{\"VariableDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"_exploded\":true,\"BlockStatement\":{\"enter\":[null]},\"SwitchStatement\":{\"enter\":[null]},\"Program\":{\"enter\":[null]},\"_verified\":true,\"DoWhileStatement\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForStatement\":{\"enter\":[null]},\"WhileStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-typeof-symbol\",\"visitor\":{\"UnaryExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"BlockStatement\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"DoWhileStatement\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForStatement\":{\"enter\":[null]},\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"Program\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"SwitchStatement\":{\"enter\":[null]},\"WhileStatement\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"StaticBlock\":{\"enter\":[null]},\"TSModuleBlock\":{\"enter\":[null]},\"AssignmentPattern\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectPattern\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-new-target\",\"visitor\":{\"MetaProperty\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-regenerator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ObjectMethod\":{\"enter\":[null],\"exit\":[null]},\"ClassMethod\":{\"enter\":[null],\"exit\":[null]},\"ClassPrivateMethod\":{\"enter\":[null],\"exit\":[null]},\"FunctionDeclaration\":{\"exit\":[null]},\"FunctionExpression\":{\"exit\":[null]},\"ArrowFunctionExpression\":{\"exit\":[null]},\"MemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-member-expression-literals\",\"visitor\":{\"MemberExpression\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-property-literals\",\"visitor\":{\"ObjectProperty\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-reserved-words\",\"visitor\":{\"_exploded\":true,\"_verified\":true,\"Identifier\":{\"enter\":[null,null]},\"JSXIdentifier\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.20.2:development":{"value":{"code":"\"use strict\";\n\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, _typeof(obj); }\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.UserModel = exports.MessageModel = exports.ChatBoxModel = void 0;\nvar _mongoose = _interopRequireWildcard(require(\"mongoose\"));\nfunction _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== \"function\") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }\nfunction _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || _typeof(obj) !== \"object\" && typeof obj !== \"function\") { return { \"default\": obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj[\"default\"] = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\n/******* User Schema *******/\nvar UserSchema = new _mongoose.Schema({\n  name: {\n    type: String,\n    required: [true, 'Name field is required.']\n  },\n  chatBoxes: [{\n    type: _mongoose[\"default\"].Types.ObjectId,\n    ref: \"ChatBox\"\n  }]\n});\nvar UserModel = _mongoose[\"default\"].model('User', UserSchema);\n\n/******* Message Schema *******/\nexports.UserModel = UserModel;\nvar MessageSchema = new _mongoose.Schema({\n  chatBox: {\n    type: _mongoose[\"default\"].Types.ObjectId,\n    ref: \"ChatBox\"\n  },\n  sender: {\n    type: _mongoose[\"default\"].Types.ObjectId,\n    ref: \"User\"\n  },\n  body: {\n    type: String,\n    required: [true, \"Body field is required.\"]\n  }\n});\nvar MessageModel = _mongoose[\"default\"].model('Message', MessageSchema);\n\n/******* ChatBox Schema *******/\nexports.MessageModel = MessageModel;\nvar ChatBoxSchema = new _mongoose.Schema({\n  name: {\n    type: String,\n    required: [true, 'Name field is required.']\n  },\n  users: [{\n    type: _mongoose[\"default\"].Types.ObjectId,\n    ref: 'User'\n  }],\n  messages: [{\n    type: _mongoose[\"default\"].Types.ObjectId,\n    ref: 'Message'\n  }]\n});\nvar ChatBoxModel = _mongoose[\"default\"].model('ChatBox', ChatBoxSchema);\n\n// 輸出多個就使用 export {...}\nexports.ChatBoxModel = ChatBoxModel;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJVc2VyU2NoZW1hIiwiU2NoZW1hIiwibmFtZSIsInR5cGUiLCJTdHJpbmciLCJyZXF1aXJlZCIsImNoYXRCb3hlcyIsIm1vbmdvb3NlIiwiVHlwZXMiLCJPYmplY3RJZCIsInJlZiIsIlVzZXJNb2RlbCIsIm1vZGVsIiwiTWVzc2FnZVNjaGVtYSIsImNoYXRCb3giLCJzZW5kZXIiLCJib2R5IiwiTWVzc2FnZU1vZGVsIiwiQ2hhdEJveFNjaGVtYSIsInVzZXJzIiwibWVzc2FnZXMiLCJDaGF0Qm94TW9kZWwiXSwic291cmNlUm9vdCI6Ii9Vc2Vycy9lZGxpbi9EZXNrdG9wL3dwMTExMS9odzcvYmFja2VuZC9zcmMvbW9kZWxzLyIsInNvdXJjZXMiOlsiY2hhdGJveC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgbW9uZ29vc2UsIHsgU2NoZW1hIH0gZnJvbSBcIm1vbmdvb3NlXCI7XG5cbi8qKioqKioqIFVzZXIgU2NoZW1hICoqKioqKiovXG5jb25zdCBVc2VyU2NoZW1hID0gbmV3IFNjaGVtYSh7XG4gICAgbmFtZToge1xuICAgICAgICB0eXBlOiBTdHJpbmcsIFxuICAgICAgICByZXF1aXJlZDogW3RydWUsICdOYW1lIGZpZWxkIGlzIHJlcXVpcmVkLiddLFxuICAgIH0sXG4gICAgY2hhdEJveGVzOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIHR5cGU6IG1vbmdvb3NlLlR5cGVzLk9iamVjdElkLFxuICAgICAgICAgICAgcmVmOiBcIkNoYXRCb3hcIixcbiAgICAgICAgfVxuICAgIF1cbn0pO1xuXG5jb25zdCBVc2VyTW9kZWwgPSBtb25nb29zZS5tb2RlbCgnVXNlcicsIFVzZXJTY2hlbWEpO1xuXG4vKioqKioqKiBNZXNzYWdlIFNjaGVtYSAqKioqKioqL1xuY29uc3QgTWVzc2FnZVNjaGVtYSA9IG5ldyBTY2hlbWEoe1xuICAgIGNoYXRCb3g6IHtcbiAgICAgICAgdHlwZTogbW9uZ29vc2UuVHlwZXMuT2JqZWN0SWQsXG4gICAgICAgIHJlZjogXCJDaGF0Qm94XCIsXG4gICAgfSxcbiAgICBzZW5kZXI6IHtcbiAgICAgICAgdHlwZTogbW9uZ29vc2UuVHlwZXMuT2JqZWN0SWQsXG4gICAgICAgIHJlZjogXCJVc2VyXCIsXG4gICAgfSxcbiAgICBib2R5OiB7XG4gICAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgICAgcmVxdWlyZWQ6IFt0cnVlLCBcIkJvZHkgZmllbGQgaXMgcmVxdWlyZWQuXCJdLFxuICAgIH1cbn0pXG5cbmNvbnN0IE1lc3NhZ2VNb2RlbCA9IG1vbmdvb3NlLm1vZGVsKCdNZXNzYWdlJywgTWVzc2FnZVNjaGVtYSk7XG5cbi8qKioqKioqIENoYXRCb3ggU2NoZW1hICoqKioqKiovXG5jb25zdCBDaGF0Qm94U2NoZW1hID0gbmV3IFNjaGVtYSh7XG4gICAgbmFtZToge1xuICAgICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICAgIHJlcXVpcmVkOiBbdHJ1ZSwgJ05hbWUgZmllbGQgaXMgcmVxdWlyZWQuJ10sXG4gICAgfSxcbiAgICB1c2VyczogW1xuICAgICAgICB7IFxuICAgICAgICAgICAgdHlwZTogbW9uZ29vc2UuVHlwZXMuT2JqZWN0SWQsIFxuICAgICAgICAgICAgcmVmOiAnVXNlcicgXG4gICAgICAgIH1cbiAgICBdLFxuICAgIG1lc3NhZ2VzOiBbXG4gICAgICAgIHtcbiAgICAgICAgICAgIHR5cGU6IG1vbmdvb3NlLlR5cGVzLk9iamVjdElkLCBcbiAgICAgICAgICAgIHJlZjogJ01lc3NhZ2UnIFxuICAgICAgICB9XG4gICAgXSxcbn0pXG5cbmNvbnN0IENoYXRCb3hNb2RlbCA9IG1vbmdvb3NlLm1vZGVsKCdDaGF0Qm94JywgQ2hhdEJveFNjaGVtYSk7XG5cbmV4cG9ydCB7VXNlck1vZGVsLCBNZXNzYWdlTW9kZWwsIENoYXRCb3hNb2RlbH07IC8vIOi8uOWHuuWkmuWAi+WwseS9v+eUqCBleHBvcnQgey4uLn1cblxuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQUE7QUFBNEM7QUFBQTtBQUU1QztBQUNBLElBQU1BLFVBQVUsR0FBRyxJQUFJQyxnQkFBTSxDQUFDO0VBQzFCQyxJQUFJLEVBQUU7SUFDRkMsSUFBSSxFQUFFQyxNQUFNO0lBQ1pDLFFBQVEsRUFBRSxDQUFDLElBQUksRUFBRSx5QkFBeUI7RUFDOUMsQ0FBQztFQUNEQyxTQUFTLEVBQUUsQ0FDUDtJQUNJSCxJQUFJLEVBQUVJLG9CQUFRLENBQUNDLEtBQUssQ0FBQ0MsUUFBUTtJQUM3QkMsR0FBRyxFQUFFO0VBQ1QsQ0FBQztBQUVULENBQUMsQ0FBQztBQUVGLElBQU1DLFNBQVMsR0FBR0osb0JBQVEsQ0FBQ0ssS0FBSyxDQUFDLE1BQU0sRUFBRVosVUFBVSxDQUFDOztBQUVwRDtBQUFBO0FBQ0EsSUFBTWEsYUFBYSxHQUFHLElBQUlaLGdCQUFNLENBQUM7RUFDN0JhLE9BQU8sRUFBRTtJQUNMWCxJQUFJLEVBQUVJLG9CQUFRLENBQUNDLEtBQUssQ0FBQ0MsUUFBUTtJQUM3QkMsR0FBRyxFQUFFO0VBQ1QsQ0FBQztFQUNESyxNQUFNLEVBQUU7SUFDSlosSUFBSSxFQUFFSSxvQkFBUSxDQUFDQyxLQUFLLENBQUNDLFFBQVE7SUFDN0JDLEdBQUcsRUFBRTtFQUNULENBQUM7RUFDRE0sSUFBSSxFQUFFO0lBQ0ZiLElBQUksRUFBRUMsTUFBTTtJQUNaQyxRQUFRLEVBQUUsQ0FBQyxJQUFJLEVBQUUseUJBQXlCO0VBQzlDO0FBQ0osQ0FBQyxDQUFDO0FBRUYsSUFBTVksWUFBWSxHQUFHVixvQkFBUSxDQUFDSyxLQUFLLENBQUMsU0FBUyxFQUFFQyxhQUFhLENBQUM7O0FBRTdEO0FBQUE7QUFDQSxJQUFNSyxhQUFhLEdBQUcsSUFBSWpCLGdCQUFNLENBQUM7RUFDN0JDLElBQUksRUFBRTtJQUNGQyxJQUFJLEVBQUVDLE1BQU07SUFDWkMsUUFBUSxFQUFFLENBQUMsSUFBSSxFQUFFLHlCQUF5QjtFQUM5QyxDQUFDO0VBQ0RjLEtBQUssRUFBRSxDQUNIO0lBQ0loQixJQUFJLEVBQUVJLG9CQUFRLENBQUNDLEtBQUssQ0FBQ0MsUUFBUTtJQUM3QkMsR0FBRyxFQUFFO0VBQ1QsQ0FBQyxDQUNKO0VBQ0RVLFFBQVEsRUFBRSxDQUNOO0lBQ0lqQixJQUFJLEVBQUVJLG9CQUFRLENBQUNDLEtBQUssQ0FBQ0MsUUFBUTtJQUM3QkMsR0FBRyxFQUFFO0VBQ1QsQ0FBQztBQUVULENBQUMsQ0FBQztBQUVGLElBQU1XLFlBQVksR0FBR2Qsb0JBQVEsQ0FBQ0ssS0FBSyxDQUFDLFNBQVMsRUFBRU0sYUFBYSxDQUFDOztBQUViO0FBQUEifQ==","map":{"version":3,"names":["UserSchema","Schema","name","type","String","required","chatBoxes","mongoose","Types","ObjectId","ref","UserModel","model","MessageSchema","chatBox","sender","body","MessageModel","ChatBoxSchema","users","messages","ChatBoxModel"],"sourceRoot":"/Users/edlin/Desktop/wp1111/hw7/backend/src/models/","sources":["chatbox.js"],"sourcesContent":["import mongoose, { Schema } from \"mongoose\";\n\n/******* User Schema *******/\nconst UserSchema = new Schema({\n    name: {\n        type: String, \n        required: [true, 'Name field is required.'],\n    },\n    chatBoxes: [\n        {\n            type: mongoose.Types.ObjectId,\n            ref: \"ChatBox\",\n        }\n    ]\n});\n\nconst UserModel = mongoose.model('User', UserSchema);\n\n/******* Message Schema *******/\nconst MessageSchema = new Schema({\n    chatBox: {\n        type: mongoose.Types.ObjectId,\n        ref: \"ChatBox\",\n    },\n    sender: {\n        type: mongoose.Types.ObjectId,\n        ref: \"User\",\n    },\n    body: {\n        type: String,\n        required: [true, \"Body field is required.\"],\n    }\n})\n\nconst MessageModel = mongoose.model('Message', MessageSchema);\n\n/******* ChatBox Schema *******/\nconst ChatBoxSchema = new Schema({\n    name: {\n        type: String,\n        required: [true, 'Name field is required.'],\n    },\n    users: [\n        { \n            type: mongoose.Types.ObjectId, \n            ref: 'User' \n        }\n    ],\n    messages: [\n        {\n            type: mongoose.Types.ObjectId, \n            ref: 'Message' \n        }\n    ],\n})\n\nconst ChatBoxModel = mongoose.model('ChatBox', ChatBoxSchema);\n\nexport {UserModel, MessageModel, ChatBoxModel}; // 輸出多個就使用 export {...}\n\n"],"mappings":";;;;;;;AAAA;AAA4C;AAAA;AAE5C;AACA,IAAMA,UAAU,GAAG,IAAIC,gBAAM,CAAC;EAC1BC,IAAI,EAAE;IACFC,IAAI,EAAEC,MAAM;IACZC,QAAQ,EAAE,CAAC,IAAI,EAAE,yBAAyB;EAC9C,CAAC;EACDC,SAAS,EAAE,CACP;IACIH,IAAI,EAAEI,oBAAQ,CAACC,KAAK,CAACC,QAAQ;IAC7BC,GAAG,EAAE;EACT,CAAC;AAET,CAAC,CAAC;AAEF,IAAMC,SAAS,GAAGJ,oBAAQ,CAACK,KAAK,CAAC,MAAM,EAAEZ,UAAU,CAAC;;AAEpD;AAAA;AACA,IAAMa,aAAa,GAAG,IAAIZ,gBAAM,CAAC;EAC7Ba,OAAO,EAAE;IACLX,IAAI,EAAEI,oBAAQ,CAACC,KAAK,CAACC,QAAQ;IAC7BC,GAAG,EAAE;EACT,CAAC;EACDK,MAAM,EAAE;IACJZ,IAAI,EAAEI,oBAAQ,CAACC,KAAK,CAACC,QAAQ;IAC7BC,GAAG,EAAE;EACT,CAAC;EACDM,IAAI,EAAE;IACFb,IAAI,EAAEC,MAAM;IACZC,QAAQ,EAAE,CAAC,IAAI,EAAE,yBAAyB;EAC9C;AACJ,CAAC,CAAC;AAEF,IAAMY,YAAY,GAAGV,oBAAQ,CAACK,KAAK,CAAC,SAAS,EAAEC,aAAa,CAAC;;AAE7D;AAAA;AACA,IAAMK,aAAa,GAAG,IAAIjB,gBAAM,CAAC;EAC7BC,IAAI,EAAE;IACFC,IAAI,EAAEC,MAAM;IACZC,QAAQ,EAAE,CAAC,IAAI,EAAE,yBAAyB;EAC9C,CAAC;EACDc,KAAK,EAAE,CACH;IACIhB,IAAI,EAAEI,oBAAQ,CAACC,KAAK,CAACC,QAAQ;IAC7BC,GAAG,EAAE;EACT,CAAC,CACJ;EACDU,QAAQ,EAAE,CACN;IACIjB,IAAI,EAAEI,oBAAQ,CAACC,KAAK,CAACC,QAAQ;IAC7BC,GAAG,EAAE;EACT,CAAC;AAET,CAAC,CAAC;AAEF,IAAMW,YAAY,GAAGd,oBAAQ,CAACK,KAAK,CAAC,SAAS,EAAEM,aAAa,CAAC;;AAEb;AAAA"}},"mtime":1669194007702},"{\"assumptions\":{},\"sourceRoot\":\"/Users/edlin/Desktop/wp1111/hw7/backend/src/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/edlin/Desktop/wp1111/hw7/backend\",\"filename\":\"/Users/edlin/Desktop/wp1111/hw7/backend/src/mongo.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/edlin/Desktop/wp1111/hw7/backend\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"proposal-class-static-block\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ClassBody\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-private-property-in-object\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"BinaryExpression\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"proposal-class-properties\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"proposal-private-methods\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"proposal-numeric-separator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"NumericLiteral\":{\"enter\":[null]},\"BigIntLiteral\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-logical-assignment-operators\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"AssignmentExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":true,\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-json-strings\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"DirectiveLiteral\":{\"enter\":[null]},\"StringLiteral\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-optional-catch-binding\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"CatchClause\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-parameters\",\"visitor\":{\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-async-generator-functions\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-object-rest-spread\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"VariableDeclarator\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dotall-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-unicode-property-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-named-capturing-groups-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-async-to-generator\",\"visitor\":{\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-exponentiation-operator\",\"visitor\":{\"AssignmentExpression\":{\"enter\":[null]},\"BinaryExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-template-literals\",\"visitor\":{\"TaggedTemplateExpression\":{\"enter\":[null]},\"TemplateLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-literals\",\"visitor\":{\"NumericLiteral\":{\"enter\":[null]},\"StringLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-function-name\",\"visitor\":{\"FunctionExpression\":{\"exit\":[null]},\"ObjectProperty\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-arrow-functions\",\"visitor\":{\"ArrowFunctionExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-block-scoped-functions\",\"visitor\":{\"BlockStatement\":{\"enter\":[null]},\"SwitchCase\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-classes\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]},\"ClassExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-object-super\",\"visitor\":{\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-shorthand-properties\",\"visitor\":{\"ObjectMethod\":{\"enter\":[null]},\"ObjectProperty\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-duplicate-keys\",\"visitor\":{\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-computed-properties\",\"visitor\":{\"ObjectExpression\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-for-of\",\"visitor\":{\"ForOfStatement\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-sticky-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-unicode-escapes\",\"visitor\":{\"Identifier\":{\"enter\":[null]},\"TemplateElement\":{\"enter\":[null]},\"_exploded\":true,\"StringLiteral\":{\"enter\":[null]},\"DirectiveLiteral\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-unicode-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-spread\",\"visitor\":{\"ArrayExpression\":{\"enter\":[null]},\"CallExpression\":{\"enter\":[null]},\"NewExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-destructuring\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"VariableDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-block-scoping\",\"visitor\":{\"VariableDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"_exploded\":true,\"BlockStatement\":{\"enter\":[null]},\"SwitchStatement\":{\"enter\":[null]},\"Program\":{\"enter\":[null]},\"_verified\":true,\"DoWhileStatement\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForStatement\":{\"enter\":[null]},\"WhileStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-typeof-symbol\",\"visitor\":{\"UnaryExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"BlockStatement\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"DoWhileStatement\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForStatement\":{\"enter\":[null]},\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"Program\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"SwitchStatement\":{\"enter\":[null]},\"WhileStatement\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"StaticBlock\":{\"enter\":[null]},\"TSModuleBlock\":{\"enter\":[null]},\"AssignmentPattern\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectPattern\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-new-target\",\"visitor\":{\"MetaProperty\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-regenerator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ObjectMethod\":{\"enter\":[null],\"exit\":[null]},\"ClassMethod\":{\"enter\":[null],\"exit\":[null]},\"ClassPrivateMethod\":{\"enter\":[null],\"exit\":[null]},\"FunctionDeclaration\":{\"exit\":[null]},\"FunctionExpression\":{\"exit\":[null]},\"ArrowFunctionExpression\":{\"exit\":[null]},\"MemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-member-expression-literals\",\"visitor\":{\"MemberExpression\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-property-literals\",\"visitor\":{\"ObjectProperty\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-reserved-words\",\"visitor\":{\"_exploded\":true,\"_verified\":true,\"Identifier\":{\"enter\":[null,null]},\"JSXIdentifier\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.20.2:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\nvar _mongoose = _interopRequireDefault(require(\"mongoose\"));\nvar _dotenvDefaults = _interopRequireDefault(require(\"dotenv-defaults\"));\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\nvar _default = {\n  // method, a function under an object \n  connect: function connect() {\n    _dotenvDefaults[\"default\"].config();\n    if (!process.env.MONGO_URL) {\n      console.error(\"Missing MONGO_URL!!!\");\n      process.exit(1);\n    }\n    _mongoose[\"default\"].connect(process.env.MONGO_URL, {\n      // Neglect?\n      useNewUrlParser: true,\n      useUnifiedTopology: true\n    }).then(function (res) {\n      return console.log(\"mongo db connection created\");\n    });\n    _mongoose[\"default\"].connection.on('error', console.error.bind(console, 'connection error'));\n  }\n};\nexports[\"default\"] = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjb25uZWN0IiwiZG90ZW52IiwiY29uZmlnIiwicHJvY2VzcyIsImVudiIsIk1PTkdPX1VSTCIsImNvbnNvbGUiLCJlcnJvciIsImV4aXQiLCJtb25nb29zZSIsInVzZU5ld1VybFBhcnNlciIsInVzZVVuaWZpZWRUb3BvbG9neSIsInRoZW4iLCJyZXMiLCJsb2ciLCJjb25uZWN0aW9uIiwib24iLCJiaW5kIl0sInNvdXJjZVJvb3QiOiIvVXNlcnMvZWRsaW4vRGVza3RvcC93cDExMTEvaHc3L2JhY2tlbmQvc3JjLyIsInNvdXJjZXMiOlsibW9uZ28uanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IG1vbmdvb3NlIGZyb20gJ21vbmdvb3NlJztcbmltcG9ydCBkb3RlbnYgZnJvbSAnZG90ZW52LWRlZmF1bHRzJ1xuXG5leHBvcnQgZGVmYXVsdHtcbiAgICAvLyBtZXRob2QsIGEgZnVuY3Rpb24gdW5kZXIgYW4gb2JqZWN0IFxuICAgIGNvbm5lY3Q6ICgpID0+IHtcbiAgICAgICAgZG90ZW52LmNvbmZpZygpO1xuICAgICAgICBpZighcHJvY2Vzcy5lbnYuTU9OR09fVVJMKXtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJNaXNzaW5nIE1PTkdPX1VSTCEhIVwiKTtcbiAgICAgICAgICAgIHByb2Nlc3MuZXhpdCgxKTtcbiAgICAgICAgfVxuICAgICAgICBtb25nb29zZS5jb25uZWN0KHByb2Nlc3MuZW52Lk1PTkdPX1VSTCwge1xuICAgICAgICAgICAgLy8gTmVnbGVjdD9cbiAgICAgICAgICAgIHVzZU5ld1VybFBhcnNlcjogdHJ1ZSxcbiAgICAgICAgICAgIHVzZVVuaWZpZWRUb3BvbG9neTogdHJ1ZSxcbiAgICAgICAgfSlcbiAgICAgICAgLnRoZW4oKHJlcykgPT4gY29uc29sZS5sb2coXCJtb25nbyBkYiBjb25uZWN0aW9uIGNyZWF0ZWRcIikpO1xuICAgICAgICBtb25nb29zZS5jb25uZWN0aW9uLm9uKCdlcnJvcicsIGNvbnNvbGUuZXJyb3IuYmluZChjb25zb2xlLCAnY29ubmVjdGlvbiBlcnJvcicpKTtcbiAgICB9XG59OyJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUE7QUFDQTtBQUFvQztBQUFBLGVBRXRCO0VBQ1Y7RUFDQUEsT0FBTyxFQUFFLG1CQUFNO0lBQ1hDLDBCQUFNLENBQUNDLE1BQU0sRUFBRTtJQUNmLElBQUcsQ0FBQ0MsT0FBTyxDQUFDQyxHQUFHLENBQUNDLFNBQVMsRUFBQztNQUN0QkMsT0FBTyxDQUFDQyxLQUFLLENBQUMsc0JBQXNCLENBQUM7TUFDckNKLE9BQU8sQ0FBQ0ssSUFBSSxDQUFDLENBQUMsQ0FBQztJQUNuQjtJQUNBQyxvQkFBUSxDQUFDVCxPQUFPLENBQUNHLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDQyxTQUFTLEVBQUU7TUFDcEM7TUFDQUssZUFBZSxFQUFFLElBQUk7TUFDckJDLGtCQUFrQixFQUFFO0lBQ3hCLENBQUMsQ0FBQyxDQUNEQyxJQUFJLENBQUMsVUFBQ0MsR0FBRztNQUFBLE9BQUtQLE9BQU8sQ0FBQ1EsR0FBRyxDQUFDLDZCQUE2QixDQUFDO0lBQUEsRUFBQztJQUMxREwsb0JBQVEsQ0FBQ00sVUFBVSxDQUFDQyxFQUFFLENBQUMsT0FBTyxFQUFFVixPQUFPLENBQUNDLEtBQUssQ0FBQ1UsSUFBSSxDQUFDWCxPQUFPLEVBQUUsa0JBQWtCLENBQUMsQ0FBQztFQUNwRjtBQUNKLENBQUM7QUFBQSJ9","map":{"version":3,"names":["connect","dotenv","config","process","env","MONGO_URL","console","error","exit","mongoose","useNewUrlParser","useUnifiedTopology","then","res","log","connection","on","bind"],"sourceRoot":"/Users/edlin/Desktop/wp1111/hw7/backend/src/","sources":["mongo.js"],"sourcesContent":["import mongoose from 'mongoose';\nimport dotenv from 'dotenv-defaults'\n\nexport default{\n    // method, a function under an object \n    connect: () => {\n        dotenv.config();\n        if(!process.env.MONGO_URL){\n            console.error(\"Missing MONGO_URL!!!\");\n            process.exit(1);\n        }\n        mongoose.connect(process.env.MONGO_URL, {\n            // Neglect?\n            useNewUrlParser: true,\n            useUnifiedTopology: true,\n        })\n        .then((res) => console.log(\"mongo db connection created\"));\n        mongoose.connection.on('error', console.error.bind(console, 'connection error'));\n    }\n};"],"mappings":";;;;;;AAAA;AACA;AAAoC;AAAA,eAEtB;EACV;EACAA,OAAO,EAAE,mBAAM;IACXC,0BAAM,CAACC,MAAM,EAAE;IACf,IAAG,CAACC,OAAO,CAACC,GAAG,CAACC,SAAS,EAAC;MACtBC,OAAO,CAACC,KAAK,CAAC,sBAAsB,CAAC;MACrCJ,OAAO,CAACK,IAAI,CAAC,CAAC,CAAC;IACnB;IACAC,oBAAQ,CAACT,OAAO,CAACG,OAAO,CAACC,GAAG,CAACC,SAAS,EAAE;MACpC;MACAK,eAAe,EAAE,IAAI;MACrBC,kBAAkB,EAAE;IACxB,CAAC,CAAC,CACDC,IAAI,CAAC,UAACC,GAAG;MAAA,OAAKP,OAAO,CAACQ,GAAG,CAAC,6BAA6B,CAAC;IAAA,EAAC;IAC1DL,oBAAQ,CAACM,UAAU,CAACC,EAAE,CAAC,OAAO,EAAEV,OAAO,CAACC,KAAK,CAACU,IAAI,CAACX,OAAO,EAAE,kBAAkB,CAAC,CAAC;EACpF;AACJ,CAAC;AAAA"}},"mtime":1669026097009},"{\"assumptions\":{},\"sourceRoot\":\"/Users/edlin/Desktop/wp1111/hw8/backend/src/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/edlin/Desktop/wp1111/hw8/backend\",\"filename\":\"/Users/edlin/Desktop/wp1111/hw8/backend/src/server.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/edlin/Desktop/wp1111/hw8/backend\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"proposal-class-static-block\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ClassBody\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-private-property-in-object\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"BinaryExpression\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"proposal-class-properties\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"proposal-private-methods\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"proposal-numeric-separator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"NumericLiteral\":{\"enter\":[null]},\"BigIntLiteral\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-logical-assignment-operators\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"AssignmentExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":true,\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-json-strings\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"DirectiveLiteral\":{\"enter\":[null]},\"StringLiteral\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-optional-catch-binding\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"CatchClause\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-parameters\",\"visitor\":{\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-async-generator-functions\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-object-rest-spread\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"VariableDeclarator\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dotall-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-unicode-property-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-named-capturing-groups-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-async-to-generator\",\"visitor\":{\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-exponentiation-operator\",\"visitor\":{\"AssignmentExpression\":{\"enter\":[null]},\"BinaryExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-template-literals\",\"visitor\":{\"TaggedTemplateExpression\":{\"enter\":[null]},\"TemplateLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-literals\",\"visitor\":{\"NumericLiteral\":{\"enter\":[null]},\"StringLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-function-name\",\"visitor\":{\"FunctionExpression\":{\"exit\":[null]},\"ObjectProperty\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-arrow-functions\",\"visitor\":{\"ArrowFunctionExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-block-scoped-functions\",\"visitor\":{\"BlockStatement\":{\"enter\":[null]},\"SwitchCase\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-classes\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]},\"ClassExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-object-super\",\"visitor\":{\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-shorthand-properties\",\"visitor\":{\"ObjectMethod\":{\"enter\":[null]},\"ObjectProperty\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-duplicate-keys\",\"visitor\":{\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-computed-properties\",\"visitor\":{\"ObjectExpression\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-for-of\",\"visitor\":{\"ForOfStatement\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-sticky-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-unicode-escapes\",\"visitor\":{\"Identifier\":{\"enter\":[null]},\"TemplateElement\":{\"enter\":[null]},\"_exploded\":true,\"StringLiteral\":{\"enter\":[null]},\"DirectiveLiteral\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-unicode-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-spread\",\"visitor\":{\"ArrayExpression\":{\"enter\":[null]},\"CallExpression\":{\"enter\":[null]},\"NewExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-destructuring\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"VariableDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-block-scoping\",\"visitor\":{\"VariableDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"_exploded\":true,\"BlockStatement\":{\"enter\":[null]},\"SwitchStatement\":{\"enter\":[null]},\"Program\":{\"enter\":[null]},\"_verified\":true,\"DoWhileStatement\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForStatement\":{\"enter\":[null]},\"WhileStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-typeof-symbol\",\"visitor\":{\"UnaryExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"BlockStatement\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"DoWhileStatement\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForStatement\":{\"enter\":[null]},\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"Program\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"SwitchStatement\":{\"enter\":[null]},\"WhileStatement\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"StaticBlock\":{\"enter\":[null]},\"TSModuleBlock\":{\"enter\":[null]},\"AssignmentPattern\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectPattern\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-new-target\",\"visitor\":{\"MetaProperty\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-regenerator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ObjectMethod\":{\"enter\":[null],\"exit\":[null]},\"ClassMethod\":{\"enter\":[null],\"exit\":[null]},\"ClassPrivateMethod\":{\"enter\":[null],\"exit\":[null]},\"FunctionDeclaration\":{\"exit\":[null]},\"FunctionExpression\":{\"exit\":[null]},\"ArrowFunctionExpression\":{\"exit\":[null]},\"MemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-member-expression-literals\",\"visitor\":{\"MemberExpression\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-property-literals\",\"visitor\":{\"ObjectProperty\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-reserved-words\",\"visitor\":{\"_exploded\":true,\"_verified\":true,\"Identifier\":{\"enter\":[null,null]},\"JSXIdentifier\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.20.2:development":{"value":{"code":"\"use strict\";\n\nvar _express = _interopRequireDefault(require(\"express\"));\nvar _http = _interopRequireDefault(require(\"http\"));\nvar _wsConnect = _interopRequireDefault(require(\"./wsConnect\"));\nvar _mongo = _interopRequireDefault(require(\"./mongo\"));\nvar _ws = _interopRequireDefault(require(\"ws\"));\nvar _mongoose = _interopRequireDefault(require(\"mongoose\"));\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\n_mongo[\"default\"].connect();\nvar app = (0, _express[\"default\"])();\nvar server = _http[\"default\"].createServer(app);\nvar wss = new _ws[\"default\"].Server({\n  server: server\n}); // WebSocket Server\nvar db = _mongoose[\"default\"].connection; // database 的變數名稱\n\ndb.once('open', function () {\n  //\n  console.log(\"MongoDB connected!\");\n  // Define ws format for client side \n  wss.on('connection', function (ws) {\n    ws.box = '';\n    ws.onmessage = _wsConnect[\"default\"].onMessage(wss, ws);\n    // ws.onmessage = (data) => {console.log(data)};\n    // ws.onopen = () => {console.log(\"WebSocket is connected.\")};\n    // ws.onclose = () => {console.log(\"WebSocket close connection.\")};\n  });\n});\n\nvar PORT = process.env.PORT || 4000;\nserver.listen(PORT, function () {\n  console.log(\"Listening on http://localhost:\".concat(PORT));\n});\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJtb25nbyIsImNvbm5lY3QiLCJhcHAiLCJleHByZXNzIiwic2VydmVyIiwiaHR0cCIsImNyZWF0ZVNlcnZlciIsIndzcyIsIldlYlNvY2tldCIsIlNlcnZlciIsImRiIiwibW9uZ29vc2UiLCJjb25uZWN0aW9uIiwib25jZSIsImNvbnNvbGUiLCJsb2ciLCJvbiIsIndzIiwiYm94Iiwib25tZXNzYWdlIiwid3NDb25uZWN0Iiwib25NZXNzYWdlIiwiUE9SVCIsInByb2Nlc3MiLCJlbnYiLCJsaXN0ZW4iXSwic291cmNlUm9vdCI6Ii9Vc2Vycy9lZGxpbi9EZXNrdG9wL3dwMTExMS9odzgvYmFja2VuZC9zcmMvIiwic291cmNlcyI6WyJzZXJ2ZXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGV4cHJlc3MgZnJvbSAnZXhwcmVzcyc7XG5pbXBvcnQgaHR0cCBmcm9tICdodHRwJztcbmltcG9ydCB3c0Nvbm5lY3QgZnJvbSAnLi93c0Nvbm5lY3QnO1xuaW1wb3J0IG1vbmdvIGZyb20gJy4vbW9uZ28nO1xuaW1wb3J0IFdlYlNvY2tldCBmcm9tICd3cyc7XG5pbXBvcnQgbW9uZ29vc2UgZnJvbSAnbW9uZ29vc2UnO1xuXG5cbm1vbmdvLmNvbm5lY3QoKTtcblxuY29uc3QgYXBwID0gZXhwcmVzcygpO1xuY29uc3Qgc2VydmVyID0gaHR0cC5jcmVhdGVTZXJ2ZXIoYXBwKTtcbmNvbnN0IHdzcyA9IG5ldyBXZWJTb2NrZXQuU2VydmVyKHtzZXJ2ZXJ9KTsgLy8gV2ViU29ja2V0IFNlcnZlclxuY29uc3QgZGIgPSBtb25nb29zZS5jb25uZWN0aW9uOyAvLyBkYXRhYmFzZSDnmoTorormlbjlkI3nqLFcblxuZGIub25jZSgnb3BlbicsICgpID0+IHtcbiAgLy9cbiAgY29uc29sZS5sb2coXCJNb25nb0RCIGNvbm5lY3RlZCFcIik7XG4gIC8vIERlZmluZSB3cyBmb3JtYXQgZm9yIGNsaWVudCBzaWRlIFxuICB3c3Mub24oJ2Nvbm5lY3Rpb24nLCAod3MpID0+IHtcbiAgICB3cy5ib3ggPSAnJztcbiAgICB3cy5vbm1lc3NhZ2UgPSB3c0Nvbm5lY3Qub25NZXNzYWdlKHdzcywgd3MpO1xuICAgIC8vIHdzLm9ubWVzc2FnZSA9IChkYXRhKSA9PiB7Y29uc29sZS5sb2coZGF0YSl9O1xuICAgIC8vIHdzLm9ub3BlbiA9ICgpID0+IHtjb25zb2xlLmxvZyhcIldlYlNvY2tldCBpcyBjb25uZWN0ZWQuXCIpfTtcbiAgICAvLyB3cy5vbmNsb3NlID0gKCkgPT4ge2NvbnNvbGUubG9nKFwiV2ViU29ja2V0IGNsb3NlIGNvbm5lY3Rpb24uXCIpfTtcbiAgfSk7XG59KTtcblxuY29uc3QgUE9SVCA9IHByb2Nlc3MuZW52LlBPUlQgfHwgNDAwMDtcbnNlcnZlci5saXN0ZW4oUE9SVCwgKCkgPT4ge1xuICAgIGNvbnNvbGUubG9nKGBMaXN0ZW5pbmcgb24gaHR0cDovL2xvY2FsaG9zdDoke1BPUlR9YCk7XG59KTsiXSwibWFwcGluZ3MiOiI7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQWdDO0FBR2hDQSxpQkFBSyxDQUFDQyxPQUFPLEVBQUU7QUFFZixJQUFNQyxHQUFHLEdBQUcsSUFBQUMsbUJBQU8sR0FBRTtBQUNyQixJQUFNQyxNQUFNLEdBQUdDLGdCQUFJLENBQUNDLFlBQVksQ0FBQ0osR0FBRyxDQUFDO0FBQ3JDLElBQU1LLEdBQUcsR0FBRyxJQUFJQyxjQUFTLENBQUNDLE1BQU0sQ0FBQztFQUFDTCxNQUFNLEVBQU5BO0FBQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUM1QyxJQUFNTSxFQUFFLEdBQUdDLG9CQUFRLENBQUNDLFVBQVUsQ0FBQyxDQUFDOztBQUVoQ0YsRUFBRSxDQUFDRyxJQUFJLENBQUMsTUFBTSxFQUFFLFlBQU07RUFDcEI7RUFDQUMsT0FBTyxDQUFDQyxHQUFHLENBQUMsb0JBQW9CLENBQUM7RUFDakM7RUFDQVIsR0FBRyxDQUFDUyxFQUFFLENBQUMsWUFBWSxFQUFFLFVBQUNDLEVBQUUsRUFBSztJQUMzQkEsRUFBRSxDQUFDQyxHQUFHLEdBQUcsRUFBRTtJQUNYRCxFQUFFLENBQUNFLFNBQVMsR0FBR0MscUJBQVMsQ0FBQ0MsU0FBUyxDQUFDZCxHQUFHLEVBQUVVLEVBQUUsQ0FBQztJQUMzQztJQUNBO0lBQ0E7RUFDRixDQUFDLENBQUM7QUFDSixDQUFDLENBQUM7O0FBRUYsSUFBTUssSUFBSSxHQUFHQyxPQUFPLENBQUNDLEdBQUcsQ0FBQ0YsSUFBSSxJQUFJLElBQUk7QUFDckNsQixNQUFNLENBQUNxQixNQUFNLENBQUNILElBQUksRUFBRSxZQUFNO0VBQ3RCUixPQUFPLENBQUNDLEdBQUcseUNBQWtDTyxJQUFJLEVBQUc7QUFDeEQsQ0FBQyxDQUFDIn0=","map":{"version":3,"names":["mongo","connect","app","express","server","http","createServer","wss","WebSocket","Server","db","mongoose","connection","once","console","log","on","ws","box","onmessage","wsConnect","onMessage","PORT","process","env","listen"],"sourceRoot":"/Users/edlin/Desktop/wp1111/hw8/backend/src/","sources":["server.js"],"sourcesContent":["import express from 'express';\nimport http from 'http';\nimport wsConnect from './wsConnect';\nimport mongo from './mongo';\nimport WebSocket from 'ws';\nimport mongoose from 'mongoose';\n\n\nmongo.connect();\n\nconst app = express();\nconst server = http.createServer(app);\nconst wss = new WebSocket.Server({server}); // WebSocket Server\nconst db = mongoose.connection; // database 的變數名稱\n\ndb.once('open', () => {\n  //\n  console.log(\"MongoDB connected!\");\n  // Define ws format for client side \n  wss.on('connection', (ws) => {\n    ws.box = '';\n    ws.onmessage = wsConnect.onMessage(wss, ws);\n    // ws.onmessage = (data) => {console.log(data)};\n    // ws.onopen = () => {console.log(\"WebSocket is connected.\")};\n    // ws.onclose = () => {console.log(\"WebSocket close connection.\")};\n  });\n});\n\nconst PORT = process.env.PORT || 4000;\nserver.listen(PORT, () => {\n    console.log(`Listening on http://localhost:${PORT}`);\n});"],"mappings":";;AAAA;AACA;AACA;AACA;AACA;AACA;AAAgC;AAGhCA,iBAAK,CAACC,OAAO,EAAE;AAEf,IAAMC,GAAG,GAAG,IAAAC,mBAAO,GAAE;AACrB,IAAMC,MAAM,GAAGC,gBAAI,CAACC,YAAY,CAACJ,GAAG,CAAC;AACrC,IAAMK,GAAG,GAAG,IAAIC,cAAS,CAACC,MAAM,CAAC;EAACL,MAAM,EAANA;AAAM,CAAC,CAAC,CAAC,CAAC;AAC5C,IAAMM,EAAE,GAAGC,oBAAQ,CAACC,UAAU,CAAC,CAAC;;AAEhCF,EAAE,CAACG,IAAI,CAAC,MAAM,EAAE,YAAM;EACpB;EACAC,OAAO,CAACC,GAAG,CAAC,oBAAoB,CAAC;EACjC;EACAR,GAAG,CAACS,EAAE,CAAC,YAAY,EAAE,UAACC,EAAE,EAAK;IAC3BA,EAAE,CAACC,GAAG,GAAG,EAAE;IACXD,EAAE,CAACE,SAAS,GAAGC,qBAAS,CAACC,SAAS,CAACd,GAAG,EAAEU,EAAE,CAAC;IAC3C;IACA;IACA;EACF,CAAC,CAAC;AACJ,CAAC,CAAC;;AAEF,IAAMK,IAAI,GAAGC,OAAO,CAACC,GAAG,CAACF,IAAI,IAAI,IAAI;AACrClB,MAAM,CAACqB,MAAM,CAACH,IAAI,EAAE,YAAM;EACtBR,OAAO,CAACC,GAAG,yCAAkCO,IAAI,EAAG;AACxD,CAAC,CAAC"}},"mtime":1669165647559},"{\"assumptions\":{},\"sourceRoot\":\"/Users/edlin/Desktop/wp1111/hw8/backend/src/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/edlin/Desktop/wp1111/hw8/backend\",\"filename\":\"/Users/edlin/Desktop/wp1111/hw8/backend/src/wsConnect.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/edlin/Desktop/wp1111/hw8/backend\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"proposal-class-static-block\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ClassBody\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-private-property-in-object\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"BinaryExpression\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"proposal-class-properties\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"proposal-private-methods\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"proposal-numeric-separator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"NumericLiteral\":{\"enter\":[null]},\"BigIntLiteral\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-logical-assignment-operators\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"AssignmentExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":true,\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-json-strings\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"DirectiveLiteral\":{\"enter\":[null]},\"StringLiteral\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-optional-catch-binding\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"CatchClause\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-parameters\",\"visitor\":{\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-async-generator-functions\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-object-rest-spread\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"VariableDeclarator\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dotall-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-unicode-property-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-named-capturing-groups-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-async-to-generator\",\"visitor\":{\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-exponentiation-operator\",\"visitor\":{\"AssignmentExpression\":{\"enter\":[null]},\"BinaryExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-template-literals\",\"visitor\":{\"TaggedTemplateExpression\":{\"enter\":[null]},\"TemplateLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-literals\",\"visitor\":{\"NumericLiteral\":{\"enter\":[null]},\"StringLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-function-name\",\"visitor\":{\"FunctionExpression\":{\"exit\":[null]},\"ObjectProperty\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-arrow-functions\",\"visitor\":{\"ArrowFunctionExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-block-scoped-functions\",\"visitor\":{\"BlockStatement\":{\"enter\":[null]},\"SwitchCase\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-classes\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]},\"ClassExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-object-super\",\"visitor\":{\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-shorthand-properties\",\"visitor\":{\"ObjectMethod\":{\"enter\":[null]},\"ObjectProperty\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-duplicate-keys\",\"visitor\":{\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-computed-properties\",\"visitor\":{\"ObjectExpression\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-for-of\",\"visitor\":{\"ForOfStatement\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-sticky-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-unicode-escapes\",\"visitor\":{\"Identifier\":{\"enter\":[null]},\"TemplateElement\":{\"enter\":[null]},\"_exploded\":true,\"StringLiteral\":{\"enter\":[null]},\"DirectiveLiteral\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-unicode-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-spread\",\"visitor\":{\"ArrayExpression\":{\"enter\":[null]},\"CallExpression\":{\"enter\":[null]},\"NewExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-destructuring\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"VariableDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-block-scoping\",\"visitor\":{\"VariableDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"_exploded\":true,\"BlockStatement\":{\"enter\":[null]},\"SwitchStatement\":{\"enter\":[null]},\"Program\":{\"enter\":[null]},\"_verified\":true,\"DoWhileStatement\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForStatement\":{\"enter\":[null]},\"WhileStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-typeof-symbol\",\"visitor\":{\"UnaryExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"BlockStatement\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"DoWhileStatement\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForStatement\":{\"enter\":[null]},\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"Program\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"SwitchStatement\":{\"enter\":[null]},\"WhileStatement\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"StaticBlock\":{\"enter\":[null]},\"TSModuleBlock\":{\"enter\":[null]},\"AssignmentPattern\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectPattern\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-new-target\",\"visitor\":{\"MetaProperty\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-regenerator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ObjectMethod\":{\"enter\":[null],\"exit\":[null]},\"ClassMethod\":{\"enter\":[null],\"exit\":[null]},\"ClassPrivateMethod\":{\"enter\":[null],\"exit\":[null]},\"FunctionDeclaration\":{\"exit\":[null]},\"FunctionExpression\":{\"exit\":[null]},\"ArrowFunctionExpression\":{\"exit\":[null]},\"MemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-member-expression-literals\",\"visitor\":{\"MemberExpression\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-property-literals\",\"visitor\":{\"ObjectProperty\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-reserved-words\",\"visitor\":{\"_exploded\":true,\"_verified\":true,\"Identifier\":{\"enter\":[null,null]},\"JSXIdentifier\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.20.2:development":{"value":{"code":"\"use strict\";\n\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, _typeof(obj); }\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\nvar _mongoose = _interopRequireDefault(require(\"mongoose\"));\nvar _ws = _interopRequireDefault(require(\"ws\"));\nvar _chatbox = require(\"./models/chatbox\");\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\nfunction _iterableToArrayLimit(arr, i) { var _i = arr == null ? null : typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"]; if (_i == null) return; var _arr = []; var _n = true; var _d = false; var _s, _e; try { for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\nfunction _regeneratorRuntime() { \"use strict\"; /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */ _regeneratorRuntime = function _regeneratorRuntime() { return exports; }; var exports = {}, Op = Object.prototype, hasOwn = Op.hasOwnProperty, defineProperty = Object.defineProperty || function (obj, key, desc) { obj[key] = desc.value; }, $Symbol = \"function\" == typeof Symbol ? Symbol : {}, iteratorSymbol = $Symbol.iterator || \"@@iterator\", asyncIteratorSymbol = $Symbol.asyncIterator || \"@@asyncIterator\", toStringTagSymbol = $Symbol.toStringTag || \"@@toStringTag\"; function define(obj, key, value) { return Object.defineProperty(obj, key, { value: value, enumerable: !0, configurable: !0, writable: !0 }), obj[key]; } try { define({}, \"\"); } catch (err) { define = function define(obj, key, value) { return obj[key] = value; }; } function wrap(innerFn, outerFn, self, tryLocsList) { var protoGenerator = outerFn && outerFn.prototype instanceof Generator ? outerFn : Generator, generator = Object.create(protoGenerator.prototype), context = new Context(tryLocsList || []); return defineProperty(generator, \"_invoke\", { value: makeInvokeMethod(innerFn, self, context) }), generator; } function tryCatch(fn, obj, arg) { try { return { type: \"normal\", arg: fn.call(obj, arg) }; } catch (err) { return { type: \"throw\", arg: err }; } } exports.wrap = wrap; var ContinueSentinel = {}; function Generator() {} function GeneratorFunction() {} function GeneratorFunctionPrototype() {} var IteratorPrototype = {}; define(IteratorPrototype, iteratorSymbol, function () { return this; }); var getProto = Object.getPrototypeOf, NativeIteratorPrototype = getProto && getProto(getProto(values([]))); NativeIteratorPrototype && NativeIteratorPrototype !== Op && hasOwn.call(NativeIteratorPrototype, iteratorSymbol) && (IteratorPrototype = NativeIteratorPrototype); var Gp = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(IteratorPrototype); function defineIteratorMethods(prototype) { [\"next\", \"throw\", \"return\"].forEach(function (method) { define(prototype, method, function (arg) { return this._invoke(method, arg); }); }); } function AsyncIterator(generator, PromiseImpl) { function invoke(method, arg, resolve, reject) { var record = tryCatch(generator[method], generator, arg); if (\"throw\" !== record.type) { var result = record.arg, value = result.value; return value && \"object\" == _typeof(value) && hasOwn.call(value, \"__await\") ? PromiseImpl.resolve(value.__await).then(function (value) { invoke(\"next\", value, resolve, reject); }, function (err) { invoke(\"throw\", err, resolve, reject); }) : PromiseImpl.resolve(value).then(function (unwrapped) { result.value = unwrapped, resolve(result); }, function (error) { return invoke(\"throw\", error, resolve, reject); }); } reject(record.arg); } var previousPromise; defineProperty(this, \"_invoke\", { value: function value(method, arg) { function callInvokeWithMethodAndArg() { return new PromiseImpl(function (resolve, reject) { invoke(method, arg, resolve, reject); }); } return previousPromise = previousPromise ? previousPromise.then(callInvokeWithMethodAndArg, callInvokeWithMethodAndArg) : callInvokeWithMethodAndArg(); } }); } function makeInvokeMethod(innerFn, self, context) { var state = \"suspendedStart\"; return function (method, arg) { if (\"executing\" === state) throw new Error(\"Generator is already running\"); if (\"completed\" === state) { if (\"throw\" === method) throw arg; return doneResult(); } for (context.method = method, context.arg = arg;;) { var delegate = context.delegate; if (delegate) { var delegateResult = maybeInvokeDelegate(delegate, context); if (delegateResult) { if (delegateResult === ContinueSentinel) continue; return delegateResult; } } if (\"next\" === context.method) context.sent = context._sent = context.arg;else if (\"throw\" === context.method) { if (\"suspendedStart\" === state) throw state = \"completed\", context.arg; context.dispatchException(context.arg); } else \"return\" === context.method && context.abrupt(\"return\", context.arg); state = \"executing\"; var record = tryCatch(innerFn, self, context); if (\"normal\" === record.type) { if (state = context.done ? \"completed\" : \"suspendedYield\", record.arg === ContinueSentinel) continue; return { value: record.arg, done: context.done }; } \"throw\" === record.type && (state = \"completed\", context.method = \"throw\", context.arg = record.arg); } }; } function maybeInvokeDelegate(delegate, context) { var method = delegate.iterator[context.method]; if (undefined === method) { if (context.delegate = null, \"throw\" === context.method) { if (delegate.iterator[\"return\"] && (context.method = \"return\", context.arg = undefined, maybeInvokeDelegate(delegate, context), \"throw\" === context.method)) return ContinueSentinel; context.method = \"throw\", context.arg = new TypeError(\"The iterator does not provide a 'throw' method\"); } return ContinueSentinel; } var record = tryCatch(method, delegate.iterator, context.arg); if (\"throw\" === record.type) return context.method = \"throw\", context.arg = record.arg, context.delegate = null, ContinueSentinel; var info = record.arg; return info ? info.done ? (context[delegate.resultName] = info.value, context.next = delegate.nextLoc, \"return\" !== context.method && (context.method = \"next\", context.arg = undefined), context.delegate = null, ContinueSentinel) : info : (context.method = \"throw\", context.arg = new TypeError(\"iterator result is not an object\"), context.delegate = null, ContinueSentinel); } function pushTryEntry(locs) { var entry = { tryLoc: locs[0] }; 1 in locs && (entry.catchLoc = locs[1]), 2 in locs && (entry.finallyLoc = locs[2], entry.afterLoc = locs[3]), this.tryEntries.push(entry); } function resetTryEntry(entry) { var record = entry.completion || {}; record.type = \"normal\", delete record.arg, entry.completion = record; } function Context(tryLocsList) { this.tryEntries = [{ tryLoc: \"root\" }], tryLocsList.forEach(pushTryEntry, this), this.reset(!0); } function values(iterable) { if (iterable) { var iteratorMethod = iterable[iteratorSymbol]; if (iteratorMethod) return iteratorMethod.call(iterable); if (\"function\" == typeof iterable.next) return iterable; if (!isNaN(iterable.length)) { var i = -1, next = function next() { for (; ++i < iterable.length;) { if (hasOwn.call(iterable, i)) return next.value = iterable[i], next.done = !1, next; } return next.value = undefined, next.done = !0, next; }; return next.next = next; } } return { next: doneResult }; } function doneResult() { return { value: undefined, done: !0 }; } return GeneratorFunction.prototype = GeneratorFunctionPrototype, defineProperty(Gp, \"constructor\", { value: GeneratorFunctionPrototype, configurable: !0 }), defineProperty(GeneratorFunctionPrototype, \"constructor\", { value: GeneratorFunction, configurable: !0 }), GeneratorFunction.displayName = define(GeneratorFunctionPrototype, toStringTagSymbol, \"GeneratorFunction\"), exports.isGeneratorFunction = function (genFun) { var ctor = \"function\" == typeof genFun && genFun.constructor; return !!ctor && (ctor === GeneratorFunction || \"GeneratorFunction\" === (ctor.displayName || ctor.name)); }, exports.mark = function (genFun) { return Object.setPrototypeOf ? Object.setPrototypeOf(genFun, GeneratorFunctionPrototype) : (genFun.__proto__ = GeneratorFunctionPrototype, define(genFun, toStringTagSymbol, \"GeneratorFunction\")), genFun.prototype = Object.create(Gp), genFun; }, exports.awrap = function (arg) { return { __await: arg }; }, defineIteratorMethods(AsyncIterator.prototype), define(AsyncIterator.prototype, asyncIteratorSymbol, function () { return this; }), exports.AsyncIterator = AsyncIterator, exports.async = function (innerFn, outerFn, self, tryLocsList, PromiseImpl) { void 0 === PromiseImpl && (PromiseImpl = Promise); var iter = new AsyncIterator(wrap(innerFn, outerFn, self, tryLocsList), PromiseImpl); return exports.isGeneratorFunction(outerFn) ? iter : iter.next().then(function (result) { return result.done ? result.value : iter.next(); }); }, defineIteratorMethods(Gp), define(Gp, toStringTagSymbol, \"Generator\"), define(Gp, iteratorSymbol, function () { return this; }), define(Gp, \"toString\", function () { return \"[object Generator]\"; }), exports.keys = function (val) { var object = Object(val), keys = []; for (var key in object) { keys.push(key); } return keys.reverse(), function next() { for (; keys.length;) { var key = keys.pop(); if (key in object) return next.value = key, next.done = !1, next; } return next.done = !0, next; }; }, exports.values = values, Context.prototype = { constructor: Context, reset: function reset(skipTempReset) { if (this.prev = 0, this.next = 0, this.sent = this._sent = undefined, this.done = !1, this.delegate = null, this.method = \"next\", this.arg = undefined, this.tryEntries.forEach(resetTryEntry), !skipTempReset) for (var name in this) { \"t\" === name.charAt(0) && hasOwn.call(this, name) && !isNaN(+name.slice(1)) && (this[name] = undefined); } }, stop: function stop() { this.done = !0; var rootRecord = this.tryEntries[0].completion; if (\"throw\" === rootRecord.type) throw rootRecord.arg; return this.rval; }, dispatchException: function dispatchException(exception) { if (this.done) throw exception; var context = this; function handle(loc, caught) { return record.type = \"throw\", record.arg = exception, context.next = loc, caught && (context.method = \"next\", context.arg = undefined), !!caught; } for (var i = this.tryEntries.length - 1; i >= 0; --i) { var entry = this.tryEntries[i], record = entry.completion; if (\"root\" === entry.tryLoc) return handle(\"end\"); if (entry.tryLoc <= this.prev) { var hasCatch = hasOwn.call(entry, \"catchLoc\"), hasFinally = hasOwn.call(entry, \"finallyLoc\"); if (hasCatch && hasFinally) { if (this.prev < entry.catchLoc) return handle(entry.catchLoc, !0); if (this.prev < entry.finallyLoc) return handle(entry.finallyLoc); } else if (hasCatch) { if (this.prev < entry.catchLoc) return handle(entry.catchLoc, !0); } else { if (!hasFinally) throw new Error(\"try statement without catch or finally\"); if (this.prev < entry.finallyLoc) return handle(entry.finallyLoc); } } } }, abrupt: function abrupt(type, arg) { for (var i = this.tryEntries.length - 1; i >= 0; --i) { var entry = this.tryEntries[i]; if (entry.tryLoc <= this.prev && hasOwn.call(entry, \"finallyLoc\") && this.prev < entry.finallyLoc) { var finallyEntry = entry; break; } } finallyEntry && (\"break\" === type || \"continue\" === type) && finallyEntry.tryLoc <= arg && arg <= finallyEntry.finallyLoc && (finallyEntry = null); var record = finallyEntry ? finallyEntry.completion : {}; return record.type = type, record.arg = arg, finallyEntry ? (this.method = \"next\", this.next = finallyEntry.finallyLoc, ContinueSentinel) : this.complete(record); }, complete: function complete(record, afterLoc) { if (\"throw\" === record.type) throw record.arg; return \"break\" === record.type || \"continue\" === record.type ? this.next = record.arg : \"return\" === record.type ? (this.rval = this.arg = record.arg, this.method = \"return\", this.next = \"end\") : \"normal\" === record.type && afterLoc && (this.next = afterLoc), ContinueSentinel; }, finish: function finish(finallyLoc) { for (var i = this.tryEntries.length - 1; i >= 0; --i) { var entry = this.tryEntries[i]; if (entry.finallyLoc === finallyLoc) return this.complete(entry.completion, entry.afterLoc), resetTryEntry(entry), ContinueSentinel; } }, \"catch\": function _catch(tryLoc) { for (var i = this.tryEntries.length - 1; i >= 0; --i) { var entry = this.tryEntries[i]; if (entry.tryLoc === tryLoc) { var record = entry.completion; if (\"throw\" === record.type) { var thrown = record.arg; resetTryEntry(entry); } return thrown; } } throw new Error(\"illegal catch attempt\"); }, delegateYield: function delegateYield(iterable, resultName, nextLoc) { return this.delegate = { iterator: values(iterable), resultName: resultName, nextLoc: nextLoc }, \"next\" === this.method && (this.arg = undefined), ContinueSentinel; } }, exports; }\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\nfunction _createForOfIteratorHelper(o, allowArrayLike) { var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"]; if (!it) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e2) { throw _e2; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = it.call(o); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e3) { didErr = true; err = _e3; }, f: function f() { try { if (!normalCompletion && it[\"return\"] != null) it[\"return\"](); } finally { if (didErr) throw err; } } }; }\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\nvar sendData = function sendData(data, wsSet) {\n  // console.log('type of wsSet:', typeof(wsSet));\n  // console.log('wsSet:', wsSet);\n\n  if (Object.getPrototypeOf(wsSet) === Set.prototype) {\n    //對 set 中的每個 ws 進行迭代\n    var _iterator = _createForOfIteratorHelper(wsSet),\n      _step;\n    try {\n      for (_iterator.s(); !(_step = _iterator.n()).done;) {\n        var item = _step.value;\n        item.send(JSON.stringify(data));\n      }\n      // console.log('case 1');\n    } catch (err) {\n      _iterator.e(err);\n    } finally {\n      _iterator.f();\n    }\n  } else {\n    wsSet.send(JSON.stringify(data));\n    // console.log('case 2');\n  }\n\n  console.log('Data send success.');\n};\nvar sendStatus = function sendStatus(payload, ws) {\n  sendData([\"status\", payload], ws);\n};\n\n// Create Chatroom ID\nvar makeName = function makeName(name, friend) {\n  return [name, friend].sort().join('_');\n};\n\n// ***\n// Check ChatRoom exists or not\nvar validateChatBox = /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(chatRoomName, name, friend) {\n    var box;\n    return _regeneratorRuntime().wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.next = 2;\n            return _chatbox.ChatBoxModel.findOne({\n              name: chatRoomName\n            });\n          case 2:\n            box = _context.sent;\n            if (box) {\n              _context.next = 10;\n              break;\n            }\n            // 要先有users ObjectId.\n            console.log('ChatBoxModel不存在 -> 建立ChatBoxModel');\n            _context.next = 7;\n            return new _chatbox.ChatBoxModel({\n              name: chatRoomName\n            }).save();\n          case 7:\n            box = _context.sent;\n            _context.next = 11;\n            break;\n          case 10:\n            console.log(\"Find Current Chat Box\", box.name);\n          case 11:\n            return _context.abrupt(\"return\", box);\n          case 12:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n  return function validateChatBox(_x, _x2, _x3) {\n    return _ref.apply(this, arguments);\n  };\n}();\n\n// // Create Users\n// const makeUsers = async (myName, friend) => {\n//     console.log('User names', myName, friend);\n//     let user1 = await UserModel.findOne({name: myName})\n//     let user2 = await UserModel.findOne({name: friend})\n\n//     if(!user1){\n//         user1 = await new UserModel({name: myName}).save()\n//     }\n\n//     if(!user2){\n//         user2 = await new UserModel({name: friend}).save()\n//     }\n//     console.log(\"Users_id \",[user1._id, user2._id])\n// }\n\n// 建立一個 dictionary of { chatBoxName, Set<ws> }, -> key: value -> \"chatBoxName\": set(ws...)\n// 可以從 chatbox name 找到當前有哪些 websockets / ChatRooms \n// 有這個名字的 chatbox 且為 active\nvar chatBoxes = {};\nvar _default = {\n  // 解析client傳來的資料\n  onMessage: function onMessage(wss, ws) {\n    return /*#__PURE__*/function () {\n      var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2(byteString) {\n        var data, _JSON$parse, _JSON$parse2, task, payload, name, friend, chatBoxName, chatBoxObject, messages, body, _chatBoxObject, msg;\n        return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                data = byteString.data;\n                _JSON$parse = JSON.parse(data), _JSON$parse2 = _slicedToArray(_JSON$parse, 2), task = _JSON$parse2[0], payload = _JSON$parse2[1];\n                name = payload.name, friend = payload.friend; // user(ws) was in another chatbox\n                if (ws.box !== \"\" && chatBoxes[ws.box]) {\n                  chatBoxes[ws.box][\"delete\"](ws);\n                }\n                // ws 因故關閉\n                ws.once('close', function () {\n                  chatBoxes[ws.box][\"delete\"](ws);\n                });\n\n                // create Chatroom ID\n                chatBoxName = makeName(name, friend);\n                ws.box = chatBoxName;\n\n                // // Create Users\n                // if(name !== undefined){\n                //     await makeUsers(name, friend);\n                // }\n                // // console.log(typeof(participantsID));\n\n                // check ChatRoom exists or not\n                _context2.t0 = console;\n                _context2.next = 10;\n                return validateChatBox(chatBoxName, name, friend);\n              case 10:\n                _context2.t1 = _context2.sent;\n                _context2.t0.log.call(_context2.t0, 'Validation of chat box:', _context2.t1);\n                // console.log( validateChatBox(chatBoxName, participants) );\n\n                // ws dict\n                // 如果不曾有過 chatBoxName 的對話，將 chatBoxes[chatBoxName] 設定為 empty Set\n                if (!chatBoxes[chatBoxName]) {\n                  console.log(\"WebSocket: ChatBox 不存在，創建 New Set for chatBox\");\n                  chatBoxes[chatBoxName] = new Set(); // make new record for chatbox\n                }\n                // 將 ws client 加入 chatBoxes[chatBoxName] \n                chatBoxes[chatBoxName].add(ws); // add this open connection into chatbox\n                _context2.t2 = task;\n                _context2.next = _context2.t2 === 'Init' ? 17 : _context2.t2 === 'input' ? 30 : 47;\n                break;\n              case 17:\n                _context2.next = 19;\n                return _chatbox.ChatBoxModel.findOne({\n                  name: chatBoxName\n                });\n              case 19:\n                chatBoxObject = _context2.sent;\n                messages = chatBoxObject.messages;\n                _context2.prev = 21;\n                sendData(['Init', messages, chatBoxName], ws); // messages = {sender, body, _id}\n                sendStatus({\n                  // {['status',{type, msg}]}\n                  type: \"success\",\n                  msg: \"Successfully Open one Chatroom\"\n                }, ws);\n                _context2.next = 29;\n                break;\n              case 26:\n                _context2.prev = 26;\n                _context2.t3 = _context2[\"catch\"](21);\n                throw new Error(\"Message sending is failed: \" + _context2.t3);\n              case 29:\n                return _context2.abrupt(\"break\", 48);\n              case 30:\n                body = payload.body; // Save message to DB\n                _context2.next = 33;\n                return _chatbox.ChatBoxModel.findOne({\n                  name: chatBoxName\n                });\n              case 33:\n                _chatBoxObject = _context2.sent;\n                // const senderObject = await UserModel.findOne({name: name});\n                console.log('Ids:', _chatBoxObject._id);\n                // const message = await new MessageModel({ chatBox: chatBoxObject._id, sender: senderObject._id, body: body }).save();\n                // const message = await new MessageModel({ body: body }).save();\n                _context2.prev = 35;\n                _context2.next = 38;\n                return _chatbox.ChatBoxModel.findOneAndUpdate({\n                  name: chatBoxName\n                }, {\n                  \"$push\": {\n                    \"messages\": {\n                      sender: name,\n                      body: body\n                    }\n                  }\n                }, {\n                  \"new\": true\n                });\n              case 38:\n                // Respond to Sender\n                // ( await (await message.populate(\"chatBox\")).populate(\"sender\"));\n                // sendData(['backToSender', message, chatBoxName], ws) // ['backToSender', message]\n                // sendStatus({    // {['status',{type, msg}]}\n                //     type: \"success\",\n                //     msg: \"Successfully sent one message\",\n                // }, ws)\n                // Respond to Receiver\n                msg = {\n                  sender: name,\n                  body: body\n                };\n                sendData(['backToReceiver', msg, chatBoxName], chatBoxes[chatBoxName]);\n                sendStatus({\n                  type: 'success',\n                  msg: \"Successfully receive one message\"\n                }, chatBoxes[chatBoxName]);\n                _context2.next = 46;\n                break;\n              case 43:\n                _context2.prev = 43;\n                _context2.t4 = _context2[\"catch\"](35);\n                throw new Error(\"Message sending is failed: \" + _context2.t4);\n              case 46:\n                return _context2.abrupt(\"break\", 48);\n              case 47:\n                return _context2.abrupt(\"break\", 48);\n              case 48:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, null, [[21, 26], [35, 43]]);\n      }));\n      return function (_x4) {\n        return _ref2.apply(this, arguments);\n      };\n    }();\n  }\n};\nexports[\"default\"] = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJzZW5kRGF0YSIsImRhdGEiLCJ3c1NldCIsIk9iamVjdCIsImdldFByb3RvdHlwZU9mIiwiU2V0IiwicHJvdG90eXBlIiwiaXRlbSIsInNlbmQiLCJKU09OIiwic3RyaW5naWZ5IiwiY29uc29sZSIsImxvZyIsInNlbmRTdGF0dXMiLCJwYXlsb2FkIiwid3MiLCJtYWtlTmFtZSIsIm5hbWUiLCJmcmllbmQiLCJzb3J0Iiwiam9pbiIsInZhbGlkYXRlQ2hhdEJveCIsImNoYXRSb29tTmFtZSIsIkNoYXRCb3hNb2RlbCIsImZpbmRPbmUiLCJib3giLCJzYXZlIiwiY2hhdEJveGVzIiwib25NZXNzYWdlIiwid3NzIiwiYnl0ZVN0cmluZyIsInBhcnNlIiwidGFzayIsIm9uY2UiLCJjaGF0Qm94TmFtZSIsImFkZCIsImNoYXRCb3hPYmplY3QiLCJtZXNzYWdlcyIsInR5cGUiLCJtc2ciLCJFcnJvciIsImJvZHkiLCJfaWQiLCJmaW5kT25lQW5kVXBkYXRlIiwic2VuZGVyIl0sInNvdXJjZVJvb3QiOiIvVXNlcnMvZWRsaW4vRGVza3RvcC93cDExMTEvaHc4L2JhY2tlbmQvc3JjLyIsInNvdXJjZXMiOlsid3NDb25uZWN0LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBtb25nb29zZSBmcm9tIFwibW9uZ29vc2VcIjtcbmltcG9ydCBXZWJTb2NrZXQgZnJvbSAnd3MnO1xuXG5pbXBvcnQge1VzZXJNb2RlbCwgTWVzc2FnZU1vZGVsLCBDaGF0Qm94TW9kZWx9IGZyb20gXCIuL21vZGVscy9jaGF0Ym94XCI7XG5cbmNvbnN0IHNlbmREYXRhID0gKGRhdGEsIHdzU2V0KSA9PiB7XG5cbiAgICAvLyBjb25zb2xlLmxvZygndHlwZSBvZiB3c1NldDonLCB0eXBlb2Yod3NTZXQpKTtcbiAgICAvLyBjb25zb2xlLmxvZygnd3NTZXQ6Jywgd3NTZXQpO1xuXG4gICAgaWYoIE9iamVjdC5nZXRQcm90b3R5cGVPZih3c1NldCkgPT09IFNldC5wcm90b3R5cGUgKXtcbiAgICAgICAgLy/lsI0gc2V0IOS4reeahOavj+WAiyB3cyDpgLLooYzov63ku6NcbiAgICAgICAgZm9yIChsZXQgaXRlbSBvZiB3c1NldCl7XG4gICAgICAgICAgICBpdGVtLnNlbmQoSlNPTi5zdHJpbmdpZnkoZGF0YSkpOyBcbiAgICAgICAgfVxuICAgICAgICAvLyBjb25zb2xlLmxvZygnY2FzZSAxJyk7XG4gICAgfVxuICAgIGVsc2V7XG4gICAgICAgIHdzU2V0LnNlbmQoSlNPTi5zdHJpbmdpZnkoZGF0YSkpOyBcbiAgICAgICAgLy8gY29uc29sZS5sb2coJ2Nhc2UgMicpO1xuXG4gICAgfVxuXG4gICAgY29uc29sZS5sb2coJ0RhdGEgc2VuZCBzdWNjZXNzLicpXG59XG5jb25zdCBzZW5kU3RhdHVzID0gKHBheWxvYWQsIHdzKSA9PiB7XG4gICAgc2VuZERhdGEoW1wic3RhdHVzXCIsIHBheWxvYWRdLCB3cyk7IFxufVxuXG4vLyBDcmVhdGUgQ2hhdHJvb20gSURcbmNvbnN0IG1ha2VOYW1lID0gKG5hbWUsIGZyaWVuZCkgPT4ge1xuICAgIHJldHVybiBbbmFtZSwgZnJpZW5kXS5zb3J0KCkuam9pbignXycpO1xufVxuXG4vLyAqKipcbi8vIENoZWNrIENoYXRSb29tIGV4aXN0cyBvciBub3RcbmNvbnN0IHZhbGlkYXRlQ2hhdEJveCA9IGFzeW5jIChjaGF0Um9vbU5hbWUsIG5hbWUsIGZyaWVuZCkgPT4ge1xuICAgIGxldCBib3ggPSBhd2FpdCBDaGF0Qm94TW9kZWwuZmluZE9uZSh7IG5hbWU6IGNoYXRSb29tTmFtZSB9KTtcbiAgICAvLyBjb25zb2xlLmxvZyhcImJveDpcIiwgYm94KTtcbiAgICAvLyBjb25zb2xlLmxvZyhcImNoYXRCb3hOYW1lOlwiLCBjaGF0Um9vbU5hbWUpO1xuXG4gICAgLy8gY29uc3QgbXlJZCA9IGF3YWl0IFVzZXJNb2RlbC5maW5kT25lKHtuYW1lOiBuYW1lfSk7XG4gICAgLy8gY29uc3QgZnJpZW5kSWQgPSBhd2FpdCBVc2VyTW9kZWwuZmluZE9uZSh7bmFtZTogZnJpZW5kfSk7XG4gICAgLy8gaWYgbm90IGV4aXN0IC0+IGNyZWF0ZSBhIGNoYXRib3ggbW9kZWwuXG4gICAgaWYgKCFib3gpe1xuICAgICAgICAvLyDopoHlhYjmnIl1c2VycyBPYmplY3RJZC5cbiAgICAgICAgY29uc29sZS5sb2coJ0NoYXRCb3hNb2RlbOS4jeWtmOWcqCAtPiDlu7rnq4tDaGF0Qm94TW9kZWwnKTtcbiAgICAgICAgYm94ID0gYXdhaXQgbmV3IENoYXRCb3hNb2RlbCh7IG5hbWU6IGNoYXRSb29tTmFtZSB9KS5zYXZlKCk7XG4gICAgICAgIC8vIGF3YWl0IG15SWQudXBkYXRlT25lKHtcIiRwdXNoXCI6IHtjaGF0Qm94ZXM6IGJveC5faWR9fSk7XG4gICAgICAgIC8vIGF3YWl0IGZyaWVuZElkLnVwZGF0ZU9uZSh7XCIkcHVzaFwiOiB7Y2hhdEJveGVzOiBib3guX2lkfX0pO1xuICAgIH1cbiAgICBlbHNle1xuICAgICAgICBjb25zb2xlLmxvZyhcIkZpbmQgQ3VycmVudCBDaGF0IEJveFwiLCBib3gubmFtZSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGJveDtcbiAgICAvLyByZXR1cm4gW3t1c2VyLCBzZW5kZXJ9XTtcbn1cblxuLy8gLy8gQ3JlYXRlIFVzZXJzXG4vLyBjb25zdCBtYWtlVXNlcnMgPSBhc3luYyAobXlOYW1lLCBmcmllbmQpID0+IHtcbi8vICAgICBjb25zb2xlLmxvZygnVXNlciBuYW1lcycsIG15TmFtZSwgZnJpZW5kKTtcbi8vICAgICBsZXQgdXNlcjEgPSBhd2FpdCBVc2VyTW9kZWwuZmluZE9uZSh7bmFtZTogbXlOYW1lfSlcbi8vICAgICBsZXQgdXNlcjIgPSBhd2FpdCBVc2VyTW9kZWwuZmluZE9uZSh7bmFtZTogZnJpZW5kfSlcblxuLy8gICAgIGlmKCF1c2VyMSl7XG4vLyAgICAgICAgIHVzZXIxID0gYXdhaXQgbmV3IFVzZXJNb2RlbCh7bmFtZTogbXlOYW1lfSkuc2F2ZSgpXG4vLyAgICAgfVxuICAgIFxuLy8gICAgIGlmKCF1c2VyMil7XG4vLyAgICAgICAgIHVzZXIyID0gYXdhaXQgbmV3IFVzZXJNb2RlbCh7bmFtZTogZnJpZW5kfSkuc2F2ZSgpXG4vLyAgICAgfVxuLy8gICAgIGNvbnNvbGUubG9nKFwiVXNlcnNfaWQgXCIsW3VzZXIxLl9pZCwgdXNlcjIuX2lkXSlcbi8vIH1cblxuXG4vLyDlu7rnq4vkuIDlgIsgZGljdGlvbmFyeSBvZiB7IGNoYXRCb3hOYW1lLCBTZXQ8d3M+IH0sIC0+IGtleTogdmFsdWUgLT4gXCJjaGF0Qm94TmFtZVwiOiBzZXQod3MuLi4pXG4vLyDlj6/ku6Xlvp4gY2hhdGJveCBuYW1lIOaJvuWIsOeVtuWJjeacieWTquS6myB3ZWJzb2NrZXRzIC8gQ2hhdFJvb21zIFxuLy8g5pyJ6YCZ5YCL5ZCN5a2X55qEIGNoYXRib3gg5LiU54K6IGFjdGl2ZVxuY29uc3QgY2hhdEJveGVzID0ge307XG5cbmV4cG9ydCBkZWZhdWx0IHtcbiAgICAvLyDop6PmnpBjbGllbnTlgrPkvobnmoTos4fmlplcbiAgICBvbk1lc3NhZ2U6ICh3c3MsIHdzKSA9PiAoXG4gICAgICAgIGFzeW5jIChieXRlU3RyaW5nKSA9PiB7XG4gICAgICAgICAgICBjb25zdCB7IGRhdGEgfSA9IGJ5dGVTdHJpbmdcbiAgICAgICAgICAgIGNvbnN0IFsgdGFzaywgcGF5bG9hZCBdID0gSlNPTi5wYXJzZShkYXRhKVxuICAgICAgICAgICAgY29uc3QgeyBuYW1lLCBmcmllbmQgfSA9IHBheWxvYWQ7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIHVzZXIod3MpIHdhcyBpbiBhbm90aGVyIGNoYXRib3hcbiAgICAgICAgICAgIGlmICh3cy5ib3ggIT09IFwiXCIgJiYgY2hhdEJveGVzW3dzLmJveF0pe1xuICAgICAgICAgICAgICAgIGNoYXRCb3hlc1t3cy5ib3hdLmRlbGV0ZSh3cyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyB3cyDlm6DmlYXpl5zplolcbiAgICAgICAgICAgIHdzLm9uY2UoJ2Nsb3NlJywgKCkgPT4ge1xuICAgICAgICAgICAgICAgIGNoYXRCb3hlc1t3cy5ib3hdLmRlbGV0ZSh3cyk7XG4gICAgICAgICAgICB9KVxuXG4gICAgICAgICAgICAvLyBjcmVhdGUgQ2hhdHJvb20gSURcbiAgICAgICAgICAgIGxldCBjaGF0Qm94TmFtZSA9IG1ha2VOYW1lKCBuYW1lLCBmcmllbmQgKTtcbiAgICAgICAgICAgIHdzLmJveCA9IGNoYXRCb3hOYW1lO1xuXG4gICAgICAgICAgICAvLyAvLyBDcmVhdGUgVXNlcnNcbiAgICAgICAgICAgIC8vIGlmKG5hbWUgIT09IHVuZGVmaW5lZCl7XG4gICAgICAgICAgICAvLyAgICAgYXdhaXQgbWFrZVVzZXJzKG5hbWUsIGZyaWVuZCk7XG4gICAgICAgICAgICAvLyB9XG4gICAgICAgICAgICAvLyAvLyBjb25zb2xlLmxvZyh0eXBlb2YocGFydGljaXBhbnRzSUQpKTtcblxuICAgICAgICAgICAgLy8gY2hlY2sgQ2hhdFJvb20gZXhpc3RzIG9yIG5vdFxuICAgICAgICAgICAgY29uc29sZS5sb2coJ1ZhbGlkYXRpb24gb2YgY2hhdCBib3g6JywgKGF3YWl0IHZhbGlkYXRlQ2hhdEJveChjaGF0Qm94TmFtZSwgbmFtZSwgZnJpZW5kKSkpO1xuICAgICAgICAgICAgLy8gY29uc29sZS5sb2coIHZhbGlkYXRlQ2hhdEJveChjaGF0Qm94TmFtZSwgcGFydGljaXBhbnRzKSApO1xuXG4gICAgICAgICAgICAvLyB3cyBkaWN0XG4gICAgICAgICAgICAvLyDlpoLmnpzkuI3mm77mnInpgY4gY2hhdEJveE5hbWUg55qE5bCN6Kmx77yM5bCHIGNoYXRCb3hlc1tjaGF0Qm94TmFtZV0g6Kit5a6a54K6IGVtcHR5IFNldFxuICAgICAgICAgICAgaWYgKCFjaGF0Qm94ZXNbY2hhdEJveE5hbWVdKXtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcIldlYlNvY2tldDogQ2hhdEJveCDkuI3lrZjlnKjvvIzlibXlu7ogTmV3IFNldCBmb3IgY2hhdEJveFwiKTtcbiAgICAgICAgICAgICAgICBjaGF0Qm94ZXNbY2hhdEJveE5hbWVdID0gbmV3IFNldCgpOyAvLyBtYWtlIG5ldyByZWNvcmQgZm9yIGNoYXRib3hcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIOWwhyB3cyBjbGllbnQg5Yqg5YWlIGNoYXRCb3hlc1tjaGF0Qm94TmFtZV0gXG4gICAgICAgICAgICBjaGF0Qm94ZXNbY2hhdEJveE5hbWVdLmFkZCh3cyk7IC8vIGFkZCB0aGlzIG9wZW4gY29ubmVjdGlvbiBpbnRvIGNoYXRib3hcblxuXG4gICAgICAgICAgICBzd2l0Y2ggKHRhc2spIHtcbiAgICAgICAgICAgICAgICBjYXNlICdJbml0Jzp7XG4gICAgICAgICAgICAgICAgICAgIC8vIOaKiumAmeWAiyBjaGF0Ym94IOeahCBtZXNzYWdlcyDmipPkuIvkvoZcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY2hhdEJveE9iamVjdCA9IGF3YWl0IENoYXRCb3hNb2RlbC5maW5kT25lKHtuYW1lOiBjaGF0Qm94TmFtZX0pO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBtZXNzYWdlcyA9IGNoYXRCb3hPYmplY3QubWVzc2FnZXM7XG4gICAgICAgICAgICAgICAgICAgIHRyeXtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbmREYXRhKFsnSW5pdCcsIG1lc3NhZ2VzLCBjaGF0Qm94TmFtZV0sIHdzKTsgLy8gbWVzc2FnZXMgPSB7c2VuZGVyLCBib2R5LCBfaWR9XG4gICAgICAgICAgICAgICAgICAgICAgICBzZW5kU3RhdHVzKHsgICAgLy8ge1snc3RhdHVzJyx7dHlwZSwgbXNnfV19XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdWNjZXNzXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbXNnOiBcIlN1Y2Nlc3NmdWxseSBPcGVuIG9uZSBDaGF0cm9vbVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgfSwgd3MpXG4gICAgICAgICAgICAgICAgICAgIH1jYXRjaChlKXt0aHJvdyBuZXcgRXJyb3IoXCJNZXNzYWdlIHNlbmRpbmcgaXMgZmFpbGVkOiBcIiArIGUpfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBjYXNlICdpbnB1dCc6IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgeyBib2R5IH0gPSBwYXlsb2FkO1xuICAgICAgICAgICAgICAgICAgICAvLyBTYXZlIG1lc3NhZ2UgdG8gREJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY2hhdEJveE9iamVjdCA9IGF3YWl0IENoYXRCb3hNb2RlbC5maW5kT25lKHtuYW1lOiBjaGF0Qm94TmFtZX0pO1xuICAgICAgICAgICAgICAgICAgICAvLyBjb25zdCBzZW5kZXJPYmplY3QgPSBhd2FpdCBVc2VyTW9kZWwuZmluZE9uZSh7bmFtZTogbmFtZX0pO1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnSWRzOicsIGNoYXRCb3hPYmplY3QuX2lkKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gY29uc3QgbWVzc2FnZSA9IGF3YWl0IG5ldyBNZXNzYWdlTW9kZWwoeyBjaGF0Qm94OiBjaGF0Qm94T2JqZWN0Ll9pZCwgc2VuZGVyOiBzZW5kZXJPYmplY3QuX2lkLCBib2R5OiBib2R5IH0pLnNhdmUoKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gY29uc3QgbWVzc2FnZSA9IGF3YWl0IG5ldyBNZXNzYWdlTW9kZWwoeyBib2R5OiBib2R5IH0pLnNhdmUoKTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIHRyeSB7IFxuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgQ2hhdEJveE1vZGVsLmZpbmRPbmVBbmRVcGRhdGUoeyBuYW1lOiBjaGF0Qm94TmFtZSB9LCB7IFwiJHB1c2hcIjogeyBcIm1lc3NhZ2VzXCI6IHtzZW5kZXI6IG5hbWUsIGJvZHk6IGJvZHl9IH0gfSwgeyBuZXc6IHRydWUgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFJlc3BvbmQgdG8gU2VuZGVyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAoIGF3YWl0IChhd2FpdCBtZXNzYWdlLnBvcHVsYXRlKFwiY2hhdEJveFwiKSkucG9wdWxhdGUoXCJzZW5kZXJcIikpO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2VuZERhdGEoWydiYWNrVG9TZW5kZXInLCBtZXNzYWdlLCBjaGF0Qm94TmFtZV0sIHdzKSAvLyBbJ2JhY2tUb1NlbmRlcicsIG1lc3NhZ2VdXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBzZW5kU3RhdHVzKHsgICAgLy8ge1snc3RhdHVzJyx7dHlwZSwgbXNnfV19XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAgICAgdHlwZTogXCJzdWNjZXNzXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyAgICAgbXNnOiBcIlN1Y2Nlc3NmdWxseSBzZW50IG9uZSBtZXNzYWdlXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB9LCB3cylcbiAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFJlc3BvbmQgdG8gUmVjZWl2ZXJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG1zZyA9IHtzZW5kZXI6IG5hbWUsIGJvZHk6IGJvZHl9O1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VuZERhdGEoWydiYWNrVG9SZWNlaXZlcicsIG1zZywgY2hhdEJveE5hbWVdLCBjaGF0Qm94ZXNbY2hhdEJveE5hbWVdKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbmRTdGF0dXMoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdzdWNjZXNzJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtc2c6IFwiU3VjY2Vzc2Z1bGx5IHJlY2VpdmUgb25lIG1lc3NhZ2VcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIGNoYXRCb3hlc1tjaGF0Qm94TmFtZV0pO1xuICAgICAgICAgICAgICAgICAgICB9IFxuICAgICAgICAgICAgICAgICAgICBjYXRjaCAoZSkgeyB0aHJvdyBuZXcgRXJyb3IoXCJNZXNzYWdlIHNlbmRpbmcgaXMgZmFpbGVkOiBcIiArIGUpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBkZWZhdWx0OiBicmVhaztcbiAgICAgICAgICAgICAgICAvLyBjYXNlcyA6IC4uLlxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgKVxufSJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBO0FBQ0E7QUFFQTtBQUF1RTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsK0NBRnZFO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUlBLElBQU1BLFFBQVEsR0FBRyxTQUFYQSxRQUFRLENBQUlDLElBQUksRUFBRUMsS0FBSyxFQUFLO0VBRTlCO0VBQ0E7O0VBRUEsSUFBSUMsTUFBTSxDQUFDQyxjQUFjLENBQUNGLEtBQUssQ0FBQyxLQUFLRyxHQUFHLENBQUNDLFNBQVMsRUFBRTtJQUNoRDtJQUFBLDJDQUNpQkosS0FBSztNQUFBO0lBQUE7TUFBdEIsb0RBQXVCO1FBQUEsSUFBZEssSUFBSTtRQUNUQSxJQUFJLENBQUNDLElBQUksQ0FBQ0MsSUFBSSxDQUFDQyxTQUFTLENBQUNULElBQUksQ0FBQyxDQUFDO01BQ25DO01BQ0E7SUFBQTtNQUFBO0lBQUE7TUFBQTtJQUFBO0VBQ0osQ0FBQyxNQUNHO0lBQ0FDLEtBQUssQ0FBQ00sSUFBSSxDQUFDQyxJQUFJLENBQUNDLFNBQVMsQ0FBQ1QsSUFBSSxDQUFDLENBQUM7SUFDaEM7RUFFSjs7RUFFQVUsT0FBTyxDQUFDQyxHQUFHLENBQUMsb0JBQW9CLENBQUM7QUFDckMsQ0FBQztBQUNELElBQU1DLFVBQVUsR0FBRyxTQUFiQSxVQUFVLENBQUlDLE9BQU8sRUFB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","map":{"version":3,"names":["sendData","data","wsSet","Object","getPrototypeOf","Set","prototype","item","send","JSON","stringify","console","log","sendStatus","payload","ws","makeName","name","friend","sort","join","validateChatBox","chatRoomName","ChatBoxModel","findOne","box","save","chatBoxes","onMessage","wss","byteString","parse","task","once","chatBoxName","add","chatBoxObject","messages","type","msg","Error","body","_id","findOneAndUpdate","sender"],"sourceRoot":"/Users/edlin/Desktop/wp1111/hw8/backend/src/","sources":["wsConnect.js"],"sourcesContent":["import mongoose from \"mongoose\";\nimport WebSocket from 'ws';\n\nimport {UserModel, MessageModel, ChatBoxModel} from \"./models/chatbox\";\n\nconst sendData = (data, wsSet) => {\n\n    // console.log('type of wsSet:', typeof(wsSet));\n    // console.log('wsSet:', wsSet);\n\n    if( Object.getPrototypeOf(wsSet) === Set.prototype ){\n        //對 set 中的每個 ws 進行迭代\n        for (let item of wsSet){\n            item.send(JSON.stringify(data)); \n        }\n        // console.log('case 1');\n    }\n    else{\n        wsSet.send(JSON.stringify(data)); \n        // console.log('case 2');\n\n    }\n\n    console.log('Data send success.')\n}\nconst sendStatus = (payload, ws) => {\n    sendData([\"status\", payload], ws); \n}\n\n// Create Chatroom ID\nconst makeName = (name, friend) => {\n    return [name, friend].sort().join('_');\n}\n\n// ***\n// Check ChatRoom exists or not\nconst validateChatBox = async (chatRoomName, name, friend) => {\n    let box = await ChatBoxModel.findOne({ name: chatRoomName });\n    // console.log(\"box:\", box);\n    // console.log(\"chatBoxName:\", chatRoomName);\n\n    // const myId = await UserModel.findOne({name: name});\n    // const friendId = await UserModel.findOne({name: friend});\n    // if not exist -> create a chatbox model.\n    if (!box){\n        // 要先有users ObjectId.\n        console.log('ChatBoxModel不存在 -> 建立ChatBoxModel');\n        box = await new ChatBoxModel({ name: chatRoomName }).save();\n        // await myId.updateOne({\"$push\": {chatBoxes: box._id}});\n        // await friendId.updateOne({\"$push\": {chatBoxes: box._id}});\n    }\n    else{\n        console.log(\"Find Current Chat Box\", box.name);\n    }\n\n    return box;\n    // return [{user, sender}];\n}\n\n// // Create Users\n// const makeUsers = async (myName, friend) => {\n//     console.log('User names', myName, friend);\n//     let user1 = await UserModel.findOne({name: myName})\n//     let user2 = await UserModel.findOne({name: friend})\n\n//     if(!user1){\n//         user1 = await new UserModel({name: myName}).save()\n//     }\n    \n//     if(!user2){\n//         user2 = await new UserModel({name: friend}).save()\n//     }\n//     console.log(\"Users_id \",[user1._id, user2._id])\n// }\n\n\n// 建立一個 dictionary of { chatBoxName, Set<ws> }, -> key: value -> \"chatBoxName\": set(ws...)\n// 可以從 chatbox name 找到當前有哪些 websockets / ChatRooms \n// 有這個名字的 chatbox 且為 active\nconst chatBoxes = {};\n\nexport default {\n    // 解析client傳來的資料\n    onMessage: (wss, ws) => (\n        async (byteString) => {\n            const { data } = byteString\n            const [ task, payload ] = JSON.parse(data)\n            const { name, friend } = payload;\n            \n            // user(ws) was in another chatbox\n            if (ws.box !== \"\" && chatBoxes[ws.box]){\n                chatBoxes[ws.box].delete(ws);\n            }\n            // ws 因故關閉\n            ws.once('close', () => {\n                chatBoxes[ws.box].delete(ws);\n            })\n\n            // create Chatroom ID\n            let chatBoxName = makeName( name, friend );\n            ws.box = chatBoxName;\n\n            // // Create Users\n            // if(name !== undefined){\n            //     await makeUsers(name, friend);\n            // }\n            // // console.log(typeof(participantsID));\n\n            // check ChatRoom exists or not\n            console.log('Validation of chat box:', (await validateChatBox(chatBoxName, name, friend)));\n            // console.log( validateChatBox(chatBoxName, participants) );\n\n            // ws dict\n            // 如果不曾有過 chatBoxName 的對話，將 chatBoxes[chatBoxName] 設定為 empty Set\n            if (!chatBoxes[chatBoxName]){\n                console.log(\"WebSocket: ChatBox 不存在，創建 New Set for chatBox\");\n                chatBoxes[chatBoxName] = new Set(); // make new record for chatbox\n            }\n            // 將 ws client 加入 chatBoxes[chatBoxName] \n            chatBoxes[chatBoxName].add(ws); // add this open connection into chatbox\n\n\n            switch (task) {\n                case 'Init':{\n                    // 把這個 chatbox 的 messages 抓下來\n                    const chatBoxObject = await ChatBoxModel.findOne({name: chatBoxName});\n                    const messages = chatBoxObject.messages;\n                    try{\n                        sendData(['Init', messages, chatBoxName], ws); // messages = {sender, body, _id}\n                        sendStatus({    // {['status',{type, msg}]}\n                            type: \"success\",\n                            msg: \"Successfully Open one Chatroom\",\n                        }, ws)\n                    }catch(e){throw new Error(\"Message sending is failed: \" + e)}\n                    break;\n                }\n\n                case 'input': {\n                    const { body } = payload;\n                    // Save message to DB\n                    const chatBoxObject = await ChatBoxModel.findOne({name: chatBoxName});\n                    // const senderObject = await UserModel.findOne({name: name});\n                    console.log('Ids:', chatBoxObject._id);\n                    // const message = await new MessageModel({ chatBox: chatBoxObject._id, sender: senderObject._id, body: body }).save();\n                    // const message = await new MessageModel({ body: body }).save();\n                    \n                    try { \n                        await ChatBoxModel.findOneAndUpdate({ name: chatBoxName }, { \"$push\": { \"messages\": {sender: name, body: body} } }, { new: true });\n                        \n                        // Respond to Sender\n                        // ( await (await message.populate(\"chatBox\")).populate(\"sender\"));\n                        // sendData(['backToSender', message, chatBoxName], ws) // ['backToSender', message]\n                        // sendStatus({    // {['status',{type, msg}]}\n                        //     type: \"success\",\n                        //     msg: \"Successfully sent one message\",\n                        // }, ws)\n    \n                        // Respond to Receiver\n                        const msg = {sender: name, body: body};\n                        sendData(['backToReceiver', msg, chatBoxName], chatBoxes[chatBoxName]);\n                        sendStatus({\n                            type: 'success',\n                            msg: \"Successfully receive one message\",\n                        }, chatBoxes[chatBoxName]);\n                    } \n                    catch (e) { throw new Error(\"Message sending is failed: \" + e);\n                    }\n                    break;\n                }\n                default: break;\n                // cases : ...\n            }\n        }\n    )\n}"],"mappings":"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"}},"mtime":1670557115551},"{\"assumptions\":{},\"sourceRoot\":\"/Users/edlin/Desktop/wp1111/hw8/backend/src/models/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/edlin/Desktop/wp1111/hw8/backend\",\"filename\":\"/Users/edlin/Desktop/wp1111/hw8/backend/src/models/chatbox.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/edlin/Desktop/wp1111/hw8/backend\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"proposal-class-static-block\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ClassBody\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-private-property-in-object\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"BinaryExpression\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"proposal-class-properties\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"proposal-private-methods\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"proposal-numeric-separator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"NumericLiteral\":{\"enter\":[null]},\"BigIntLiteral\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-logical-assignment-operators\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"AssignmentExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":true,\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-json-strings\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"DirectiveLiteral\":{\"enter\":[null]},\"StringLiteral\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-optional-catch-binding\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"CatchClause\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-parameters\",\"visitor\":{\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-async-generator-functions\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-object-rest-spread\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"VariableDeclarator\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dotall-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-unicode-property-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-named-capturing-groups-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-async-to-generator\",\"visitor\":{\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-exponentiation-operator\",\"visitor\":{\"AssignmentExpression\":{\"enter\":[null]},\"BinaryExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-template-literals\",\"visitor\":{\"TaggedTemplateExpression\":{\"enter\":[null]},\"TemplateLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-literals\",\"visitor\":{\"NumericLiteral\":{\"enter\":[null]},\"StringLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-function-name\",\"visitor\":{\"FunctionExpression\":{\"exit\":[null]},\"ObjectProperty\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-arrow-functions\",\"visitor\":{\"ArrowFunctionExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-block-scoped-functions\",\"visitor\":{\"BlockStatement\":{\"enter\":[null]},\"SwitchCase\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-classes\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]},\"ClassExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-object-super\",\"visitor\":{\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-shorthand-properties\",\"visitor\":{\"ObjectMethod\":{\"enter\":[null]},\"ObjectProperty\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-duplicate-keys\",\"visitor\":{\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-computed-properties\",\"visitor\":{\"ObjectExpression\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-for-of\",\"visitor\":{\"ForOfStatement\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-sticky-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-unicode-escapes\",\"visitor\":{\"Identifier\":{\"enter\":[null]},\"TemplateElement\":{\"enter\":[null]},\"_exploded\":true,\"StringLiteral\":{\"enter\":[null]},\"DirectiveLiteral\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-unicode-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-spread\",\"visitor\":{\"ArrayExpression\":{\"enter\":[null]},\"CallExpression\":{\"enter\":[null]},\"NewExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-destructuring\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"VariableDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-block-scoping\",\"visitor\":{\"VariableDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"_exploded\":true,\"BlockStatement\":{\"enter\":[null]},\"SwitchStatement\":{\"enter\":[null]},\"Program\":{\"enter\":[null]},\"_verified\":true,\"DoWhileStatement\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForStatement\":{\"enter\":[null]},\"WhileStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-typeof-symbol\",\"visitor\":{\"UnaryExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"BlockStatement\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"DoWhileStatement\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForStatement\":{\"enter\":[null]},\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"Program\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"SwitchStatement\":{\"enter\":[null]},\"WhileStatement\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"StaticBlock\":{\"enter\":[null]},\"TSModuleBlock\":{\"enter\":[null]},\"AssignmentPattern\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectPattern\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-new-target\",\"visitor\":{\"MetaProperty\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-regenerator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ObjectMethod\":{\"enter\":[null],\"exit\":[null]},\"ClassMethod\":{\"enter\":[null],\"exit\":[null]},\"ClassPrivateMethod\":{\"enter\":[null],\"exit\":[null]},\"FunctionDeclaration\":{\"exit\":[null]},\"FunctionExpression\":{\"exit\":[null]},\"ArrowFunctionExpression\":{\"exit\":[null]},\"MemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-member-expression-literals\",\"visitor\":{\"MemberExpression\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-property-literals\",\"visitor\":{\"ObjectProperty\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-reserved-words\",\"visitor\":{\"_exploded\":true,\"_verified\":true,\"Identifier\":{\"enter\":[null,null]},\"JSXIdentifier\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.20.2:development":{"value":{"code":"\"use strict\";\n\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }, _typeof(obj); }\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.ChatBoxModel = void 0;\nvar _mongoose = _interopRequireWildcard(require(\"mongoose\"));\nfunction _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== \"function\") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }\nfunction _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || _typeof(obj) !== \"object\" && typeof obj !== \"function\") { return { \"default\": obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj[\"default\"] = obj; if (cache) { cache.set(obj, newObj); } return newObj; }\n// /******* User Schema *******/\n// const UserSchema = new Schema({\n//     name: {\n//         type: String, \n//         required: [true, 'Name field is required.'],\n//     },\n//     chatBoxes: [\n//         {\n//             type: mongoose.Types.ObjectId,\n//             ref: \"ChatBox\",\n//         }\n//     ]\n// });\n\n// const UserModel = mongoose.model('User', UserSchema);\n\n// /******* Message Schema *******/\n// const MessageSchema = new Schema({\n//     chatBox: {\n//         type: mongoose.Types.ObjectId,\n//         ref: \"ChatBox\",\n//     },\n//     sender: {\n//         type: mongoose.Types.ObjectId,\n//         ref: \"User\",\n//     },\n//     body: {\n//         type: String,\n//         required: [true, \"Body field is required.\"],\n//     }\n// })\n\n// const MessageModel = mongoose.model('Message', MessageSchema);\n\n// /******* ChatBox Schema *******/\n// const ChatBoxSchema = new Schema({\n//     name: {\n//         type: String,\n//         required: [true, 'Name field is required.'],\n//     },\n//     users: [\n//         { \n//             type: mongoose.Types.ObjectId, \n//             ref: 'User' \n//         }\n//     ],\n//     messages: [\n//         {\n//             type: mongoose.Types.ObjectId, \n//             ref: 'Message' \n//         }\n//     ],\n// })\n\nvar ChatBoxSchema = new _mongoose.Schema({\n  name: {\n    type: String,\n    required: [true, 'Name field is required.']\n  },\n  messages: [{\n    sender: {\n      type: String,\n      required: [true, 'Sender field is required.']\n    },\n    body: {\n      type: String\n      // required: [true, 'Body field is required.'],\n    }\n  }]\n});\n\nvar ChatBoxModel = _mongoose[\"default\"].model('ChatBox', ChatBoxSchema);\n\n// export { UserModel, MessageModel, ChatBoxModel }; // 輸出多個就使用 export {...}\n// 輸出多個就使用 export {...}\nexports.ChatBoxModel = ChatBoxModel;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJDaGF0Qm94U2NoZW1hIiwiU2NoZW1hIiwibmFtZSIsInR5cGUiLCJTdHJpbmciLCJyZXF1aXJlZCIsIm1lc3NhZ2VzIiwic2VuZGVyIiwiYm9keSIsIkNoYXRCb3hNb2RlbCIsIm1vbmdvb3NlIiwibW9kZWwiXSwic291cmNlUm9vdCI6Ii9Vc2Vycy9lZGxpbi9EZXNrdG9wL3dwMTExMS9odzgvYmFja2VuZC9zcmMvbW9kZWxzLyIsInNvdXJjZXMiOlsiY2hhdGJveC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgbW9uZ29vc2UsIHsgU2NoZW1hIH0gZnJvbSBcIm1vbmdvb3NlXCI7XG5cbi8vIC8qKioqKioqIFVzZXIgU2NoZW1hICoqKioqKiovXG4vLyBjb25zdCBVc2VyU2NoZW1hID0gbmV3IFNjaGVtYSh7XG4vLyAgICAgbmFtZToge1xuLy8gICAgICAgICB0eXBlOiBTdHJpbmcsIFxuLy8gICAgICAgICByZXF1aXJlZDogW3RydWUsICdOYW1lIGZpZWxkIGlzIHJlcXVpcmVkLiddLFxuLy8gICAgIH0sXG4vLyAgICAgY2hhdEJveGVzOiBbXG4vLyAgICAgICAgIHtcbi8vICAgICAgICAgICAgIHR5cGU6IG1vbmdvb3NlLlR5cGVzLk9iamVjdElkLFxuLy8gICAgICAgICAgICAgcmVmOiBcIkNoYXRCb3hcIixcbi8vICAgICAgICAgfVxuLy8gICAgIF1cbi8vIH0pO1xuXG4vLyBjb25zdCBVc2VyTW9kZWwgPSBtb25nb29zZS5tb2RlbCgnVXNlcicsIFVzZXJTY2hlbWEpO1xuXG4vLyAvKioqKioqKiBNZXNzYWdlIFNjaGVtYSAqKioqKioqL1xuLy8gY29uc3QgTWVzc2FnZVNjaGVtYSA9IG5ldyBTY2hlbWEoe1xuLy8gICAgIGNoYXRCb3g6IHtcbi8vICAgICAgICAgdHlwZTogbW9uZ29vc2UuVHlwZXMuT2JqZWN0SWQsXG4vLyAgICAgICAgIHJlZjogXCJDaGF0Qm94XCIsXG4vLyAgICAgfSxcbi8vICAgICBzZW5kZXI6IHtcbi8vICAgICAgICAgdHlwZTogbW9uZ29vc2UuVHlwZXMuT2JqZWN0SWQsXG4vLyAgICAgICAgIHJlZjogXCJVc2VyXCIsXG4vLyAgICAgfSxcbi8vICAgICBib2R5OiB7XG4vLyAgICAgICAgIHR5cGU6IFN0cmluZyxcbi8vICAgICAgICAgcmVxdWlyZWQ6IFt0cnVlLCBcIkJvZHkgZmllbGQgaXMgcmVxdWlyZWQuXCJdLFxuLy8gICAgIH1cbi8vIH0pXG5cbi8vIGNvbnN0IE1lc3NhZ2VNb2RlbCA9IG1vbmdvb3NlLm1vZGVsKCdNZXNzYWdlJywgTWVzc2FnZVNjaGVtYSk7XG5cbi8vIC8qKioqKioqIENoYXRCb3ggU2NoZW1hICoqKioqKiovXG4vLyBjb25zdCBDaGF0Qm94U2NoZW1hID0gbmV3IFNjaGVtYSh7XG4vLyAgICAgbmFtZToge1xuLy8gICAgICAgICB0eXBlOiBTdHJpbmcsXG4vLyAgICAgICAgIHJlcXVpcmVkOiBbdHJ1ZSwgJ05hbWUgZmllbGQgaXMgcmVxdWlyZWQuJ10sXG4vLyAgICAgfSxcbi8vICAgICB1c2VyczogW1xuLy8gICAgICAgICB7IFxuLy8gICAgICAgICAgICAgdHlwZTogbW9uZ29vc2UuVHlwZXMuT2JqZWN0SWQsIFxuLy8gICAgICAgICAgICAgcmVmOiAnVXNlcicgXG4vLyAgICAgICAgIH1cbi8vICAgICBdLFxuLy8gICAgIG1lc3NhZ2VzOiBbXG4vLyAgICAgICAgIHtcbi8vICAgICAgICAgICAgIHR5cGU6IG1vbmdvb3NlLlR5cGVzLk9iamVjdElkLCBcbi8vICAgICAgICAgICAgIHJlZjogJ01lc3NhZ2UnIFxuLy8gICAgICAgICB9XG4vLyAgICAgXSxcbi8vIH0pXG5cbmNvbnN0IENoYXRCb3hTY2hlbWEgPSBuZXcgU2NoZW1hKHtcblxuICAgIG5hbWU6IHtcbiAgICAgICAgdHlwZTogU3RyaW5nLFxuICAgICAgICByZXF1aXJlZDogW3RydWUsICdOYW1lIGZpZWxkIGlzIHJlcXVpcmVkLiddLFxuICAgIH0sXG5cbiAgICBtZXNzYWdlczogW1xuICAgICAgICB7XG4gICAgICAgICAgICBzZW5kZXI6IHtcbiAgICAgICAgICAgICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICAgICAgICAgICAgcmVxdWlyZWQ6IFt0cnVlLCAnU2VuZGVyIGZpZWxkIGlzIHJlcXVpcmVkLiddLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGJvZHk6IHtcbiAgICAgICAgICAgICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICAgICAgICAgICAgLy8gcmVxdWlyZWQ6IFt0cnVlLCAnQm9keSBmaWVsZCBpcyByZXF1aXJlZC4nXSxcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIF0sXG59KVxuXG5jb25zdCBDaGF0Qm94TW9kZWwgPSBtb25nb29zZS5tb2RlbCgnQ2hhdEJveCcsIENoYXRCb3hTY2hlbWEpO1xuXG4vLyBleHBvcnQgeyBVc2VyTW9kZWwsIE1lc3NhZ2VNb2RlbCwgQ2hhdEJveE1vZGVsIH07IC8vIOi8uOWHuuWkmuWAi+WwseS9v+eUqCBleHBvcnQgey4uLn1cbmV4cG9ydCB7IENoYXRCb3hNb2RlbCB9OyAvLyDovLjlh7rlpJrlgIvlsLHkvb/nlKggZXhwb3J0IHsuLi59XG5cblxuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQUE7QUFBNEM7QUFBQTtBQUU1QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsSUFBTUEsYUFBYSxHQUFHLElBQUlDLGdCQUFNLENBQUM7RUFFN0JDLElBQUksRUFBRTtJQUNGQyxJQUFJLEVBQUVDLE1BQU07SUFDWkMsUUFBUSxFQUFFLENBQUMsSUFBSSxFQUFFLHlCQUF5QjtFQUM5QyxDQUFDO0VBRURDLFFBQVEsRUFBRSxDQUNOO0lBQ0lDLE1BQU0sRUFBRTtNQUNKSixJQUFJLEVBQUVDLE1BQU07TUFDWkMsUUFBUSxFQUFFLENBQUMsSUFBSSxFQUFFLDJCQUEyQjtJQUNoRCxDQUFDO0lBQ0RHLElBQUksRUFBRTtNQUNGTCxJQUFJLEVBQUVDO01BQ047SUFDSjtFQUNKLENBQUM7QUFFVCxDQUFDLENBQUM7O0FBRUYsSUFBTUssWUFBWSxHQUFHQyxvQkFBUSxDQUFDQyxLQUFLLENBQUMsU0FBUyxFQUFFWCxhQUFhLENBQUM7O0FBRTdEO0FBQ3lCO0FBQUEifQ==","map":{"version":3,"names":["ChatBoxSchema","Schema","name","type","String","required","messages","sender","body","ChatBoxModel","mongoose","model"],"sourceRoot":"/Users/edlin/Desktop/wp1111/hw8/backend/src/models/","sources":["chatbox.js"],"sourcesContent":["import mongoose, { Schema } from \"mongoose\";\n\n// /******* User Schema *******/\n// const UserSchema = new Schema({\n//     name: {\n//         type: String, \n//         required: [true, 'Name field is required.'],\n//     },\n//     chatBoxes: [\n//         {\n//             type: mongoose.Types.ObjectId,\n//             ref: \"ChatBox\",\n//         }\n//     ]\n// });\n\n// const UserModel = mongoose.model('User', UserSchema);\n\n// /******* Message Schema *******/\n// const MessageSchema = new Schema({\n//     chatBox: {\n//         type: mongoose.Types.ObjectId,\n//         ref: \"ChatBox\",\n//     },\n//     sender: {\n//         type: mongoose.Types.ObjectId,\n//         ref: \"User\",\n//     },\n//     body: {\n//         type: String,\n//         required: [true, \"Body field is required.\"],\n//     }\n// })\n\n// const MessageModel = mongoose.model('Message', MessageSchema);\n\n// /******* ChatBox Schema *******/\n// const ChatBoxSchema = new Schema({\n//     name: {\n//         type: String,\n//         required: [true, 'Name field is required.'],\n//     },\n//     users: [\n//         { \n//             type: mongoose.Types.ObjectId, \n//             ref: 'User' \n//         }\n//     ],\n//     messages: [\n//         {\n//             type: mongoose.Types.ObjectId, \n//             ref: 'Message' \n//         }\n//     ],\n// })\n\nconst ChatBoxSchema = new Schema({\n\n    name: {\n        type: String,\n        required: [true, 'Name field is required.'],\n    },\n\n    messages: [\n        {\n            sender: {\n                type: String,\n                required: [true, 'Sender field is required.'],\n            },\n            body: {\n                type: String,\n                // required: [true, 'Body field is required.'],\n            }\n        }\n    ],\n})\n\nconst ChatBoxModel = mongoose.model('ChatBox', ChatBoxSchema);\n\n// export { UserModel, MessageModel, ChatBoxModel }; // 輸出多個就使用 export {...}\nexport { ChatBoxModel }; // 輸出多個就使用 export {...}\n\n\n"],"mappings":";;;;;;;AAAA;AAA4C;AAAA;AAE5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,IAAMA,aAAa,GAAG,IAAIC,gBAAM,CAAC;EAE7BC,IAAI,EAAE;IACFC,IAAI,EAAEC,MAAM;IACZC,QAAQ,EAAE,CAAC,IAAI,EAAE,yBAAyB;EAC9C,CAAC;EAEDC,QAAQ,EAAE,CACN;IACIC,MAAM,EAAE;MACJJ,IAAI,EAAEC,MAAM;MACZC,QAAQ,EAAE,CAAC,IAAI,EAAE,2BAA2B;IAChD,CAAC;IACDG,IAAI,EAAE;MACFL,IAAI,EAAEC;MACN;IACJ;EACJ,CAAC;AAET,CAAC,CAAC;;AAEF,IAAMK,YAAY,GAAGC,oBAAQ,CAACC,KAAK,CAAC,SAAS,EAAEX,aAAa,CAAC;;AAE7D;AACyB;AAAA"}},"mtime":1670551759099},"{\"assumptions\":{},\"sourceRoot\":\"/Users/edlin/Desktop/wp1111/hw8/backend/src/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/edlin/Desktop/wp1111/hw8/backend\",\"filename\":\"/Users/edlin/Desktop/wp1111/hw8/backend/src/mongo.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/edlin/Desktop/wp1111/hw8/backend\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"proposal-class-static-block\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ClassBody\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-private-property-in-object\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"BinaryExpression\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"proposal-class-properties\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"proposal-private-methods\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]}},\"options\":{\"loose\":\"#__internal__@babel/preset-env__prefer-false-but-true-is-ok-if-it-prevents-an-error\"},\"externalDependencies\":[]},{\"key\":\"proposal-numeric-separator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"NumericLiteral\":{\"enter\":[null]},\"BigIntLiteral\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-logical-assignment-operators\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"AssignmentExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"LogicalExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-optional-chaining\",\"visitor\":{\"_exploded\":true,\"OptionalCallExpression\":{\"enter\":[null]},\"OptionalMemberExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-json-strings\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"DirectiveLiteral\":{\"enter\":[null]},\"StringLiteral\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-optional-catch-binding\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"CatchClause\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-parameters\",\"visitor\":{\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-async-generator-functions\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-object-rest-spread\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"VariableDeclarator\":{\"enter\":[null]},\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectExpression\":{\"enter\":[null]},\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dotall-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-unicode-property-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-named-capturing-groups-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-async-to-generator\",\"visitor\":{\"_exploded\":true,\"_verified\":true,\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-exponentiation-operator\",\"visitor\":{\"AssignmentExpression\":{\"enter\":[null]},\"BinaryExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-template-literals\",\"visitor\":{\"TaggedTemplateExpression\":{\"enter\":[null]},\"TemplateLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-literals\",\"visitor\":{\"NumericLiteral\":{\"enter\":[null]},\"StringLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-function-name\",\"visitor\":{\"FunctionExpression\":{\"exit\":[null]},\"ObjectProperty\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-arrow-functions\",\"visitor\":{\"ArrowFunctionExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-block-scoped-functions\",\"visitor\":{\"BlockStatement\":{\"enter\":[null]},\"SwitchCase\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-classes\",\"visitor\":{\"ExportDefaultDeclaration\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]},\"ClassExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-object-super\",\"visitor\":{\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-shorthand-properties\",\"visitor\":{\"ObjectMethod\":{\"enter\":[null]},\"ObjectProperty\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-duplicate-keys\",\"visitor\":{\"ObjectExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-computed-properties\",\"visitor\":{\"ObjectExpression\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-for-of\",\"visitor\":{\"ForOfStatement\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-sticky-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-unicode-escapes\",\"visitor\":{\"Identifier\":{\"enter\":[null]},\"TemplateElement\":{\"enter\":[null]},\"_exploded\":true,\"StringLiteral\":{\"enter\":[null]},\"DirectiveLiteral\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-unicode-regex\",\"visitor\":{\"RegExpLiteral\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-spread\",\"visitor\":{\"ArrayExpression\":{\"enter\":[null]},\"CallExpression\":{\"enter\":[null]},\"NewExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-destructuring\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"AssignmentExpression\":{\"enter\":[null]},\"VariableDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"ForInStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-block-scoping\",\"visitor\":{\"VariableDeclaration\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"_exploded\":true,\"BlockStatement\":{\"enter\":[null]},\"SwitchStatement\":{\"enter\":[null]},\"Program\":{\"enter\":[null]},\"_verified\":true,\"DoWhileStatement\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForStatement\":{\"enter\":[null]},\"WhileStatement\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-typeof-symbol\",\"visitor\":{\"UnaryExpression\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true,\"BlockStatement\":{\"enter\":[null]},\"CatchClause\":{\"enter\":[null]},\"DoWhileStatement\":{\"enter\":[null]},\"ForInStatement\":{\"enter\":[null]},\"ForStatement\":{\"enter\":[null]},\"FunctionDeclaration\":{\"enter\":[null]},\"FunctionExpression\":{\"enter\":[null]},\"Program\":{\"enter\":[null]},\"ObjectMethod\":{\"enter\":[null]},\"SwitchStatement\":{\"enter\":[null]},\"WhileStatement\":{\"enter\":[null]},\"ArrowFunctionExpression\":{\"enter\":[null]},\"ClassExpression\":{\"enter\":[null]},\"ClassDeclaration\":{\"enter\":[null]},\"ForOfStatement\":{\"enter\":[null]},\"ClassMethod\":{\"enter\":[null]},\"ClassPrivateMethod\":{\"enter\":[null]},\"StaticBlock\":{\"enter\":[null]},\"TSModuleBlock\":{\"enter\":[null]},\"AssignmentPattern\":{\"enter\":[null]},\"ArrayPattern\":{\"enter\":[null]},\"ObjectPattern\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-new-target\",\"visitor\":{\"MetaProperty\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-regenerator\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ObjectMethod\":{\"enter\":[null],\"exit\":[null]},\"ClassMethod\":{\"enter\":[null],\"exit\":[null]},\"ClassPrivateMethod\":{\"enter\":[null],\"exit\":[null]},\"FunctionDeclaration\":{\"exit\":[null]},\"FunctionExpression\":{\"exit\":[null]},\"ArrowFunctionExpression\":{\"exit\":[null]},\"MemberExpression\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-member-expression-literals\",\"visitor\":{\"MemberExpression\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-property-literals\",\"visitor\":{\"ObjectProperty\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-reserved-words\",\"visitor\":{\"_exploded\":true,\"_verified\":true,\"Identifier\":{\"enter\":[null,null]},\"JSXIdentifier\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-export-namespace-from\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"CallExpression\":{\"enter\":[null]},\"Program\":{\"exit\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"proposal-dynamic-import\",\"visitor\":{\"_exploded\":{},\"_verified\":{},\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.20.2:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\nvar _mongoose = _interopRequireDefault(require(\"mongoose\"));\nvar _dotenvDefaults = _interopRequireDefault(require(\"dotenv-defaults\"));\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { \"default\": obj }; }\nvar _default = {\n  // method, a function under an object \n  connect: function connect() {\n    _dotenvDefaults[\"default\"].config();\n    if (!process.env.MONGO_URL) {\n      console.error(\"Missing MONGO_URL!!!\");\n      process.exit(1);\n    }\n    _mongoose[\"default\"].connect(process.env.MONGO_URL, {\n      // Neglect?\n      useNewUrlParser: true,\n      useUnifiedTopology: true\n    }).then(function (res) {\n      return console.log(\"mongo db connection created\");\n    });\n    _mongoose[\"default\"].connection.on('error', console.error.bind(console, 'connection error'));\n  }\n};\nexports[\"default\"] = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjb25uZWN0IiwiZG90ZW52IiwiY29uZmlnIiwicHJvY2VzcyIsImVudiIsIk1PTkdPX1VSTCIsImNvbnNvbGUiLCJlcnJvciIsImV4aXQiLCJtb25nb29zZSIsInVzZU5ld1VybFBhcnNlciIsInVzZVVuaWZpZWRUb3BvbG9neSIsInRoZW4iLCJyZXMiLCJsb2ciLCJjb25uZWN0aW9uIiwib24iLCJiaW5kIl0sInNvdXJjZVJvb3QiOiIvVXNlcnMvZWRsaW4vRGVza3RvcC93cDExMTEvaHc4L2JhY2tlbmQvc3JjLyIsInNvdXJjZXMiOlsibW9uZ28uanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IG1vbmdvb3NlIGZyb20gJ21vbmdvb3NlJztcbmltcG9ydCBkb3RlbnYgZnJvbSAnZG90ZW52LWRlZmF1bHRzJ1xuXG5leHBvcnQgZGVmYXVsdHtcbiAgICAvLyBtZXRob2QsIGEgZnVuY3Rpb24gdW5kZXIgYW4gb2JqZWN0IFxuICAgIGNvbm5lY3Q6ICgpID0+IHtcbiAgICAgICAgZG90ZW52LmNvbmZpZygpO1xuICAgICAgICBpZighcHJvY2Vzcy5lbnYuTU9OR09fVVJMKXtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXCJNaXNzaW5nIE1PTkdPX1VSTCEhIVwiKTtcbiAgICAgICAgICAgIHByb2Nlc3MuZXhpdCgxKTtcbiAgICAgICAgfVxuICAgICAgICBtb25nb29zZS5jb25uZWN0KHByb2Nlc3MuZW52Lk1PTkdPX1VSTCwge1xuICAgICAgICAgICAgLy8gTmVnbGVjdD9cbiAgICAgICAgICAgIHVzZU5ld1VybFBhcnNlcjogdHJ1ZSxcbiAgICAgICAgICAgIHVzZVVuaWZpZWRUb3BvbG9neTogdHJ1ZSxcbiAgICAgICAgfSlcbiAgICAgICAgLnRoZW4oKHJlcykgPT4gY29uc29sZS5sb2coXCJtb25nbyBkYiBjb25uZWN0aW9uIGNyZWF0ZWRcIikpO1xuICAgICAgICBtb25nb29zZS5jb25uZWN0aW9uLm9uKCdlcnJvcicsIGNvbnNvbGUuZXJyb3IuYmluZChjb25zb2xlLCAnY29ubmVjdGlvbiBlcnJvcicpKTtcbiAgICB9XG59OyJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUE7QUFDQTtBQUFvQztBQUFBLGVBRXRCO0VBQ1Y7RUFDQUEsT0FBTyxFQUFFLG1CQUFNO0lBQ1hDLDBCQUFNLENBQUNDLE1BQU0sRUFBRTtJQUNmLElBQUcsQ0FBQ0MsT0FBTyxDQUFDQyxHQUFHLENBQUNDLFNBQVMsRUFBQztNQUN0QkMsT0FBTyxDQUFDQyxLQUFLLENBQUMsc0JBQXNCLENBQUM7TUFDckNKLE9BQU8sQ0FBQ0ssSUFBSSxDQUFDLENBQUMsQ0FBQztJQUNuQjtJQUNBQyxvQkFBUSxDQUFDVCxPQUFPLENBQUNHLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDQyxTQUFTLEVBQUU7TUFDcEM7TUFDQUssZUFBZSxFQUFFLElBQUk7TUFDckJDLGtCQUFrQixFQUFFO0lBQ3hCLENBQUMsQ0FBQyxDQUNEQyxJQUFJLENBQUMsVUFBQ0MsR0FBRztNQUFBLE9BQUtQLE9BQU8sQ0FBQ1EsR0FBRyxDQUFDLDZCQUE2QixDQUFDO0lBQUEsRUFBQztJQUMxREwsb0JBQVEsQ0FBQ00sVUFBVSxDQUFDQyxFQUFFLENBQUMsT0FBTyxFQUFFVixPQUFPLENBQUNDLEtBQUssQ0FBQ1UsSUFBSSxDQUFDWCxPQUFPLEVBQUUsa0JBQWtCLENBQUMsQ0FBQztFQUNwRjtBQUNKLENBQUM7QUFBQSJ9","map":{"version":3,"names":["connect","dotenv","config","process","env","MONGO_URL","console","error","exit","mongoose","useNewUrlParser","useUnifiedTopology","then","res","log","connection","on","bind"],"sourceRoot":"/Users/edlin/Desktop/wp1111/hw8/backend/src/","sources":["mongo.js"],"sourcesContent":["import mongoose from 'mongoose';\nimport dotenv from 'dotenv-defaults'\n\nexport default{\n    // method, a function under an object \n    connect: () => {\n        dotenv.config();\n        if(!process.env.MONGO_URL){\n            console.error(\"Missing MONGO_URL!!!\");\n            process.exit(1);\n        }\n        mongoose.connect(process.env.MONGO_URL, {\n            // Neglect?\n            useNewUrlParser: true,\n            useUnifiedTopology: true,\n        })\n        .then((res) => console.log(\"mongo db connection created\"));\n        mongoose.connection.on('error', console.error.bind(console, 'connection error'));\n    }\n};"],"mappings":";;;;;;AAAA;AACA;AAAoC;AAAA,eAEtB;EACV;EACAA,OAAO,EAAE,mBAAM;IACXC,0BAAM,CAACC,MAAM,EAAE;IACf,IAAG,CAACC,OAAO,CAACC,GAAG,CAACC,SAAS,EAAC;MACtBC,OAAO,CAACC,KAAK,CAAC,sBAAsB,CAAC;MACrCJ,OAAO,CAACK,IAAI,CAAC,CAAC,CAAC;IACnB;IACAC,oBAAQ,CAACT,OAAO,CAACG,OAAO,CAACC,GAAG,CAACC,SAAS,EAAE;MACpC;MACAK,eAAe,EAAE,IAAI;MACrBC,kBAAkB,EAAE;IACxB,CAAC,CAAC,CACDC,IAAI,CAAC,UAACC,GAAG;MAAA,OAAKP,OAAO,CAACQ,GAAG,CAAC,6BAA6B,CAAC;IAAA,EAAC;IAC1DL,oBAAQ,CAACM,UAAU,CAACC,EAAE,CAAC,OAAO,EAAEV,OAAO,CAACC,KAAK,CAACU,IAAI,CAACX,OAAO,EAAE,kBAAkB,CAAC,CAAC;EACpF;AACJ,CAAC;AAAA"}},"mtime":1669026097009}}